[0m19:08:53.178889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb984e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8f2fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a5cad0>]}


============================== 19:08:53.186411 | 0b401812-5ddd-4b70-b9cd-cd5a1aec434f ==============================
[0m19:08:53.186411 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:08:53.186833 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_path': '/usr/app/logs', 'static_parser': 'True', 'printer_width': '80', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'profiles_dir': '/root/.dbt'}
[0m19:08:53.187121 [info ] [MainThread]: dbt version: 1.7.4
[0m19:08:53.187371 [info ] [MainThread]: python version: 3.11.14
[0m19:08:53.187653 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m19:08:53.188027 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.41
[0m19:08:53.259020 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m19:08:53.259431 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m19:08:53.259717 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m19:08:53.259982 [info ] [MainThread]: adapter type: trino
[0m19:08:53.260245 [info ] [MainThread]: adapter version: 1.7.1
[0m19:08:53.312070 [info ] [MainThread]: Configuration:
[0m19:08:53.312370 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:08:53.312735 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:08:53.312993 [info ] [MainThread]: Required dependencies:
[0m19:08:53.313263 [debug] [MainThread]: Executing "git --help"
[0m19:08:53.324518 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:08:53.324826 [debug] [MainThread]: STDERR: "b''"
[0m19:08:53.325018 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:08:53.325216 [info ] [MainThread]: Connection:
[0m19:08:53.325426 [info ] [MainThread]:   host: trino
[0m19:08:53.325635 [info ] [MainThread]:   port: 8080
[0m19:08:53.325824 [info ] [MainThread]:   user: admin
[0m19:08:53.326015 [info ] [MainThread]:   database: iceberg
[0m19:08:53.326207 [info ] [MainThread]:   schema: analytics
[0m19:08:53.326400 [info ] [MainThread]:   cert: None
[0m19:08:53.326672 [info ] [MainThread]:   prepared_statements_enabled: True
[0m19:08:53.326907 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:08:53.327244 [debug] [MainThread]: Acquiring new trino connection 'debug'
[0m19:08:53.329534 [debug] [MainThread]: Using trino connection "debug"
[0m19:08:53.329748 [debug] [MainThread]: On debug: select 1 as id
[0m19:08:53.329912 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:08:53.361585 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:08:53.362278 [debug] [MainThread]: On debug: Close
[0m19:08:53.362654 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:08:53.362973 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:08:53.364312 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:08:53.364549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ac5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ac45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbe0b8d50>]}
[0m19:08:53.364847 [debug] [MainThread]: Flushing usage events
[0m19:12:55.555371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f0a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb13378d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb28878d0>]}


============================== 19:12:55.557589 | 542e55ae-8c1a-4b81-84b2-801ae29cbde6 ==============================
[0m19:12:55.557589 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:12:55.558053 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'printer_width': '80', 'partial_parse': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt compile', 'indirect_selection': 'eager', 'log_format': 'default', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True'}
[0m19:12:55.688397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '542e55ae-8c1a-4b81-84b2-801ae29cbde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2292d90>]}
[0m19:12:55.750676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '542e55ae-8c1a-4b81-84b2-801ae29cbde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b4b410>]}
[0m19:12:55.751087 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:12:55.756069 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:12:55.756704 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:12:55.756993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '542e55ae-8c1a-4b81-84b2-801ae29cbde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0bdaf90>]}
[0m19:12:56.276676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '542e55ae-8c1a-4b81-84b2-801ae29cbde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0747fd0>]}
[0m19:12:56.284538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '542e55ae-8c1a-4b81-84b2-801ae29cbde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb035b410>]}
[0m19:12:56.284813 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m19:12:56.285114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '542e55ae-8c1a-4b81-84b2-801ae29cbde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0328410>]}
[0m19:12:56.286111 [info ] [MainThread]: 
[0m19:12:56.286563 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:12:56.287241 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_staging'
[0m19:12:56.287695 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_intermediate'
[0m19:12:56.295622 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m19:12:56.296019 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_marts'
[0m19:12:56.298039 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m19:12:56.298297 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m19:12:56.300177 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m19:12:56.300461 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m19:12:56.300775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:56.301051 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m19:12:56.301325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:56.302078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:12:56.639089 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:12:56.640709 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:12:56.642211 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m19:12:56.642966 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:12:56.643584 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m19:12:56.644008 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m19:12:56.644672 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m19:12:56.644946 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m19:12:56.645610 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m19:12:56.646618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '542e55ae-8c1a-4b81-84b2-801ae29cbde6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb08c1450>]}
[0m19:12:56.647086 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:12:56.647291 [info ] [MainThread]: 
[0m19:12:56.654974 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m19:12:56.655198 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m19:12:56.655377 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m19:12:56.655833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_orders)
[0m19:12:56.656264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_products)
[0m19:12:56.656667 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_suppliers)
[0m19:12:56.656938 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m19:12:56.657173 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m19:12:56.657388 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m19:12:56.659272 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m19:12:56.660158 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m19:12:56.661016 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m19:12:56.663288 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 19:12:56.657551 => 19:12:56.663156
[0m19:12:56.663556 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m19:12:56.663732 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 19:12:56.659471 => 19:12:56.663639
[0m19:12:56.664068 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 19:12:56.663977 => 19:12:56.663987
[0m19:12:56.664227 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 19:12:56.660338 => 19:12:56.664146
[0m19:12:56.664456 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m19:12:56.664967 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m19:12:56.665182 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m19:12:56.665428 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 19:12:56.665344 => 19:12:56.665348
[0m19:12:56.665855 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 19:12:56.665768 => 19:12:56.665772
[0m19:12:56.666336 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m19:12:56.666815 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m19:12:56.667460 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m19:12:56.667923 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.int_orders_enriched'
[0m19:12:56.669497 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m19:12:56.671536 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m19:12:56.673767 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 19:12:56.669686 => 19:12:56.673609
[0m19:12:56.674053 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m19:12:56.674404 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 19:12:56.674308 => 19:12:56.674318
[0m19:12:56.674887 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m19:12:56.675302 [debug] [Thread-2 (]: Began running node model.greencard_analytics.fct_orders
[0m19:12:56.675686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_products, now model.greencard_analytics.fct_orders)
[0m19:12:56.675920 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.fct_orders
[0m19:12:56.677484 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.fct_orders"
[0m19:12:56.678702 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (compile): 19:12:56.676070 => 19:12:56.678597
[0m19:12:56.678935 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.fct_orders
[0m19:12:56.679200 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (execute): 19:12:56.679109 => 19:12:56.679115
[0m19:12:56.679679 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.fct_orders
[0m19:12:56.680383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:12:56.680569 [debug] [MainThread]: Connection 'model.greencard_analytics.fct_orders' was properly closed.
[0m19:12:56.680746 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m19:12:56.680930 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m19:12:56.681107 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m19:12:56.687719 [debug] [MainThread]: Command end result
[0m19:12:56.702087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ea4650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f1d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb64f8d50>]}
[0m19:12:56.702448 [debug] [MainThread]: Flushing usage events
[0m19:14:08.962412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d0c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d0e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d0d850>]}


============================== 19:14:08.964524 | fd5c89fc-75b4-4189-9188-14e2c7aa28e7 ==============================
[0m19:14:08.964524 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:14:08.964915 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'static_parser': 'True', 'no_print': 'None', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'quiet': 'False', 'version_check': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'cache_selected_only': 'False'}
[0m19:14:09.082448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd5c89fc-75b4-4189-9188-14e2c7aa28e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d1e5d0>]}
[0m19:14:09.141752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd5c89fc-75b4-4189-9188-14e2c7aa28e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828e3450>]}
[0m19:14:09.142122 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:14:09.146120 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:14:09.164138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:09.164372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:09.167080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd5c89fc-75b4-4189-9188-14e2c7aa28e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82767b90>]}
[0m19:14:09.175297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd5c89fc-75b4-4189-9188-14e2c7aa28e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828202d0>]}
[0m19:14:09.175555 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m19:14:09.175831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd5c89fc-75b4-4189-9188-14e2c7aa28e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827eb090>]}
[0m19:14:09.176716 [info ] [MainThread]: 
[0m19:14:09.177256 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:14:09.177979 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:14:09.178390 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:14:09.184792 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:14:09.186486 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:14:09.187691 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:14:09.188844 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:14:09.189092 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:14:09.189328 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:14:09.189556 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:14:09.189841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:09.190062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:09.190270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:09.268490 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:14:09.273627 [debug] [ThreadPool]: On list_postgres: Close
[0m19:14:09.274751 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:14:09.275183 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:14:09.277551 [debug] [ThreadPool]: On list_postgres: Close
[0m19:14:09.278946 [debug] [ThreadPool]: On list_postgres: Close
[0m19:14:09.280990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_analytics_staging)
[0m19:14:09.281362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_analytics_marts)
[0m19:14:09.281667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_analytics_intermediate)
[0m19:14:09.282206 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "analytics_staging"
"
[0m19:14:09.282698 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "analytics_marts"
"
[0m19:14:09.283130 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "analytics_intermediate"
"
[0m19:14:09.285956 [debug] [ThreadPool]: Using trino connection "create_postgres_analytics_staging"
[0m19:14:09.287148 [debug] [ThreadPool]: Using trino connection "create_postgres_analytics_marts"
[0m19:14:09.288277 [debug] [ThreadPool]: Using trino connection "create_postgres_analytics_intermediate"
[0m19:14:09.288562 [debug] [ThreadPool]: On create_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "create_postgres_analytics_staging"} */
create schema if not exists "postgres"."analytics_staging"
[0m19:14:09.288804 [debug] [ThreadPool]: On create_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "create_postgres_analytics_marts"} */
create schema if not exists "postgres"."analytics_marts"
[0m19:14:09.289058 [debug] [ThreadPool]: On create_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "create_postgres_analytics_intermediate"} */
create schema if not exists "postgres"."analytics_intermediate"
[0m19:14:09.289278 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:09.289506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:09.289721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:09.316766 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:14:09.317294 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:14:09.317563 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:14:09.318361 [debug] [ThreadPool]: On create_postgres_analytics_marts: COMMIT
[0m19:14:09.318861 [debug] [ThreadPool]: On create_postgres_analytics_staging: COMMIT
[0m19:14:09.319289 [debug] [ThreadPool]: On create_postgres_analytics_intermediate: COMMIT
[0m19:14:09.319483 [debug] [ThreadPool]: On create_postgres_analytics_marts: Close
[0m19:14:09.319658 [debug] [ThreadPool]: On create_postgres_analytics_staging: Close
[0m19:14:09.319836 [debug] [ThreadPool]: On create_postgres_analytics_intermediate: Close
[0m19:14:09.322042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_analytics_intermediate, now list_postgres_analytics_staging)
[0m19:14:09.322405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_analytics_staging, now list_postgres_analytics_marts)
[0m19:14:09.322749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_analytics_marts, now list_postgres_analytics_intermediate)
[0m19:14:09.326644 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m19:14:09.328559 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m19:14:09.330449 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m19:14:09.330740 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m19:14:09.331006 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m19:14:09.331853 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m19:14:09.332361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:09.332714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:09.332932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:09.520472 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:14:09.521064 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:14:09.521381 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:14:09.522279 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m19:14:09.522882 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m19:14:09.523464 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m19:14:09.523730 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m19:14:09.523955 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m19:14:09.524171 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m19:14:09.525988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd5c89fc-75b4-4189-9188-14e2c7aa28e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82719f50>]}
[0m19:14:09.526275 [debug] [MainThread]: On master: COMMIT
[0m19:14:09.526611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:14:09.526933 [info ] [MainThread]: 
[0m19:14:09.529177 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m19:14:09.529410 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m19:14:09.529624 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m19:14:09.529873 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m19:14:09.530620 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_staging.stg_products ..................... [RUN]
[0m19:14:09.531220 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_staging.stg_suppliers .................... [RUN]
[0m19:14:09.531864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_orders)
[0m19:14:09.532327 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_products)
[0m19:14:09.532732 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_suppliers)
[0m19:14:09.532997 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m19:14:09.533210 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m19:14:09.533426 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m19:14:09.535369 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m19:14:09.536274 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m19:14:09.538032 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m19:14:09.539267 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 19:14:09.533606 => 19:14:09.539167
[0m19:14:09.539475 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 19:14:09.535542 => 19:14:09.539376
[0m19:14:09.539779 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m19:14:09.540007 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 19:14:09.536462 => 19:14:09.539906
[0m19:14:09.540255 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m19:14:09.580585 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m19:14:09.580836 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m19:14:09.582334 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m19:14:09.583850 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m19:14:09.586163 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:14:09.586631 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:14:09.586889 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  create or replace view
    "postgres"."analytics_staging"."stg_orders"
  security definer
  as
    -- Clean orders from PostgreSQL
SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM "postgres"."public"."orders"
WHERE amount > 0
    AND status = 'completed'
  
[0m19:14:09.587455 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:14:09.587604 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  create or replace view
    "postgres"."analytics_staging"."stg_suppliers"
  security definer
  as
    -- Clean suppliers from MySQL
SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
  
[0m19:14:09.587871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:09.588116 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  create or replace view
    "postgres"."analytics_staging"."stg_products"
  security definer
  as
    -- Clean products from MySQL
SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
  
[0m19:14:09.588324 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:14:09.589207 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:14:09.634685 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251010_191409_00025_ms8cr
[0m19:14:09.637396 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251010_191409_00025_ms8cr)
[0m19:14:09.639260 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 19:14:09.540449 => 19:14:09.638871
[0m19:14:09.639806 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m19:14:09.640497 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m19:14:09.654704 [debug] [Thread-2 (]: Trino adapter: Trino query id: 20251010_191409_00027_ms8cr
[0m19:14:09.656581 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251010_191409_00025_ms8cr)
  compiled Code at target/run/greencard_analytics/models/staging/stg_orders.sql
[0m19:14:09.656837 [debug] [Thread-2 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251010_191409_00027_ms8cr)
[0m19:14:09.657801 [debug] [Thread-3 (]: Trino adapter: Trino query id: 20251010_191409_00026_ms8cr
[0m19:14:09.658157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5c89fc-75b4-4189-9188-14e2c7aa28e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82869a90>]}
[0m19:14:09.658786 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 19:14:09.581103 => 19:14:09.658681
[0m19:14:09.659061 [debug] [Thread-3 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251010_191409_00026_ms8cr)
[0m19:14:09.659443 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model analytics_staging.stg_orders .............. [[31mERROR[0m in 0.13s]
[0m19:14:09.659722 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m19:14:09.660091 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 19:14:09.582730 => 19:14:09.660008
[0m19:14:09.660390 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m19:14:09.660612 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m19:14:09.660840 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m19:14:09.662956 [debug] [Thread-2 (]: Database Error in model stg_products (models/staging/stg_products.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251010_191409_00027_ms8cr)
  compiled Code at target/run/greencard_analytics/models/staging/stg_products.sql
[0m19:14:09.663149 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m19:14:09.663456 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5c89fc-75b4-4189-9188-14e2c7aa28e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827ceed0>]}
[0m19:14:09.665011 [debug] [Thread-3 (]: Database Error in model stg_suppliers (models/staging/stg_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251010_191409_00026_ms8cr)
  compiled Code at target/run/greencard_analytics/models/staging/stg_suppliers.sql
[0m19:14:09.665306 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model analytics_staging.stg_products ............ [[31mERROR[0m in 0.13s]
[0m19:14:09.665649 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5c89fc-75b4-4189-9188-14e2c7aa28e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837b7810>]}
[0m19:14:09.665929 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m19:14:09.666220 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model analytics_staging.stg_suppliers ........... [[31mERROR[0m in 0.13s]
[0m19:14:09.666730 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m19:14:09.667140 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m19:14:09.667430 [info ] [Thread-4 (]: 4 of 5 SKIP relation analytics_intermediate.int_orders_enriched ................ [[33mSKIP[0m]
[0m19:14:09.667663 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m19:14:09.668035 [debug] [Thread-2 (]: Began running node model.greencard_analytics.fct_orders
[0m19:14:09.668247 [info ] [Thread-2 (]: 5 of 5 SKIP relation analytics_marts.fct_orders ................................ [[33mSKIP[0m]
[0m19:14:09.668528 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.fct_orders
[0m19:14:09.669464 [debug] [MainThread]: On master: COMMIT
[0m19:14:09.669837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:09.670035 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_products' was properly closed.
[0m19:14:09.670221 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m19:14:09.670389 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m19:14:09.670613 [info ] [MainThread]: 
[0m19:14:09.670988 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m19:14:09.671489 [debug] [MainThread]: Command end result
[0m19:14:09.677462 [info ] [MainThread]: 
[0m19:14:09.677748 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:14:09.678176 [info ] [MainThread]: 
[0m19:14:09.678387 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251010_191409_00025_ms8cr)
  compiled Code at target/run/greencard_analytics/models/staging/stg_orders.sql
[0m19:14:09.678589 [info ] [MainThread]: 
[0m19:14:09.678789 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251010_191409_00027_ms8cr)
  compiled Code at target/run/greencard_analytics/models/staging/stg_products.sql
[0m19:14:09.679008 [info ] [MainThread]: 
[0m19:14:09.679201 [error] [MainThread]:   Database Error in model stg_suppliers (models/staging/stg_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251010_191409_00026_ms8cr)
  compiled Code at target/run/greencard_analytics/models/staging/stg_suppliers.sql
[0m19:14:09.679397 [info ] [MainThread]: 
[0m19:14:09.679595 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m19:14:09.680133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d25710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff832bca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82c9bc90>]}
[0m19:14:09.680348 [debug] [MainThread]: Flushing usage events
[0m19:15:20.624843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb0ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb0c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb0c610>]}


============================== 19:15:20.626943 | 0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3 ==============================
[0m19:15:20.626943 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:15:20.627354 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/usr/app/logs', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None'}
[0m19:15:20.750350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb1e5d0>]}
[0m19:15:20.810533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad758cd0>]}
[0m19:15:20.810943 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:15:20.815643 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:15:20.821975 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:15:20.822336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad4755d0>]}
[0m19:15:21.300162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb77f50>]}
[0m19:15:21.306336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac70d390>]}
[0m19:15:21.306607 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m19:15:21.306893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb28910>]}
[0m19:15:21.307867 [info ] [MainThread]: 
[0m19:15:21.308306 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:15:21.309048 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:15:21.309523 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:15:21.315483 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:15:21.317348 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:15:21.318694 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:15:21.319881 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:15:21.320125 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:15:21.320382 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:15:21.320627 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:15:21.320847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:21.321056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:21.321280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:21.407616 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:21.408614 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:21.409035 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:21.410094 [debug] [ThreadPool]: On list_postgres: Close
[0m19:15:21.410884 [debug] [ThreadPool]: On list_postgres: Close
[0m19:15:21.411500 [debug] [ThreadPool]: On list_postgres: Close
[0m19:15:21.413899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m19:15:21.414387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m19:15:21.418702 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m19:15:21.419149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m19:15:21.421247 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m19:15:21.421498 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m19:15:21.423352 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m19:15:21.423594 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m19:15:21.423826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:21.424034 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m19:15:21.424251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:21.425335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:21.606473 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:21.608879 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m19:15:21.609832 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m19:15:21.631475 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:21.634937 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m19:15:21.635335 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m19:15:21.636209 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:21.637879 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m19:15:21.638343 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m19:15:21.642687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad34fe10>]}
[0m19:15:21.643958 [debug] [MainThread]: On master: COMMIT
[0m19:15:21.645228 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:15:21.647252 [info ] [MainThread]: 
[0m19:15:21.650597 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m19:15:21.650963 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m19:15:21.651167 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m19:15:21.651628 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m19:15:21.652188 [info ] [Thread-2 (]: 2 of 5 START sql table model analytics_staging.stg_products .................... [RUN]
[0m19:15:21.652783 [info ] [Thread-3 (]: 3 of 5 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m19:15:21.653503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_orders)
[0m19:15:21.653988 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_products)
[0m19:15:21.654372 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_suppliers)
[0m19:15:21.654598 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m19:15:21.654862 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m19:15:21.655095 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m19:15:21.657122 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m19:15:21.658096 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m19:15:21.658947 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m19:15:21.660093 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 19:15:21.655351 => 19:15:21.659975
[0m19:15:21.660289 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 19:15:21.657357 => 19:15:21.660206
[0m19:15:21.660542 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m19:15:21.660704 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 19:15:21.658322 => 19:15:21.660623
[0m19:15:21.660954 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m19:15:21.685312 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m19:15:21.694098 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m19:15:21.696163 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m19:15:21.697921 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m19:15:21.699403 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:15:21.699763 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "postgres"."analytics_staging"."stg_orders__dbt_tmp"
      
      
    as (
      -- Clean orders from PostgreSQL
SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM "postgres"."public"."orders"
WHERE amount > 0
    AND status = 'completed'
    )
[0m19:15:21.700313 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:15:21.700553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:21.701021 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:15:21.701293 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "postgres"."analytics_staging"."stg_products__dbt_tmp"
      
      
    as (
      -- Clean products from MySQL
SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m19:15:21.702190 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      
    as (
      -- Clean suppliers from MySQL
SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m19:15:21.702918 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:15:21.703154 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:15:22.030320 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:22.036595 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:22.037074 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:22.036164 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:15:22.039343 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:15:22.041055 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:15:22.041352 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders__dbt_tmp" rename to "postgres"."analytics_staging"."stg_orders"
[0m19:15:22.041622 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "postgres"."analytics_staging"."stg_suppliers"
[0m19:15:22.041899 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products__dbt_tmp" rename to "postgres"."analytics_staging"."stg_products"
[0m19:15:22.067434 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:22.073541 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m19:15:22.074156 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:22.074444 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:22.075554 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:15:22.077524 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m19:15:22.079021 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m19:15:22.079248 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m19:15:22.079693 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:15:22.080108 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:15:22.080894 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m19:15:22.081154 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m19:15:22.101142 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:22.102326 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:22.108759 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:15:22.114959 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 19:15:21.696424 => 19:15:22.114841
[0m19:15:22.116657 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 19:15:21.694442 => 19:15:22.116568
[0m19:15:22.117737 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 19:15:21.661152 => 19:15:22.117656
[0m19:15:22.117999 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m19:15:22.118272 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m19:15:22.118519 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m19:15:22.118731 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m19:15:22.119002 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m19:15:22.119283 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m19:15:22.119968 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0df6f10>]}
[0m19:15:22.120466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac73f8d0>]}
[0m19:15:22.120887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac73b090>]}
[0m19:15:22.121287 [info ] [Thread-3 (]: 3 of 5 OK created sql table model analytics_staging.stg_suppliers .............. [[32mSUCCESS[0m in 0.47s]
[0m19:15:22.121747 [info ] [Thread-2 (]: 2 of 5 OK created sql table model analytics_staging.stg_products ............... [[32mSUCCESS[0m in 0.47s]
[0m19:15:22.122120 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics_staging.stg_orders ................. [[32mSUCCESS[0m in 0.47s]
[0m19:15:22.122549 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m19:15:22.122880 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m19:15:22.123222 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m19:15:22.124180 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m19:15:22.124530 [info ] [Thread-4 (]: 4 of 5 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m19:15:22.125109 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.int_orders_enriched'
[0m19:15:22.125562 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m19:15:22.129661 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m19:15:22.131515 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 19:15:22.125886 => 19:15:22.131396
[0m19:15:22.131768 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m19:15:22.133843 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m19:15:22.135799 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:15:22.136165 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

V u ma e   ' l 
products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    -- Product info from MySQL
    p.product_name,
    p.category,
    p.price,
    
    -- Supplier info from MySQL
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    -- Calculated fields
    CASE 
        WHEN o.amount >= 500 THEN 'Himmmm m Vma lVumae 'l
 VE LSuE  m'La oe  w  'V al l
ue 'V
E    L SEuNDE   m'Las order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN 'Excellent'
        WHEN s.sustainability_score >= 60 THEN 'Good'
        ELSE 'Fair'
    END as sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m19:15:22.136504 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:15:22.142057 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20251010_191522_00043_ms8cr
[0m19:15:22.142379 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 17:3: mismatched input 'u'. Expecting: '(', 'AS'", query_id=20251010_191522_00043_ms8cr)
[0m19:15:22.142779 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 19:15:22.131947 => 19:15:22.142663
[0m19:15:22.143024 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m19:15:22.143237 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m19:15:22.146430 [debug] [Thread-4 (]: Database Error in model int_orders_enriched (models/intermediate/int_orders_enriched.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 17:3: mismatched input 'u'. Expecting: '(', 'AS'", query_id=20251010_191522_00043_ms8cr)
  compiled Code at target/run/greencard_analytics/models/intermediate/int_orders_enriched.sql
[0m19:15:22.146851 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b3ecfe8-4248-44ba-9c92-2b4e3bfacbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad365550>]}
[0m19:15:22.147253 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model analytics_intermediate.int_orders_enriched  [[31mERROR[0m in 0.02s]
[0m19:15:22.147626 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m19:15:22.148418 [debug] [Thread-2 (]: Began running node model.greencard_analytics.fct_orders
[0m19:15:22.148729 [info ] [Thread-2 (]: 5 of 5 SKIP relation analytics_marts.fct_orders ................................ [[33mSKIP[0m]
[0m19:15:22.148998 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.fct_orders
[0m19:15:22.150053 [debug] [MainThread]: On master: COMMIT
[0m19:15:22.150472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:22.150679 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m19:15:22.150860 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m19:15:22.151034 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_products' was properly closed.
[0m19:15:22.151217 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m19:15:22.151453 [info ] [MainThread]: 
[0m19:15:22.151749 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m19:15:22.152303 [debug] [MainThread]: Command end result
[0m19:15:22.157959 [info ] [MainThread]: 
[0m19:15:22.158331 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:15:22.158569 [info ] [MainThread]: 
[0m19:15:22.158798 [error] [MainThread]:   Database Error in model int_orders_enriched (models/intermediate/int_orders_enriched.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 17:3: mismatched input 'u'. Expecting: '(', 'AS'", query_id=20251010_191522_00043_ms8cr)
  compiled Code at target/run/greencard_analytics/models/intermediate/int_orders_enriched.sql
[0m19:15:22.159041 [info ] [MainThread]: 
[0m19:15:22.159292 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m19:15:22.159886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb1f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb1ea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae0bc650>]}
[0m19:15:22.160117 [debug] [MainThread]: Flushing usage events
[0m19:16:15.493013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9890c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9891d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9891e990>]}


============================== 19:16:15.495110 | ecb18f20-2c48-4971-a01b-2ec9cea0c32f ==============================
[0m19:16:15.495110 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:16:15.495523 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'log_path': '/usr/app/logs', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'invocation_command': 'dbt run', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:16:15.623524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecb18f20-2c48-4971-a01b-2ec9cea0c32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9844a9d0>]}
[0m19:16:15.685709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecb18f20-2c48-4971-a01b-2ec9cea0c32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98577010>]}
[0m19:16:15.686227 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:16:15.690310 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:16:15.707021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:16:15.707334 [debug] [MainThread]: Partial parsing: updated file: greencard_analytics://models/intermediate/int_orders_enriched.sql
[0m19:16:15.798958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecb18f20-2c48-4971-a01b-2ec9cea0c32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9812b090>]}
[0m19:16:15.831873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecb18f20-2c48-4971-a01b-2ec9cea0c32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff982f2cd0>]}
[0m19:16:15.832221 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m19:16:15.832578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb18f20-2c48-4971-a01b-2ec9cea0c32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9842e550>]}
[0m19:16:15.833546 [info ] [MainThread]: 
[0m19:16:15.834021 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:16:15.834799 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:16:15.835272 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:16:15.843091 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:16:15.843460 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:16:15.844723 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:16:15.844953 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:16:15.846075 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:16:15.846282 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:16:15.846470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:15.846649 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:16:15.846821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:15.847246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:15.919952 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:15.922300 [debug] [ThreadPool]: On list_postgres: Close
[0m19:16:15.922703 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:15.923042 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:15.924163 [debug] [ThreadPool]: On list_postgres: Close
[0m19:16:15.924948 [debug] [ThreadPool]: On list_postgres: Close
[0m19:16:15.927321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m19:16:15.928011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m19:16:15.928581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m19:16:15.934001 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m19:16:15.936157 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m19:16:15.938625 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m19:16:15.938925 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m19:16:15.939233 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m19:16:15.939513 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m19:16:15.939804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:15.940068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:15.940311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:16.093837 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.099766 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m19:16:16.101756 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m19:16:16.106033 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.107838 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m19:16:16.109854 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m19:16:16.115262 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.116354 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m19:16:16.116671 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m19:16:16.117758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb18f20-2c48-4971-a01b-2ec9cea0c32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98504790>]}
[0m19:16:16.118082 [debug] [MainThread]: On master: COMMIT
[0m19:16:16.118492 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:16:16.118805 [info ] [MainThread]: 
[0m19:16:16.120745 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m19:16:16.120954 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m19:16:16.121127 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m19:16:16.121449 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m19:16:16.121818 [info ] [Thread-2 (]: 2 of 5 START sql table model analytics_staging.stg_products .................... [RUN]
[0m19:16:16.122195 [info ] [Thread-3 (]: 3 of 5 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m19:16:16.122633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_orders)
[0m19:16:16.123016 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_products)
[0m19:16:16.123496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_suppliers)
[0m19:16:16.123774 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m19:16:16.124012 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m19:16:16.124286 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m19:16:16.126169 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m19:16:16.127766 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m19:16:16.129288 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m19:16:16.131415 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 19:16:16.124492 => 19:16:16.131277
[0m19:16:16.131740 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m19:16:16.132042 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 19:16:16.126361 => 19:16:16.131954
[0m19:16:16.132223 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 19:16:16.128157 => 19:16:16.132145
[0m19:16:16.150075 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m19:16:16.151831 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m19:16:16.152173 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m19:16:16.154262 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m19:16:16.156565 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m19:16:16.157554 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:16:16.157880 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "postgres"."analytics_staging"."stg_orders__dbt_tmp"
      
      
    as (
      -- Clean orders from PostgreSQL
SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM "postgres"."public"."orders"
WHERE amount > 0
    AND status = 'completed'
    )
[0m19:16:16.158419 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:16:16.158969 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:16:16.159107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:16.159304 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "postgres"."analytics_staging"."stg_products__dbt_tmp"
      
      
    as (
      -- Clean products from MySQL
SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m19:16:16.159530 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      
    as (
      -- Clean suppliers from MySQL
SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m19:16:16.160415 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:16:16.160708 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:16:16.330460 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.331104 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.335048 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:16:16.345774 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers" rename to "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m19:16:16.342036 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:16:16.354308 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders" rename to "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m19:16:16.357368 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.362608 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:16:16.363975 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products" rename to "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m19:16:16.391149 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.395567 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:16:16.395975 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.396533 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "postgres"."analytics_staging"."stg_suppliers"
[0m19:16:16.402515 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:16:16.407960 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.408539 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders__dbt_tmp" rename to "postgres"."analytics_staging"."stg_orders"
[0m19:16:16.413302 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:16:16.426505 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products__dbt_tmp" rename to "postgres"."analytics_staging"."stg_products"
[0m19:16:16.448501 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.453816 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m19:16:16.457738 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:16:16.459863 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m19:16:16.461601 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.468105 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m19:16:16.468814 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.476792 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:16:16.480011 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m19:16:16.480799 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m19:16:16.482008 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:16:16.484259 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m19:16:16.503952 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.523278 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 19:16:16.154987 => 19:16:16.523171
[0m19:16:16.523751 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.524404 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m19:16:16.525491 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:16:16.526725 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 19:16:16.152373 => 19:16:16.526641
[0m19:16:16.527206 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m19:16:16.528508 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 19:16:16.132311 => 19:16:16.528429
[0m19:16:16.528797 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m19:16:16.529433 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb18f20-2c48-4971-a01b-2ec9cea0c32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f53510>]}
[0m19:16:16.529662 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m19:16:16.529921 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m19:16:16.530300 [info ] [Thread-3 (]: 3 of 5 OK created sql table model analytics_staging.stg_suppliers .............. [[32mSUCCESS[0m in 0.41s]
[0m19:16:16.530656 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m19:16:16.531252 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb18f20-2c48-4971-a01b-2ec9cea0c32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff980b6710>]}
[0m19:16:16.531594 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m19:16:16.532076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb18f20-2c48-4971-a01b-2ec9cea0c32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983db190>]}
[0m19:16:16.532394 [info ] [Thread-2 (]: 2 of 5 OK created sql table model analytics_staging.stg_products ............... [[32mSUCCESS[0m in 0.41s]
[0m19:16:16.533114 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics_staging.stg_orders ................. [[32mSUCCESS[0m in 0.41s]
[0m19:16:16.533548 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m19:16:16.533880 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m19:16:16.534702 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m19:16:16.535058 [info ] [Thread-4 (]: 4 of 5 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m19:16:16.535542 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.int_orders_enriched'
[0m19:16:16.535775 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m19:16:16.537568 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m19:16:16.538637 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 19:16:16.535951 => 19:16:16.538547
[0m19:16:16.538849 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m19:16:16.540928 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m19:16:16.542723 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:16:16.542966 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN 'High Value'
        WHEN o.amount >= 100 THEN 'MediuNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN s.sustainability_score >= 80 THEN 'Excellent'
        WHEN s.sustainability_score >= 60 THEN 'Good'
        ELSE 'Fair'
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m19:16:16.543206 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:16:16.556357 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20251010_191616_00062_ms8cr
[0m19:16:16.557156 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 42:166: mismatched input 'Excellent'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'ELSE', 'END', 'OR', 'WHEN', '[', '||', <predicate>", query_id=20251010_191616_00062_ms8cr)
[0m19:16:16.559310 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 19:16:16.539021 => 19:16:16.557658
[0m19:16:16.559638 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m19:16:16.559881 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m19:16:16.562720 [debug] [Thread-4 (]: Database Error in model int_orders_enriched (models/intermediate/int_orders_enriched.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 42:166: mismatched input 'Excellent'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'ELSE', 'END', 'OR', 'WHEN', '[', '||', <predicate>", query_id=20251010_191616_00062_ms8cr)
  compiled Code at target/run/greencard_analytics/models/intermediate/int_orders_enriched.sql
[0m19:16:16.563237 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb18f20-2c48-4971-a01b-2ec9cea0c32f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f80190>]}
[0m19:16:16.563723 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model analytics_intermediate.int_orders_enriched  [[31mERROR[0m in 0.03s]
[0m19:16:16.564269 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m19:16:16.566294 [debug] [Thread-2 (]: Began running node model.greencard_analytics.fct_orders
[0m19:16:16.568332 [info ] [Thread-2 (]: 5 of 5 SKIP relation analytics_marts.fct_orders ................................ [[33mSKIP[0m]
[0m19:16:16.569181 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.fct_orders
[0m19:16:16.571580 [debug] [MainThread]: On master: COMMIT
[0m19:16:16.572080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:16.572329 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_products' was properly closed.
[0m19:16:16.572536 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m19:16:16.572708 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m19:16:16.572888 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m19:16:16.573126 [info ] [MainThread]: 
[0m19:16:16.573439 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m19:16:16.574675 [debug] [MainThread]: Command end result
[0m19:16:16.580559 [info ] [MainThread]: 
[0m19:16:16.580896 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:16:16.581237 [info ] [MainThread]: 
[0m19:16:16.581522 [error] [MainThread]:   Database Error in model int_orders_enriched (models/intermediate/int_orders_enriched.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 42:166: mismatched input 'Excellent'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'AT', 'ELSE', 'END', 'OR', 'WHEN', '[', '||', <predicate>", query_id=20251010_191616_00062_ms8cr)
  compiled Code at target/run/greencard_analytics/models/intermediate/int_orders_enriched.sql
[0m19:16:16.581783 [info ] [MainThread]: 
[0m19:16:16.582026 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m19:16:16.582737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9deb8bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9889bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9889bc90>]}
[0m19:16:16.582969 [debug] [MainThread]: Flushing usage events
[0m19:17:02.506122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60bf5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60bc3d0>]}


============================== 19:17:02.508280 | 714e4769-2b3d-4eac-9127-255dd096220d ==============================
[0m19:17:02.508280 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:17:02.508665 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'quiet': 'False', 'log_path': '/usr/app/logs', 'target_path': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select int_orders_enriched', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'printer_width': '80', 'partial_parse': 'True', 'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m19:17:02.639028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '714e4769-2b3d-4eac-9127-255dd096220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60ddc50>]}
[0m19:17:02.705379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '714e4769-2b3d-4eac-9127-255dd096220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5f85890>]}
[0m19:17:02.705844 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:17:02.710709 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:17:02.730796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:17:02.731138 [debug] [MainThread]: Partial parsing: updated file: greencard_analytics://models/intermediate/int_orders_enriched.sql
[0m19:17:02.822232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '714e4769-2b3d-4eac-9127-255dd096220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5943290>]}
[0m19:17:02.854940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '714e4769-2b3d-4eac-9127-255dd096220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b4fbd0>]}
[0m19:17:02.855285 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m19:17:02.855600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '714e4769-2b3d-4eac-9127-255dd096220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bbf510>]}
[0m19:17:02.856478 [info ] [MainThread]: 
[0m19:17:02.856952 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:17:02.857619 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:17:02.865547 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:17:02.865801 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:17:02.866006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:02.961308 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:17:02.962322 [debug] [ThreadPool]: On list_postgres: Close
[0m19:17:02.963488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m19:17:02.963944 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_intermediate'
[0m19:17:02.968139 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m19:17:02.968625 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_staging'
[0m19:17:02.970728 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m19:17:02.971038 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m19:17:02.973016 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m19:17:02.973315 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m19:17:02.973596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:17:02.973871 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m19:17:02.975055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:02.974167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:03.195792 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:17:03.197802 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:17:03.198382 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:17:03.199944 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m19:17:03.202919 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m19:17:03.202426 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m19:17:03.201301 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m19:17:03.204505 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m19:17:03.205067 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m19:17:03.208575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '714e4769-2b3d-4eac-9127-255dd096220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa592b090>]}
[0m19:17:03.209481 [debug] [MainThread]: On master: COMMIT
[0m19:17:03.210578 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:17:03.211402 [info ] [MainThread]: 
[0m19:17:03.213608 [debug] [Thread-1 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m19:17:03.213994 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m19:17:03.214649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.int_orders_enriched)
[0m19:17:03.214910 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m19:17:03.217846 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m19:17:03.219506 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 19:17:03.215084 => 19:17:03.219385
[0m19:17:03.219873 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m19:17:03.239183 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m19:17:03.241946 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:17:03.242283 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m19:17:03.242556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:17:03.582327 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:17:03.586154 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:17:03.586467 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_enriched"
[0m19:17:03.601201 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:17:03.605062 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m19:17:03.606198 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:17:03.606415 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m19:17:03.633193 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:17:03.642945 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 19:17:03.220090 => 19:17:03.642834
[0m19:17:03.643285 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m19:17:03.643575 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m19:17:03.644164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '714e4769-2b3d-4eac-9127-255dd096220d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bbd590>]}
[0m19:17:03.644563 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_intermediate.int_orders_enriched ... [[32mSUCCESS[0m in 0.43s]
[0m19:17:03.644954 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m19:17:03.646088 [debug] [MainThread]: On master: COMMIT
[0m19:17:03.646484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:03.646690 [debug] [MainThread]: Connection 'list_postgres_analytics_marts' was properly closed.
[0m19:17:03.646888 [debug] [MainThread]: Connection 'list_postgres_analytics_intermediate' was properly closed.
[0m19:17:03.647097 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m19:17:03.647322 [info ] [MainThread]: 
[0m19:17:03.647569 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m19:17:03.647951 [debug] [MainThread]: Command end result
[0m19:17:03.653254 [info ] [MainThread]: 
[0m19:17:03.653558 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:17:03.653803 [info ] [MainThread]: 
[0m19:17:03.654079 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:17:03.654699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa60b3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6119a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab6d83d0>]}
[0m19:17:03.654936 [debug] [MainThread]: Flushing usage events
[0m19:24:09.039429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9550c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9550e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95502410>]}


============================== 19:24:09.041555 | 6288c74e-aa6c-4cc1-b89a-e07252150d61 ==============================
[0m19:24:09.041555 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:24:09.041963 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt'}
[0m19:24:09.162456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6288c74e-aa6c-4cc1-b89a-e07252150d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950452d0>]}
[0m19:24:09.222324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6288c74e-aa6c-4cc1-b89a-e07252150d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9515c890>]}
[0m19:24:09.222726 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:24:09.226996 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:24:09.246899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:09.247128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:09.249980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6288c74e-aa6c-4cc1-b89a-e07252150d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95174ad0>]}
[0m19:24:09.256764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6288c74e-aa6c-4cc1-b89a-e07252150d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f9a990>]}
[0m19:24:09.257063 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m19:24:09.257282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6288c74e-aa6c-4cc1-b89a-e07252150d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9917bd90>]}
[0m19:24:09.258245 [info ] [MainThread]: 
[0m19:24:09.258710 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:24:09.259501 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:24:09.259946 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:24:09.266443 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:24:09.268217 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:24:09.269462 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:24:09.270634 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:24:09.270865 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:24:09.271122 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:24:09.271349 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:24:09.271566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:09.271787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:09.272013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:09.312716 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.313292 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.313745 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.314552 [debug] [ThreadPool]: On list_postgres: Close
[0m19:24:09.315286 [debug] [ThreadPool]: On list_postgres: Close
[0m19:24:09.315969 [debug] [ThreadPool]: On list_postgres: Close
[0m19:24:09.317963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m19:24:09.318353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m19:24:09.322525 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m19:24:09.322876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m19:24:09.324843 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m19:24:09.325410 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m19:24:09.327676 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m19:24:09.327969 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m19:24:09.328328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:09.328593 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m19:24:09.328805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:09.329642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:09.468954 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.472243 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m19:24:09.473771 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m19:24:09.485509 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.492252 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m19:24:09.494848 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.495472 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m19:24:09.497608 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m19:24:09.499166 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m19:24:09.501075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6288c74e-aa6c-4cc1-b89a-e07252150d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f2b4d0>]}
[0m19:24:09.502095 [debug] [MainThread]: On master: COMMIT
[0m19:24:09.502685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:24:09.503176 [info ] [MainThread]: 
[0m19:24:09.506131 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m19:24:09.506346 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m19:24:09.506571 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m19:24:09.506935 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m19:24:09.507639 [info ] [Thread-2 (]: 2 of 5 START sql table model analytics_staging.stg_products .................... [RUN]
[0m19:24:09.508207 [info ] [Thread-3 (]: 3 of 5 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m19:24:09.508838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_orders)
[0m19:24:09.509303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_products)
[0m19:24:09.509725 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_suppliers)
[0m19:24:09.510043 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m19:24:09.510360 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m19:24:09.510631 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m19:24:09.513026 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m19:24:09.513995 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m19:24:09.514855 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m19:24:09.517749 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 19:24:09.510865 => 19:24:09.517598
[0m19:24:09.517972 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 19:24:09.513254 => 19:24:09.517867
[0m19:24:09.518154 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 19:24:09.514199 => 19:24:09.518054
[0m19:24:09.518369 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m19:24:09.518595 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m19:24:09.518789 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m19:24:09.546224 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m19:24:09.546552 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m19:24:09.587764 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m19:24:09.590450 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:24:09.591097 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:24:09.591324 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "postgres"."analytics_staging"."stg_orders__dbt_tmp"
      
      
    as (
      -- Clean orders from PostgreSQL
SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM "postgres"."public"."orders"
WHERE amount > 0
    AND status = 'completed'
    )
[0m19:24:09.591818 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:24:09.592021 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "postgres"."analytics_staging"."stg_products__dbt_tmp"
      
      
    as (
      -- Clean products from MySQL
SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m19:24:09.592253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:09.592457 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      
    as (
      -- Clean suppliers from MySQL
SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m19:24:09.592668 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:24:09.593552 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:24:09.737668 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.744065 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:24:09.744803 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products" rename to "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m19:24:09.753002 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.758414 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.760566 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:24:09.762877 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:24:09.763299 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers" rename to "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m19:24:09.763569 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders" rename to "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m19:24:09.772165 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.774509 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:24:09.775817 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products__dbt_tmp" rename to "postgres"."analytics_staging"."stg_products"
[0m19:24:09.782098 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.782862 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.785928 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:24:09.788150 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:24:09.788459 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders__dbt_tmp" rename to "postgres"."analytics_staging"."stg_orders"
[0m19:24:09.788710 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "postgres"."analytics_staging"."stg_suppliers"
[0m19:24:09.799058 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.805631 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m19:24:09.807226 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m19:24:09.808504 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m19:24:09.810813 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.811325 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.812999 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m19:24:09.818076 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m19:24:09.819341 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m19:24:09.820396 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m19:24:09.820698 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m19:24:09.821017 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m19:24:09.827760 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.838133 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 19:24:09.538384 => 19:24:09.838004
[0m19:24:09.839255 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.839492 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m19:24:09.839941 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:09.841071 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 19:24:09.546780 => 19:24:09.840988
[0m19:24:09.841310 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m19:24:09.842340 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 19:24:09.518973 => 19:24:09.842267
[0m19:24:09.842572 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m19:24:09.843095 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6288c74e-aa6c-4cc1-b89a-e07252150d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94dc5d10>]}
[0m19:24:09.843299 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m19:24:09.843495 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m19:24:09.843847 [info ] [Thread-2 (]: 2 of 5 OK created sql table model analytics_staging.stg_products ............... [[32mSUCCESS[0m in 0.33s]
[0m19:24:09.844127 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m19:24:09.844605 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6288c74e-aa6c-4cc1-b89a-e07252150d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94df3490>]}
[0m19:24:09.844868 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m19:24:09.845356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6288c74e-aa6c-4cc1-b89a-e07252150d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94dd4210>]}
[0m19:24:09.845683 [info ] [Thread-3 (]: 3 of 5 OK created sql table model analytics_staging.stg_suppliers .............. [[32mSUCCESS[0m in 0.34s]
[0m19:24:09.846271 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics_staging.stg_orders ................. [[32mSUCCESS[0m in 0.34s]
[0m19:24:09.846612 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m19:24:09.846910 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m19:24:09.847674 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m19:24:09.847960 [info ] [Thread-4 (]: 4 of 5 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m19:24:09.848417 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.int_orders_enriched'
[0m19:24:09.848634 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m19:24:09.850442 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m19:24:09.851338 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 19:24:09.848796 => 19:24:09.851247
[0m19:24:09.851575 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m19:24:09.853547 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m19:24:09.855691 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:24:09.855987 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m19:24:09.856231 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:24:10.004687 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:10.010833 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:24:10.011191 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched" rename to "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m19:24:10.026601 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:10.028541 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:24:10.028778 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_enriched"
[0m19:24:10.042706 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:10.044675 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m19:24:10.045252 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:24:10.045487 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m19:24:10.059522 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:10.060982 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 19:24:09.851739 => 19:24:10.060860
[0m19:24:10.061276 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m19:24:10.061512 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m19:24:10.062046 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6288c74e-aa6c-4cc1-b89a-e07252150d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950adc10>]}
[0m19:24:10.062404 [info ] [Thread-4 (]: 4 of 5 OK created sql table model analytics_intermediate.int_orders_enriched ... [[32mSUCCESS[0m in 0.21s]
[0m19:24:10.062818 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m19:24:10.063362 [debug] [Thread-3 (]: Began running node model.greencard_analytics.fct_orders
[0m19:24:10.063599 [info ] [Thread-3 (]: 5 of 5 START sql table model analytics_marts.fct_orders ........................ [RUN]
[0m19:24:10.065599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_suppliers, now model.greencard_analytics.fct_orders)
[0m19:24:10.067127 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.fct_orders
[0m19:24:10.076447 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.fct_orders"
[0m19:24:10.078128 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.fct_orders (compile): 19:24:10.068010 => 19:24:10.077979
[0m19:24:10.078566 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.fct_orders
[0m19:24:10.081452 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.fct_orders"
[0m19:24:10.083200 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m19:24:10.083420 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

  
    

    create table "postgres"."analytics_marts"."fct_orders__dbt_tmp"
      
      
    as (
      -- Final fact table for analysis


SELECT
    order_id,
    customer_id,
    order_date,
    amount as revenue,
    product_name,
    category as product_category,
    supplier_name,
    country as supplier_country,
    region as supplier_region,
    sustainability_score,
    sustainability_tier,
    order_value_tier,
    
    -- Business metrics
    EXTRACT(YEAR FROM order_date) as order_year,
    EXTRACT(MONTH FROM order_date) as order_month,
    EXTRACT(QUARTER FROM order_date) as order_quarter

FROM "postgres"."analytics_intermediate"."int_orders_enriched"
    )
[0m19:24:10.083610 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:24:10.230326 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:10.235181 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m19:24:10.235773 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders__dbt_tmp" rename to "postgres"."analytics_marts"."fct_orders"
[0m19:24:10.261026 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:10.263857 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m19:24:10.265333 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m19:24:10.265578 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

    drop table if exists "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m19:24:10.279147 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:10.280531 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.fct_orders (execute): 19:24:10.078711 => 19:24:10.280439
[0m19:24:10.280855 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: ROLLBACK
[0m19:24:10.281146 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: Close
[0m19:24:10.281706 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6288c74e-aa6c-4cc1-b89a-e07252150d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950adc10>]}
[0m19:24:10.282086 [info ] [Thread-3 (]: 5 of 5 OK created sql table model analytics_marts.fct_orders ................... [[32mSUCCESS[0m in 0.22s]
[0m19:24:10.282474 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.fct_orders
[0m19:24:10.283628 [debug] [MainThread]: On master: COMMIT
[0m19:24:10.284008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:10.284225 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m19:24:10.284389 [debug] [MainThread]: Connection 'model.greencard_analytics.fct_orders' was properly closed.
[0m19:24:10.284544 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_products' was properly closed.
[0m19:24:10.284693 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m19:24:10.284875 [info ] [MainThread]: 
[0m19:24:10.285156 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m19:24:10.285737 [debug] [MainThread]: Command end result
[0m19:24:10.292223 [info ] [MainThread]: 
[0m19:24:10.292470 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:10.292694 [info ] [MainThread]: 
[0m19:24:10.292926 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:24:10.293501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa98bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9549bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9549bb90>]}
[0m19:24:10.293717 [debug] [MainThread]: Flushing usage events
[0m19:24:20.304083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3a3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3a1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3a1150>]}


============================== 19:24:20.305722 | 5ff8b73b-2b04-4ffa-830e-d75f1ce5b495 ==============================
[0m19:24:20.305722 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:24:20.306148 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt ls --resource-type model', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'target_path': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'static_parser': 'True', 'printer_width': '80'}
[0m19:24:20.426810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ff8b73b-2b04-4ffa-830e-d75f1ce5b495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf0ddd0>]}
[0m19:24:20.487434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ff8b73b-2b04-4ffa-830e-d75f1ce5b495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae074a90>]}
[0m19:24:20.487792 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:24:20.491666 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:24:20.508268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:20.508532 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:20.511304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ff8b73b-2b04-4ffa-830e-d75f1ce5b495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaddf1410>]}
[0m19:24:20.516979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ff8b73b-2b04-4ffa-830e-d75f1ce5b495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade92b90>]}
[0m19:24:20.517213 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m19:24:20.517433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ff8b73b-2b04-4ffa-830e-d75f1ce5b495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb20a7fd0>]}
[0m19:24:20.518256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3ac710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3b7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39e9350>]}
[0m19:24:20.518460 [debug] [MainThread]: Flushing usage events
[0m19:24:55.512007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb150e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb150c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb150c350>]}


============================== 19:24:55.513994 | 3c18805c-65a5-450d-b861-65525c8a5812 ==============================
[0m19:24:55.513994 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:24:55.514419 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --select int_orders_enriched', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_cache_events': 'False', 'log_path': '/usr/app/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'no_print': 'None'}
[0m19:24:55.634684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c18805c-65a5-450d-b861-65525c8a5812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb151e610>]}
[0m19:24:55.696461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c18805c-65a5-450d-b861-65525c8a5812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1116bd0>]}
[0m19:24:55.696896 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:24:55.701033 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:24:55.718848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:55.719074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:55.721814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c18805c-65a5-450d-b861-65525c8a5812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1014410>]}
[0m19:24:55.727785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c18805c-65a5-450d-b861-65525c8a5812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f96690>]}
[0m19:24:55.728035 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m19:24:55.728265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c18805c-65a5-450d-b861-65525c8a5812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ed9410>]}
[0m19:24:55.729049 [info ] [MainThread]: 
[0m19:24:55.729523 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:24:55.730141 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:24:55.737768 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:24:55.738036 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:24:55.738238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:55.771696 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:55.772656 [debug] [ThreadPool]: On list_postgres: Close
[0m19:24:55.773880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m19:24:55.774343 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_intermediate'
[0m19:24:55.778508 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m19:24:55.778901 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_staging'
[0m19:24:55.781282 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m19:24:55.781546 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m19:24:55.783513 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m19:24:55.783800 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m19:24:55.784064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:55.784283 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m19:24:55.784566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:55.785388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:55.890690 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:55.896090 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m19:24:55.897755 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m19:24:55.898458 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:55.903247 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m19:24:55.904229 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:55.904880 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m19:24:55.906650 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m19:24:55.907904 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m19:24:55.909038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c18805c-65a5-450d-b861-65525c8a5812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb151edd0>]}
[0m19:24:55.909942 [debug] [MainThread]: On master: COMMIT
[0m19:24:55.910856 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:24:55.911377 [info ] [MainThread]: 
[0m19:24:55.913872 [debug] [Thread-1 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m19:24:55.914274 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m19:24:55.914930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.int_orders_enriched)
[0m19:24:55.915232 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m19:24:55.917545 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m19:24:55.919302 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 19:24:55.915410 => 19:24:55.919180
[0m19:24:55.919563 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m19:24:55.942130 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m19:24:55.945132 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:24:55.945554 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m19:24:55.945896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:56.074783 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:56.078599 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:24:56.079078 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched" rename to "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m19:24:56.094919 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:56.097458 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:24:56.097757 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_enriched"
[0m19:24:56.113110 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:56.117113 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m19:24:56.120716 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m19:24:56.127115 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m19:24:56.149097 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:24:56.159283 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 19:24:55.919805 => 19:24:56.159186
[0m19:24:56.159601 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m19:24:56.159871 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m19:24:56.160413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c18805c-65a5-450d-b861-65525c8a5812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0bc2d10>]}
[0m19:24:56.160853 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_intermediate.int_orders_enriched ... [[32mSUCCESS[0m in 0.25s]
[0m19:24:56.161207 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m19:24:56.162227 [debug] [MainThread]: On master: COMMIT
[0m19:24:56.162600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:56.162822 [debug] [MainThread]: Connection 'list_postgres_analytics_marts' was properly closed.
[0m19:24:56.163035 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m19:24:56.163217 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m19:24:56.163421 [info ] [MainThread]: 
[0m19:24:56.163656 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m19:24:56.164115 [debug] [MainThread]: Command end result
[0m19:24:56.205860 [info ] [MainThread]: 
[0m19:24:56.206303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:56.206577 [info ] [MainThread]: 
[0m19:24:56.206909 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:24:56.207523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a991d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb149bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb149bb50>]}
[0m19:24:56.207789 [debug] [MainThread]: Flushing usage events
[0m19:25:36.566078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96166d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9bc0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa960a410>]}


============================== 19:25:36.568530 | 12352692-10e7-4d2b-a63c-0c44a559953e ==============================
[0m19:25:36.568530 [info ] [MainThread]: Running with dbt=1.7.4
[0m19:25:36.568949 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select fct_orders', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_format': 'default', 'introspect': 'True', 'printer_width': '80', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'log_cache_events': 'False'}
[0m19:25:36.688005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12352692-10e7-4d2b-a63c-0c44a559953e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa959fd50>]}
[0m19:25:36.910299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12352692-10e7-4d2b-a63c-0c44a559953e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9623090>]}
[0m19:25:36.911128 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m19:25:36.917424 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m19:25:36.937563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:25:36.937846 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:25:36.940855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12352692-10e7-4d2b-a63c-0c44a559953e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9622d50>]}
[0m19:25:36.947722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12352692-10e7-4d2b-a63c-0c44a559953e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa909a510>]}
[0m19:25:36.947992 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m19:25:36.948242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12352692-10e7-4d2b-a63c-0c44a559953e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad2c40d0>]}
[0m19:25:36.949217 [info ] [MainThread]: 
[0m19:25:36.949869 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m19:25:36.950622 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m19:25:36.959333 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m19:25:36.959650 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m19:25:36.959889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:37.030099 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:25:37.031470 [debug] [ThreadPool]: On list_postgres: Close
[0m19:25:37.032961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m19:25:37.033513 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_marts'
[0m19:25:37.038227 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m19:25:37.038614 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_intermediate'
[0m19:25:37.041197 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m19:25:37.041532 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m19:25:37.043692 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m19:25:37.043977 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m19:25:37.044255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:25:37.044512 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m19:25:37.044820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:37.045721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:37.155215 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:25:37.159454 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m19:25:37.161524 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:25:37.161897 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m19:25:37.162918 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:25:37.163964 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m19:25:37.165675 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m19:25:37.165981 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m19:25:37.166248 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m19:25:37.167984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12352692-10e7-4d2b-a63c-0c44a559953e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f6e750>]}
[0m19:25:37.168362 [debug] [MainThread]: On master: COMMIT
[0m19:25:37.168769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:25:37.169109 [info ] [MainThread]: 
[0m19:25:37.172072 [debug] [Thread-1 (]: Began running node model.greencard_analytics.fct_orders
[0m19:25:37.172583 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_marts.fct_orders ........................ [RUN]
[0m19:25:37.173075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.fct_orders)
[0m19:25:37.173346 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.fct_orders
[0m19:25:37.175290 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.fct_orders"
[0m19:25:37.176415 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.fct_orders (compile): 19:25:37.173581 => 19:25:37.176316
[0m19:25:37.176667 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.fct_orders
[0m19:25:37.196430 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.fct_orders"
[0m19:25:37.198193 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m19:25:37.198458 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

  
    

    create table "postgres"."analytics_marts"."fct_orders__dbt_tmp"
      
      
    as (
      -- Final fact table for analysis


SELECT
    order_id,
    customer_id,
    order_date,
    amount as revenue,
    product_name,
    category as product_category,
    supplier_name,
    country as supplier_country,
    region as supplier_region,
    sustainability_score,
    sustainability_tier,
    order_value_tier,
    
    -- Business metrics
    EXTRACT(YEAR FROM order_date) as order_year,
    EXTRACT(MONTH FROM order_date) as order_month,
    EXTRACT(QUARTER FROM order_date) as order_quarter

FROM "postgres"."analytics_intermediate"."int_orders_enriched"
    )
[0m19:25:37.198749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:25:37.286671 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:25:37.290392 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m19:25:37.290681 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders" rename to "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m19:25:37.303207 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:25:37.305301 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m19:25:37.305542 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders__dbt_tmp" rename to "postgres"."analytics_marts"."fct_orders"
[0m19:25:37.317859 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:25:37.322061 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m19:25:37.323279 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m19:25:37.323588 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

    drop table if exists "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m19:25:37.336425 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:25:37.346392 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.fct_orders (execute): 19:25:37.176836 => 19:25:37.346272
[0m19:25:37.346701 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: ROLLBACK
[0m19:25:37.346916 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: Close
[0m19:25:37.347471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12352692-10e7-4d2b-a63c-0c44a559953e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa900a710>]}
[0m19:25:37.347823 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_marts.fct_orders ................... [[32mSUCCESS[0m in 0.17s]
[0m19:25:37.348258 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.fct_orders
[0m19:25:37.349343 [debug] [MainThread]: On master: COMMIT
[0m19:25:37.349703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:37.349885 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m19:25:37.350057 [debug] [MainThread]: Connection 'model.greencard_analytics.fct_orders' was properly closed.
[0m19:25:37.350223 [debug] [MainThread]: Connection 'list_postgres_analytics_intermediate' was properly closed.
[0m19:25:37.350500 [info ] [MainThread]: 
[0m19:25:37.350827 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m19:25:37.351239 [debug] [MainThread]: Command end result
[0m19:25:37.388363 [info ] [MainThread]: 
[0m19:25:37.388703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:25:37.389020 [info ] [MainThread]: 
[0m19:25:37.389314 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:25:37.389953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaebd5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa959fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa959fb90>]}
[0m19:25:37.390222 [debug] [MainThread]: Flushing usage events
[0m08:49:52.957611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ca3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c9bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93ca0b10>]}


============================== 08:49:52.961117 | 0f1eaef3-687a-4078-8f64-dbf5f4f03903 ==============================
[0m08:49:52.961117 [info ] [MainThread]: Running with dbt=1.7.4
[0m08:49:52.961558 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'introspect': 'True', 'target_path': 'None', 'log_path': '/usr/app/logs', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'profiles_dir': '/root/.dbt', 'use_experimental_parser': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'quiet': 'False'}
[0m08:49:53.105935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f1eaef3-687a-4078-8f64-dbf5f4f03903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d1e5d0>]}
[0m08:49:53.171556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f1eaef3-687a-4078-8f64-dbf5f4f03903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9395df50>]}
[0m08:49:53.172107 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m08:49:53.177494 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m08:49:53.183716 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:49:53.184057 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:49:53.184354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f1eaef3-687a-4078-8f64-dbf5f4f03903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93675a50>]}
[0m08:49:53.678367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f1eaef3-687a-4078-8f64-dbf5f4f03903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931f9550>]}
[0m08:49:53.684361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f1eaef3-687a-4078-8f64-dbf5f4f03903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929163d0>]}
[0m08:49:53.684631 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m08:49:53.684853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f1eaef3-687a-4078-8f64-dbf5f4f03903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff935851d0>]}
[0m08:49:53.685751 [info ] [MainThread]: 
[0m08:49:53.686251 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m08:49:53.687216 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m08:49:53.687689 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m08:49:53.688145 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m08:49:53.695889 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m08:49:53.697254 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m08:49:53.698391 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m08:49:53.698645 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m08:49:53.698886 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m08:49:53.699122 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m08:49:53.699345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:53.699559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:53.699770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:49:53.724424 [debug] [ThreadPool]: Trino adapter: Trino query id: 20251011_084953_00004_3rf4e
[0m08:49:53.725045 [debug] [ThreadPool]: Trino adapter: Trino query id: 20251011_084953_00005_3rf4e
[0m08:49:53.725229 [debug] [ThreadPool]: Trino adapter: Trino query id: 20251011_084953_00006_3rf4e
[0m08:49:53.726511 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 4:10: Catalog 'iceberg' does not exist", query_id=20251011_084953_00004_3rf4e)
[0m08:49:53.726816 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 4:10: Catalog 'iceberg' does not exist", query_id=20251011_084953_00005_3rf4e)
[0m08:49:53.727092 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 4:10: Catalog 'iceberg' does not exist", query_id=20251011_084953_00006_3rf4e)
[0m08:49:53.727415 [debug] [ThreadPool]: On list_iceberg: Close
[0m08:49:53.727707 [debug] [ThreadPool]: On list_iceberg: Close
[0m08:49:53.728016 [debug] [ThreadPool]: On list_iceberg: Close
[0m08:49:53.729578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:49:53.729791 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m08:49:53.730016 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m08:49:53.730195 [debug] [MainThread]: Connection 'list_iceberg' was properly closed.
[0m08:49:53.730393 [info ] [MainThread]: 
[0m08:49:53.730628 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m08:49:53.730990 [error] [MainThread]: Encountered an error:
Database Error
  TrinoUserError(type=USER_ERROR, name=CATALOG_NOT_FOUND, message="line 4:10: Catalog 'iceberg' does not exist", query_id=20251011_084953_00004_3rf4e)
[0m08:49:53.732185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93cac310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92da2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9316c710>]}
[0m08:49:53.732438 [debug] [MainThread]: Flushing usage events
[0m08:50:52.760157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffa7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffa7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffa5c10>]}


============================== 08:50:52.762097 | b6e9a304-d3b7-4429-ac03-7fc7f583227e ==============================
[0m08:50:52.762097 [info ] [MainThread]: Running with dbt=1.7.4
[0m08:50:52.762564 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_path': '/usr/app/logs', 'quiet': 'False', 'target_path': 'None'}
[0m08:50:52.921238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6e9a304-d3b7-4429-ac03-7fc7f583227e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9feedc50>]}
[0m08:50:52.995778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6e9a304-d3b7-4429-ac03-7fc7f583227e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc53010>]}
[0m08:50:52.996328 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m08:50:53.001104 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m08:50:53.007183 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:50:53.007684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6e9a304-d3b7-4429-ac03-7fc7f583227e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f9b2110>]}
[0m08:50:53.795331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6e9a304-d3b7-4429-ac03-7fc7f583227e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f777bd0>]}
[0m08:50:53.800972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6e9a304-d3b7-4429-ac03-7fc7f583227e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef0d310>]}
[0m08:50:53.801258 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m08:50:53.801570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6e9a304-d3b7-4429-ac03-7fc7f583227e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f752a10>]}
[0m08:50:53.802662 [info ] [MainThread]: 
[0m08:50:53.803275 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m08:50:53.804074 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:50:53.804511 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:50:53.813993 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:50:53.814375 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:50:53.815838 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:50:53.816090 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:50:53.817328 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:50:53.817627 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:50:53.818240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:53.818457 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:50:53.818699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:53.820224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:53.938594 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:50:53.947446 [debug] [ThreadPool]: On list_postgres: Close
[0m08:50:53.949034 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:50:53.950299 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:50:53.953565 [debug] [ThreadPool]: On list_postgres: Close
[0m08:50:53.954981 [debug] [ThreadPool]: On list_postgres: Close
[0m08:50:53.958445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m08:50:53.959428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m08:50:53.966496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m08:50:53.967180 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m08:50:53.969498 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m08:50:53.976356 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m08:50:53.976692 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m08:50:53.977022 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m08:50:53.977307 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m08:50:53.981591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:53.981898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:53.982194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:54.621509 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m08:50:54.623649 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m08:50:54.627050 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m08:50:54.627820 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m08:50:54.631089 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:50:54.649505 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m08:50:54.660904 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:50:54.664063 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m08:50:54.678680 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m08:50:54.681937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6e9a304-d3b7-4429-ac03-7fc7f583227e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3fb210>]}
[0m08:50:54.683034 [debug] [MainThread]: On master: COMMIT
[0m08:50:54.686482 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:50:54.689272 [info ] [MainThread]: 
[0m08:50:54.716404 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m08:50:54.724155 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m08:50:54.724878 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m08:50:54.725876 [info ] [Thread-1 (]: 1 of 5 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m08:50:54.727594 [info ] [Thread-2 (]: 2 of 5 START sql view model analytics_staging.stg_products ..................... [RUN]
[0m08:50:54.728552 [info ] [Thread-3 (]: 3 of 5 START sql view model analytics_staging.stg_suppliers .................... [RUN]
[0m08:50:54.729232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_orders)
[0m08:50:54.729651 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_products)
[0m08:50:54.730037 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_suppliers)
[0m08:50:54.730288 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m08:50:54.730516 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m08:50:54.730748 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m08:50:54.731998 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m08:50:54.732877 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m08:50:54.734130 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m08:50:54.737113 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 08:50:54.730921 => 08:50:54.736795
[0m08:50:54.737361 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 08:50:54.732187 => 08:50:54.737240
[0m08:50:54.737543 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 08:50:54.733061 => 08:50:54.737462
[0m08:50:54.737690 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m08:50:54.737926 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m08:50:54.738151 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m08:50:54.747285 [debug] [Thread-1 (]: Dropping relation "postgres"."analytics_staging"."stg_orders" because it is of type table
[0m08:50:54.749729 [debug] [Thread-2 (]: Dropping relation "postgres"."analytics_staging"."stg_products" because it is of type table
[0m08:50:54.751515 [debug] [Thread-3 (]: Dropping relation "postgres"."analytics_staging"."stg_suppliers" because it is of type table
[0m08:50:54.754740 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders"
[0m08:50:54.755947 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products"
[0m08:50:54.757136 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers"
[0m08:50:54.759275 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:50:54.759782 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:50:54.760221 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:50:54.760471 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders"
[0m08:50:54.760706 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products"
[0m08:50:54.760950 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers"
[0m08:50:54.761170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:50:54.761381 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:50:54.761583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:50:54.800968 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:50:54.802560 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:50:54.808618 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m08:50:54.809178 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:50:54.810097 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m08:50:54.811471 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m08:50:54.812706 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:50:54.813235 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:50:54.813522 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  create or replace view
    "postgres"."analytics_staging"."stg_suppliers"
  security definer
  as
    SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
  
[0m08:50:54.814324 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:50:54.814802 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  create or replace view
    "postgres"."analytics_staging"."stg_orders"
  security definer
  as
    SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
  
[0m08:50:54.834576 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  create or replace view
    "postgres"."analytics_staging"."stg_products"
  security definer
  as
    SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
  
[0m08:50:54.918967 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251011_085054_00017_3rf4e
[0m08:50:54.919694 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251011_085054_00017_3rf4e)
[0m08:50:54.920266 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 08:50:54.738327 => 08:50:54.920125
[0m08:50:54.920658 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m08:50:54.921075 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m08:50:54.924535 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251011_085054_00017_3rf4e)
  compiled Code at target/run/greencard_analytics/models/staging/stg_orders.sql
[0m08:50:54.927466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6e9a304-d3b7-4429-ac03-7fc7f583227e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef44a10>]}
[0m08:50:54.928651 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model analytics_staging.stg_orders .............. [[31mERROR[0m in 0.20s]
[0m08:50:54.929292 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m08:50:55.196138 [debug] [Thread-3 (]: Trino adapter: Trino query id: 20251011_085054_00016_3rf4e
[0m08:50:55.196513 [debug] [Thread-2 (]: Trino adapter: Trino query id: 20251011_085054_00018_3rf4e
[0m08:50:55.196815 [debug] [Thread-3 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251011_085054_00016_3rf4e)
[0m08:50:55.197343 [debug] [Thread-2 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251011_085054_00018_3rf4e)
[0m08:50:55.197727 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 08:50:54.749973 => 08:50:55.197610
[0m08:50:55.198097 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 08:50:54.747548 => 08:50:55.197948
[0m08:50:55.198382 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m08:50:55.198624 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m08:50:55.198910 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m08:50:55.199128 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m08:50:55.201017 [debug] [Thread-3 (]: Database Error in model stg_suppliers (models/staging/stg_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251011_085054_00016_3rf4e)
  compiled Code at target/run/greencard_analytics/models/staging/stg_suppliers.sql
[0m08:50:55.202564 [debug] [Thread-2 (]: Database Error in model stg_products (models/staging/stg_products.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251011_085054_00018_3rf4e)
  compiled Code at target/run/greencard_analytics/models/staging/stg_products.sql
[0m08:50:55.203014 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6e9a304-d3b7-4429-ac03-7fc7f583227e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3bd390>]}
[0m08:50:55.203369 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6e9a304-d3b7-4429-ac03-7fc7f583227e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef8b4d0>]}
[0m08:50:55.203880 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model analytics_staging.stg_suppliers ........... [[31mERROR[0m in 0.47s]
[0m08:50:55.204288 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model analytics_staging.stg_products ............ [[31mERROR[0m in 0.47s]
[0m08:50:55.204683 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m08:50:55.205042 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m08:50:55.205922 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m08:50:55.206257 [info ] [Thread-4 (]: 4 of 5 SKIP relation analytics_intermediate.int_orders_enriched ................ [[33mSKIP[0m]
[0m08:50:55.206547 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m08:50:55.207031 [debug] [Thread-3 (]: Began running node model.greencard_analytics.fct_orders
[0m08:50:55.207264 [info ] [Thread-3 (]: 5 of 5 SKIP relation analytics_marts.fct_orders ................................ [[33mSKIP[0m]
[0m08:50:55.207536 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.fct_orders
[0m08:50:55.208760 [debug] [MainThread]: On master: COMMIT
[0m08:50:55.209119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:55.209424 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m08:50:55.209685 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_products' was properly closed.
[0m08:50:55.209900 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m08:50:55.210153 [info ] [MainThread]: 
[0m08:50:55.210395 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m08:50:55.210914 [debug] [MainThread]: Command end result
[0m08:50:55.227839 [info ] [MainThread]: 
[0m08:50:55.236415 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m08:50:55.237597 [info ] [MainThread]: 
[0m08:50:55.239731 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251011_085054_00017_3rf4e)
  compiled Code at target/run/greencard_analytics/models/staging/stg_orders.sql
[0m08:50:55.240151 [info ] [MainThread]: 
[0m08:50:55.240793 [error] [MainThread]:   Database Error in model stg_suppliers (models/staging/stg_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251011_085054_00016_3rf4e)
  compiled Code at target/run/greencard_analytics/models/staging/stg_suppliers.sql
[0m08:50:55.241213 [info ] [MainThread]: 
[0m08:50:55.241467 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="This connector does not support creating views", query_id=20251011_085054_00018_3rf4e)
  compiled Code at target/run/greencard_analytics/models/staging/stg_products.sql
[0m08:50:55.241730 [info ] [MainThread]: 
[0m08:50:55.242035 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m08:50:55.243311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ffb0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa043ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5628bd0>]}
[0m08:50:55.243637 [debug] [MainThread]: Flushing usage events
[0m08:51:47.252632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ea7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ea77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ea6050>]}


============================== 08:51:47.254873 | d220c2f0-2765-4ad6-8cdb-398c70e81145 ==============================
[0m08:51:47.254873 [info ] [MainThread]: Running with dbt=1.7.4
[0m08:51:47.255278 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/root/.dbt', 'write_json': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'log_format': 'default'}
[0m08:51:47.373743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ee22d0>]}
[0m08:51:47.434811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b13010>]}
[0m08:51:47.435170 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m08:51:47.439738 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m08:51:47.445387 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:51:47.445677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b05490>]}
[0m08:51:47.936765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877c22d0>]}
[0m08:51:47.942322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86b14710>]}
[0m08:51:47.942593 [info ] [MainThread]: Found 5 models, 3 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m08:51:47.942834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b20290>]}
[0m08:51:47.943773 [info ] [MainThread]: 
[0m08:51:47.944262 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m08:51:47.944944 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:51:47.945396 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:51:47.951578 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:51:47.953503 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:51:47.954903 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:51:47.956099 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:51:47.956316 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:51:47.956547 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:51:47.956815 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:51:47.957010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:47.957220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:47.957442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:48.018871 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.020152 [debug] [ThreadPool]: On list_postgres: Close
[0m08:51:48.023030 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.024344 [debug] [ThreadPool]: On list_postgres: Close
[0m08:51:48.026755 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.027576 [debug] [ThreadPool]: On list_postgres: Close
[0m08:51:48.028932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m08:51:48.029400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m08:51:48.029875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m08:51:48.033958 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m08:51:48.036082 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m08:51:48.037933 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m08:51:48.038196 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m08:51:48.038487 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m08:51:48.038764 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m08:51:48.038973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:48.039274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:48.039495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:48.213880 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.214345 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.219343 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m08:51:48.220387 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m08:51:48.220070 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.216460 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:51:48.221768 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m08:51:48.222011 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:51:48.222387 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m08:51:48.223908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87935b90>]}
[0m08:51:48.224326 [debug] [MainThread]: On master: COMMIT
[0m08:51:48.224734 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:51:48.225217 [info ] [MainThread]: 
[0m08:51:48.227364 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m08:51:48.227562 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m08:51:48.227748 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m08:51:48.228043 [info ] [Thread-1 (]: 1 of 5 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m08:51:48.228422 [info ] [Thread-2 (]: 2 of 5 START sql table model analytics_staging.stg_products .................... [RUN]
[0m08:51:48.229294 [info ] [Thread-3 (]: 3 of 5 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m08:51:48.230102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_orders)
[0m08:51:48.230541 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_products)
[0m08:51:48.230932 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_suppliers)
[0m08:51:48.231196 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m08:51:48.231418 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m08:51:48.231638 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m08:51:48.232818 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m08:51:48.233686 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m08:51:48.234514 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m08:51:48.235644 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 08:51:48.231807 => 08:51:48.235542
[0m08:51:48.235914 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m08:51:48.236100 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 08:51:48.233010 => 08:51:48.236023
[0m08:51:48.236278 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 08:51:48.233875 => 08:51:48.236191
[0m08:51:48.254342 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m08:51:48.257957 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m08:51:48.258323 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m08:51:48.260456 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m08:51:48.263067 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m08:51:48.264721 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:51:48.265309 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "postgres"."analytics_staging"."stg_orders__dbt_tmp"
      
      
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
    )
[0m08:51:48.266622 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:51:48.266819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:48.267341 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:51:48.267611 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "postgres"."analytics_staging"."stg_products__dbt_tmp"
      
      
    as (
      SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m08:51:48.268618 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      
    as (
      SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m08:51:48.268900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:51:48.269232 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:51:48.584323 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.591972 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:51:48.592597 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.593158 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "postgres"."analytics_staging"."stg_suppliers"
[0m08:51:48.595156 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:51:48.599278 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products__dbt_tmp" rename to "postgres"."analytics_staging"."stg_products"
[0m08:51:48.624868 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.631807 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m08:51:48.632468 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.632808 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.634024 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:51:48.635737 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m08:51:48.637329 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:51:48.637818 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m08:51:48.638474 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:51:48.638753 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders__dbt_tmp" rename to "postgres"."analytics_staging"."stg_orders"
[0m08:51:48.639696 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m08:51:48.658107 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.658691 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.659139 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.666375 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 08:51:48.258525 => 08:51:48.666282
[0m08:51:48.668047 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m08:51:48.669037 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 08:51:48.261198 => 08:51:48.668943
[0m08:51:48.669318 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m08:51:48.669779 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:51:48.670048 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m08:51:48.670294 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m08:51:48.670555 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m08:51:48.670812 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m08:51:48.671349 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ff1210>]}
[0m08:51:48.672306 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86bb7f90>]}
[0m08:51:48.672632 [info ] [Thread-2 (]: 2 of 5 OK created sql table model analytics_staging.stg_products ............... [[32mSUCCESS[0m in 0.44s]
[0m08:51:48.673081 [info ] [Thread-3 (]: 3 of 5 OK created sql table model analytics_staging.stg_suppliers .............. [[32mSUCCESS[0m in 0.44s]
[0m08:51:48.674093 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m08:51:48.674407 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m08:51:48.683738 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.684944 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 08:51:48.236361 => 08:51:48.684851
[0m08:51:48.685264 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m08:51:48.685515 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m08:51:48.686064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86beed50>]}
[0m08:51:48.686648 [info ] [Thread-1 (]: 1 of 5 OK created sql table model analytics_staging.stg_orders ................. [[32mSUCCESS[0m in 0.46s]
[0m08:51:48.687178 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m08:51:48.687696 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m08:51:48.688101 [info ] [Thread-4 (]: 4 of 5 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m08:51:48.688658 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.int_orders_enriched'
[0m08:51:48.688916 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m08:51:48.692579 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m08:51:48.693627 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 08:51:48.689117 => 08:51:48.693518
[0m08:51:48.693865 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m08:51:48.695777 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m08:51:48.698159 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:51:48.698402 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m08:51:48.698634 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:51:48.920311 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.922653 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:51:48.923664 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched" rename to "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:51:48.942023 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.944298 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:51:48.944645 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_enriched"
[0m08:51:48.967339 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.971362 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:51:48.971956 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:51:48.972288 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:51:48.987688 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:48.990444 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 08:51:48.694044 => 08:51:48.990347
[0m08:51:48.990739 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m08:51:48.990957 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m08:51:48.991492 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff873113d0>]}
[0m08:51:48.991836 [info ] [Thread-4 (]: 4 of 5 OK created sql table model analytics_intermediate.int_orders_enriched ... [[32mSUCCESS[0m in 0.30s]
[0m08:51:48.992437 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m08:51:48.992910 [debug] [Thread-3 (]: Began running node model.greencard_analytics.fct_orders
[0m08:51:48.993338 [info ] [Thread-3 (]: 5 of 5 START sql table model analytics_marts.fct_orders ........................ [RUN]
[0m08:51:48.993828 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_suppliers, now model.greencard_analytics.fct_orders)
[0m08:51:48.994050 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.fct_orders
[0m08:51:48.995775 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.fct_orders"
[0m08:51:48.996808 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.fct_orders (compile): 08:51:48.994208 => 08:51:48.996707
[0m08:51:48.997033 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.fct_orders
[0m08:51:48.998936 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.fct_orders"
[0m08:51:49.000851 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m08:51:49.001088 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

  
    

    create table "postgres"."analytics_marts"."fct_orders__dbt_tmp"
      
      
    as (
      -- Final fact table for analysis


SELECT
    order_id,
    customer_id,
    order_date,
    amount as revenue,
    product_name,
    category as product_category,
    supplier_name,
    country as supplier_country,
    region as supplier_region,
    sustainability_score,
    sustainability_tier,
    order_value_tier,
    
    -- Business metrics
    EXTRACT(YEAR FROM order_date) as order_year,
    EXTRACT(MONTH FROM order_date) as order_month,
    EXTRACT(QUARTER FROM order_date) as order_quarter

FROM "postgres"."analytics_intermediate"."int_orders_enriched"
    )
[0m08:51:49.001360 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:51:49.158136 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:49.160165 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m08:51:49.160465 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders" rename to "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m08:51:49.176939 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:49.178878 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m08:51:49.179161 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders__dbt_tmp" rename to "postgres"."analytics_marts"."fct_orders"
[0m08:51:49.194372 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:49.196423 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m08:51:49.197083 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m08:51:49.197465 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

    drop table if exists "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m08:51:49.212840 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:51:49.214269 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.fct_orders (execute): 08:51:48.997193 => 08:51:49.214176
[0m08:51:49.214573 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: ROLLBACK
[0m08:51:49.214813 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: Close
[0m08:51:49.215369 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd220c2f0-2765-4ad6-8cdb-398c70e81145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86bfc190>]}
[0m08:51:49.219325 [info ] [Thread-3 (]: 5 of 5 OK created sql table model analytics_marts.fct_orders ................... [[32mSUCCESS[0m in 0.22s]
[0m08:51:49.219888 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.fct_orders
[0m08:51:49.221501 [debug] [MainThread]: On master: COMMIT
[0m08:51:49.221959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:51:49.222176 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_products' was properly closed.
[0m08:51:49.222382 [debug] [MainThread]: Connection 'model.greencard_analytics.fct_orders' was properly closed.
[0m08:51:49.222567 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m08:51:49.222741 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m08:51:49.222970 [info ] [MainThread]: 
[0m08:51:49.223494 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m08:51:49.224152 [debug] [MainThread]: Command end result
[0m08:51:49.231244 [info ] [MainThread]: 
[0m08:51:49.231702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:51:49.232245 [info ] [MainThread]: 
[0m08:51:49.232570 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:51:49.233262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87eac210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f1eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e9b990>]}
[0m08:51:49.233497 [debug] [MainThread]: Flushing usage events
[0m10:03:44.444226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94d8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa983e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9467e10>]}


============================== 10:03:44.452909 | 4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c ==============================
[0m10:03:44.452909 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:03:44.453313 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/root/.dbt', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'version_check': 'True', 'partial_parse': 'True', 'printer_width': '80', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'target_path': 'None'}
[0m10:03:44.589020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9481e50>]}
[0m10:03:44.649759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa993f4d0>]}
[0m10:03:44.650136 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m10:03:44.654964 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:03:44.684350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m10:03:44.684651 [debug] [MainThread]: Partial parsing: added file: greencard_analytics://models/staging/stg_user_events.sql
[0m10:03:44.684843 [debug] [MainThread]: Partial parsing: added file: greencard_analytics://models/intermediate/int_orders_with_behavior.sql
[0m10:03:44.685072 [debug] [MainThread]: Partial parsing: updated file: greencard_analytics://models/staging/sources.yml
[0m10:03:44.855697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8c16a10>]}
[0m10:03:44.862178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e04510>]}
[0m10:03:44.862459 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m10:03:44.862704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93b1650>]}
[0m10:03:44.864098 [info ] [MainThread]: 
[0m10:03:44.864908 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:03:44.866207 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m10:03:44.866872 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m10:03:44.876638 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m10:03:44.877072 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m10:03:44.878398 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m10:03:44.878597 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m10:03:44.879723 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m10:03:44.879932 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m10:03:44.880149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:44.880358 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m10:03:44.880538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:44.880945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:44.999969 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.002376 [debug] [ThreadPool]: On list_postgres: Close
[0m10:03:45.002762 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.003162 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.004185 [debug] [ThreadPool]: On list_postgres: Close
[0m10:03:45.004798 [debug] [ThreadPool]: On list_postgres: Close
[0m10:03:45.006510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m10:03:45.006964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m10:03:45.007340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m10:03:45.011515 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m10:03:45.014293 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m10:03:45.016261 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m10:03:45.016523 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m10:03:45.016783 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m10:03:45.017043 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m10:03:45.017296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:45.017555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:45.017739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:45.472235 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.475517 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m10:03:45.476105 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.476553 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m10:03:45.477222 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.477823 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m10:03:45.480498 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m10:03:45.480823 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m10:03:45.481198 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m10:03:45.483132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9025850>]}
[0m10:03:45.483665 [debug] [MainThread]: On master: COMMIT
[0m10:03:45.484311 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:03:45.484831 [info ] [MainThread]: 
[0m10:03:45.492445 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m10:03:45.492661 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m10:03:45.492870 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m10:03:45.493033 [debug] [Thread-4 (]: Began running node model.greencard_analytics.stg_user_events
[0m10:03:45.493254 [info ] [Thread-1 (]: 1 of 7 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m10:03:45.493631 [info ] [Thread-2 (]: 2 of 7 START sql table model analytics_staging.stg_products .................... [RUN]
[0m10:03:45.493950 [info ] [Thread-3 (]: 3 of 7 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m10:03:45.494303 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_staging.stg_user_events ................. [RUN]
[0m10:03:45.494740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_orders)
[0m10:03:45.495123 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_products)
[0m10:03:45.495479 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_suppliers)
[0m10:03:45.495872 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.stg_user_events'
[0m10:03:45.496121 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m10:03:45.496346 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m10:03:45.496547 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m10:03:45.496741 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.stg_user_events
[0m10:03:45.497868 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m10:03:45.499272 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m10:03:45.500075 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m10:03:45.501162 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.stg_user_events"
[0m10:03:45.502635 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 10:03:45.496873 => 10:03:45.502525
[0m10:03:45.502948 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m10:03:45.503172 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 10:03:45.498327 => 10:03:45.503069
[0m10:03:45.515888 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (compile): 10:03:45.500407 => 10:03:45.515724
[0m10:03:45.516120 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 10:03:45.499456 => 10:03:45.516028
[0m10:03:45.523788 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m10:03:45.523996 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m10:03:45.524305 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.stg_user_events
[0m10:03:45.524564 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m10:03:45.526865 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m10:03:45.529543 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.stg_user_events"
[0m10:03:45.531363 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m10:03:45.532203 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m10:03:45.533373 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m10:03:45.533655 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "postgres"."analytics_staging"."stg_orders__dbt_tmp"
      
      
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
    )
[0m10:03:45.534281 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.stg_user_events"
[0m10:03:45.534462 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "postgres"."analytics_staging"."stg_products__dbt_tmp"
      
      
    as (
      SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m10:03:45.535010 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m10:03:45.535225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:45.535444 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_user_events"} */

  
    

    create table "postgres"."analytics_staging"."stg_user_events__dbt_tmp"
      
      
    as (
      SELECT
    event_id,
    user_id as customer_id,
    event_type,
    product_id,
    session_id
FROM lakehouse.raw_data.user_events
    )
[0m10:03:45.535654 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:03:45.535894 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      
    as (
      SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m10:03:45.536856 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:03:45.537786 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:03:45.724402 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.728563 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m10:03:45.729739 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders" rename to "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m10:03:45.749557 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.751873 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m10:03:45.752278 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders__dbt_tmp" rename to "postgres"."analytics_staging"."stg_orders"
[0m10:03:45.769323 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.773579 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m10:03:45.775103 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m10:03:45.775683 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m10:03:45.799602 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.808846 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 10:03:45.503380 => 10:03:45.808739
[0m10:03:45.809215 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m10:03:45.809508 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m10:03:45.810219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b5dcd0>]}
[0m10:03:45.810764 [info ] [Thread-1 (]: 1 of 7 OK created sql table model analytics_staging.stg_orders ................. [[32mSUCCESS[0m in 0.32s]
[0m10:03:45.811381 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m10:03:45.958092 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.960451 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m10:03:45.961758 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers" rename to "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m10:03:45.965509 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.967844 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m10:03:45.968849 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products" rename to "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m10:03:45.981486 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.984089 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m10:03:45.984433 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "postgres"."analytics_staging"."stg_suppliers"
[0m10:03:45.994230 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:45.996940 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m10:03:46.000189 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products__dbt_tmp" rename to "postgres"."analytics_staging"."stg_products"
[0m10:03:46.013907 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.018950 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m10:03:46.021670 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.022124 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m10:03:46.022329 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20251011_100345_00014_frub7
[0m10:03:46.023932 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m10:03:46.024216 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m10:03:46.024457 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 16:6: Schema 'raw_data' does not exist", query_id=20251011_100345_00014_frub7)
[0m10:03:46.026175 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (execute): 10:03:45.527125 => 10:03:46.026059
[0m10:03:46.026501 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: ROLLBACK
[0m10:03:46.025129 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m10:03:46.026752 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: Close
[0m10:03:46.027065 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m10:03:46.041932 [debug] [Thread-4 (]: Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 16:6: Schema 'raw_data' does not exist", query_id=20251011_100345_00014_frub7)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m10:03:46.042908 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8322390>]}
[0m10:03:46.045388 [error] [Thread-4 (]: 4 of 7 ERROR creating sql table model analytics_staging.stg_user_events ........ [[31mERROR[0m in 0.55s]
[0m10:03:46.044897 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.046446 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.stg_user_events
[0m10:03:46.047475 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.049450 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 10:03:45.529783 => 10:03:46.049349
[0m10:03:46.051363 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 10:03:45.524941 => 10:03:46.051275
[0m10:03:46.051621 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m10:03:46.051851 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m10:03:46.052075 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m10:03:46.052282 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m10:03:46.052856 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8778550>]}
[0m10:03:46.053270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b82010>]}
[0m10:03:46.053728 [info ] [Thread-3 (]: 3 of 7 OK created sql table model analytics_staging.stg_suppliers .............. [[32mSUCCESS[0m in 0.56s]
[0m10:03:46.054188 [info ] [Thread-2 (]: 2 of 7 OK created sql table model analytics_staging.stg_products ............... [[32mSUCCESS[0m in 0.56s]
[0m10:03:46.054668 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m10:03:46.054947 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m10:03:46.055664 [debug] [Thread-1 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m10:03:46.055822 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_with_behavior
[0m10:03:46.056184 [info ] [Thread-1 (]: 5 of 7 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m10:03:46.056594 [info ] [Thread-4 (]: 6 of 7 SKIP relation analytics_intermediate.int_orders_with_behavior ........... [[33mSKIP[0m]
[0m10:03:46.057109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_orders, now model.greencard_analytics.int_orders_enriched)
[0m10:03:46.057421 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_with_behavior
[0m10:03:46.057631 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m10:03:46.059712 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m10:03:46.060690 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 10:03:46.057931 => 10:03:46.060598
[0m10:03:46.060908 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m10:03:46.063270 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m10:03:46.065792 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m10:03:46.066059 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m10:03:46.066337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:46.314602 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.318624 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m10:03:46.319099 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched" rename to "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m10:03:46.338371 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.340650 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m10:03:46.341045 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_enriched"
[0m10:03:46.363869 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.366164 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m10:03:46.367006 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m10:03:46.367432 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m10:03:46.387866 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.389391 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 10:03:46.061082 => 10:03:46.389271
[0m10:03:46.389631 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m10:03:46.389807 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m10:03:46.390285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b83010>]}
[0m10:03:46.390636 [info ] [Thread-1 (]: 5 of 7 OK created sql table model analytics_intermediate.int_orders_enriched ... [[32mSUCCESS[0m in 0.33s]
[0m10:03:46.391146 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m10:03:46.391680 [debug] [Thread-2 (]: Began running node model.greencard_analytics.fct_orders
[0m10:03:46.391928 [info ] [Thread-2 (]: 7 of 7 START sql table model analytics_marts.fct_orders ........................ [RUN]
[0m10:03:46.392353 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_products, now model.greencard_analytics.fct_orders)
[0m10:03:46.392573 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.fct_orders
[0m10:03:46.394280 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.fct_orders"
[0m10:03:46.395408 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (compile): 10:03:46.392700 => 10:03:46.395053
[0m10:03:46.395909 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.fct_orders
[0m10:03:46.397804 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.fct_orders"
[0m10:03:46.399296 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:03:46.399535 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

  
    

    create table "postgres"."analytics_marts"."fct_orders__dbt_tmp"
      
      
    as (
      -- Final fact table for analysis


SELECT
    order_id,
    customer_id,
    order_date,
    amount as revenue,
    product_name,
    category as product_category,
    supplier_name,
    country as supplier_country,
    region as supplier_region,
    sustainability_score,
    sustainability_tier,
    order_value_tier,
    
    -- Business metrics
    EXTRACT(YEAR FROM order_date) as order_year,
    EXTRACT(MONTH FROM order_date) as order_month,
    EXTRACT(QUARTER FROM order_date) as order_quarter

FROM "postgres"."analytics_intermediate"."int_orders_enriched"
    )
[0m10:03:46.399727 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:03:46.518056 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.520033 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:03:46.520373 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders" rename to "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m10:03:46.534484 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.536480 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:03:46.536720 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders__dbt_tmp" rename to "postgres"."analytics_marts"."fct_orders"
[0m10:03:46.550218 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.553243 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m10:03:46.553753 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:03:46.554000 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

    drop table if exists "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m10:03:46.568195 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:03:46.569600 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (execute): 10:03:46.396056 => 10:03:46.569507
[0m10:03:46.569857 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: ROLLBACK
[0m10:03:46.570029 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: Close
[0m10:03:46.570460 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e534c2f-ef16-48eb-9c52-61ebb3a4fd1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83f3b50>]}
[0m10:03:46.570784 [info ] [Thread-2 (]: 7 of 7 OK created sql table model analytics_marts.fct_orders ................... [[32mSUCCESS[0m in 0.18s]
[0m10:03:46.571147 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.fct_orders
[0m10:03:46.572173 [debug] [MainThread]: On master: COMMIT
[0m10:03:46.572517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:46.572676 [debug] [MainThread]: Connection 'model.greencard_analytics.fct_orders' was properly closed.
[0m10:03:46.572801 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m10:03:46.572923 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m10:03:46.573063 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_user_events' was properly closed.
[0m10:03:46.573272 [info ] [MainThread]: 
[0m10:03:46.573509 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m10:03:46.574092 [debug] [MainThread]: Command end result
[0m10:03:46.579588 [info ] [MainThread]: 
[0m10:03:46.579845 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:03:46.580185 [info ] [MainThread]: 
[0m10:03:46.580441 [error] [MainThread]:   Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 16:6: Schema 'raw_data' does not exist", query_id=20251011_100345_00014_frub7)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m10:03:46.580687 [info ] [MainThread]: 
[0m10:03:46.580913 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
[0m10:03:46.582339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94eb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94e9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea84c10>]}
[0m10:03:46.582544 [debug] [MainThread]: Flushing usage events
[0m10:04:27.885208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bd3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bd0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bd2590>]}


============================== 10:04:27.887668 | 5a9d29a1-3559-427b-b73f-6f2406f04d11 ==============================
[0m10:04:27.887668 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:04:27.888127 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'printer_width': '80', 'version_check': 'True', 'quiet': 'False', 'use_colors': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/app/logs', 'no_print': 'None', 'target_path': 'None', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '/root/.dbt', 'introspect': 'True', 'write_json': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run --models stg_user_events'}
[0m10:04:28.050172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a9d29a1-3559-427b-b73f-6f2406f04d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18bc110>]}
[0m10:04:28.173306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a9d29a1-3559-427b-b73f-6f2406f04d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1853450>]}
[0m10:04:28.173841 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m10:04:28.179042 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:04:28.206370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:04:28.206712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:04:28.209988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a9d29a1-3559-427b-b73f-6f2406f04d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15b2890>]}
[0m10:04:28.227131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a9d29a1-3559-427b-b73f-6f2406f04d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17ca590>]}
[0m10:04:28.227500 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m10:04:28.227896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a9d29a1-3559-427b-b73f-6f2406f04d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa176f150>]}
[0m10:04:28.228941 [info ] [MainThread]: 
[0m10:04:28.229697 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:04:28.230454 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m10:04:28.239312 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m10:04:28.239680 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m10:04:28.240325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:28.352995 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:04:28.354104 [debug] [ThreadPool]: On list_postgres: Close
[0m10:04:28.355788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m10:04:28.356307 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_staging'
[0m10:04:28.357034 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_marts'
[0m10:04:28.361197 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m10:04:28.366534 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m10:04:28.366780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:28.363863 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m10:04:28.366158 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m10:04:28.368933 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m10:04:28.369674 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m10:04:28.371146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:28.371669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:29.059360 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:04:29.072104 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m10:04:29.080941 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m10:04:29.089741 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:04:29.093012 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m10:04:29.093801 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m10:04:29.095717 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m10:04:29.099542 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m10:04:29.100616 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m10:04:29.103621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a9d29a1-3559-427b-b73f-6f2406f04d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a4f310>]}
[0m10:04:29.104495 [debug] [MainThread]: On master: COMMIT
[0m10:04:29.106205 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:04:29.106780 [info ] [MainThread]: 
[0m10:04:29.110433 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_user_events
[0m10:04:29.110968 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_staging.stg_user_events ................. [RUN]
[0m10:04:29.111844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_user_events)
[0m10:04:29.112220 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_user_events
[0m10:04:29.113633 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_user_events"
[0m10:04:29.114823 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_user_events (compile): 10:04:29.112471 => 10:04:29.114680
[0m10:04:29.115514 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_user_events
[0m10:04:29.143129 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_user_events"
[0m10:04:29.145487 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_user_events"
[0m10:04:29.146156 [debug] [Thread-1 (]: On model.greencard_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_user_events"} */

  
    

    create table "postgres"."analytics_staging"."stg_user_events__dbt_tmp"
      
      
    as (
      SELECT
    event_id,
    user_id as customer_id,
    event_type,
    product_id,
    session_id
FROM lakehouse.raw_data.user_events
    )
[0m10:04:29.146641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:29.169909 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251011_100429_00037_frub7
[0m10:04:29.170435 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 16:6: Schema 'raw_data' does not exist", query_id=20251011_100429_00037_frub7)
[0m10:04:29.170802 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_user_events (execute): 10:04:29.115788 => 10:04:29.170694
[0m10:04:29.171036 [debug] [Thread-1 (]: On model.greencard_analytics.stg_user_events: ROLLBACK
[0m10:04:29.171444 [debug] [Thread-1 (]: On model.greencard_analytics.stg_user_events: Close
[0m10:04:29.173974 [debug] [Thread-1 (]: Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 16:6: Schema 'raw_data' does not exist", query_id=20251011_100429_00037_frub7)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m10:04:29.174392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a9d29a1-3559-427b-b73f-6f2406f04d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17bc710>]}
[0m10:04:29.174754 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics_staging.stg_user_events ........ [[31mERROR[0m in 0.06s]
[0m10:04:29.175275 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_user_events
[0m10:04:29.176716 [debug] [MainThread]: On master: COMMIT
[0m10:04:29.177114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:29.177328 [debug] [MainThread]: Connection 'list_postgres_analytics_intermediate' was properly closed.
[0m10:04:29.177542 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_user_events' was properly closed.
[0m10:04:29.177743 [debug] [MainThread]: Connection 'list_postgres_analytics_marts' was properly closed.
[0m10:04:29.177952 [info ] [MainThread]: 
[0m10:04:29.178254 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m10:04:29.178795 [debug] [MainThread]: Command end result
[0m10:04:29.184901 [info ] [MainThread]: 
[0m10:04:29.185291 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:04:29.185576 [info ] [MainThread]: 
[0m10:04:29.185854 [error] [MainThread]:   Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 16:6: Schema 'raw_data' does not exist", query_id=20251011_100429_00037_frub7)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m10:04:29.186117 [info ] [MainThread]: 
[0m10:04:29.186443 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:04:29.187029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73596d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c1eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7208f90>]}
[0m10:04:29.187343 [debug] [MainThread]: Flushing usage events
[0m10:08:17.872445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99898a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d3b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9989ba90>]}


============================== 10:08:17.875102 | cd990b84-52a3-4706-a97d-27c9d182e81c ==============================
[0m10:08:17.875102 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:08:17.875535 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'log_path': '/usr/app/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'debug': 'False', 'log_format': 'default', 'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run'}
[0m10:08:17.994962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99483b50>]}
[0m10:08:18.054478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9953c090>]}
[0m10:08:18.054858 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m10:08:18.058857 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:08:18.078952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:08:18.079193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:08:18.081873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992aa350>]}
[0m10:08:18.087681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993cbe90>]}
[0m10:08:18.087922 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m10:08:18.088180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff994ad6d0>]}
[0m10:08:18.089124 [info ] [MainThread]: 
[0m10:08:18.089570 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:08:18.090333 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m10:08:18.090737 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m10:08:18.097619 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m10:08:18.098833 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m10:08:18.100055 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m10:08:18.101224 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m10:08:18.101429 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m10:08:18.101629 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m10:08:18.101845 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m10:08:18.102123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:18.102332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:18.102534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:18.148437 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.149295 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.150628 [debug] [ThreadPool]: On list_postgres: Close
[0m10:08:18.151017 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.151800 [debug] [ThreadPool]: On list_postgres: Close
[0m10:08:18.152927 [debug] [ThreadPool]: On list_postgres: Close
[0m10:08:18.154584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m10:08:18.155035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m10:08:18.159140 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m10:08:18.159452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m10:08:18.161579 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m10:08:18.161934 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m10:08:18.163792 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m10:08:18.164036 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m10:08:18.164292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:18.164550 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m10:08:18.164796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:18.165838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:18.300110 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.303140 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m10:08:18.305013 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m10:08:18.312007 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.313246 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.314983 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m10:08:18.314287 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m10:08:18.315583 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m10:08:18.316318 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m10:08:18.320971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff994c13d0>]}
[0m10:08:18.321791 [debug] [MainThread]: On master: COMMIT
[0m10:08:18.322652 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:08:18.323125 [info ] [MainThread]: 
[0m10:08:18.326313 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m10:08:18.326793 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m10:08:18.327173 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m10:08:18.327595 [debug] [Thread-4 (]: Began running node model.greencard_analytics.stg_user_events
[0m10:08:18.328104 [info ] [Thread-1 (]: 1 of 7 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m10:08:18.329032 [info ] [Thread-2 (]: 2 of 7 START sql table model analytics_staging.stg_products .................... [RUN]
[0m10:08:18.329868 [info ] [Thread-3 (]: 3 of 7 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m10:08:18.330387 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_staging.stg_user_events ................. [RUN]
[0m10:08:18.330946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_orders)
[0m10:08:18.331374 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_products)
[0m10:08:18.331772 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_suppliers)
[0m10:08:18.332461 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.stg_user_events'
[0m10:08:18.332719 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m10:08:18.332959 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m10:08:18.333186 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m10:08:18.333414 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.stg_user_events
[0m10:08:18.334384 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m10:08:18.336176 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m10:08:18.337099 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m10:08:18.337930 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.stg_user_events"
[0m10:08:18.339068 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 10:08:18.333595 => 10:08:18.338921
[0m10:08:18.339532 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 10:08:18.334676 => 10:08:18.339438
[0m10:08:18.339692 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m10:08:18.339949 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 10:08:18.336402 => 10:08:18.339866
[0m10:08:18.359722 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m10:08:18.340394 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (compile): 10:08:18.337300 => 10:08:18.340311
[0m10:08:18.359461 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m10:08:18.340157 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m10:08:18.362789 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m10:08:18.363136 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.stg_user_events
[0m10:08:18.396250 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m10:08:18.397090 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m10:08:18.399464 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.stg_user_events"
[0m10:08:18.400006 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "postgres"."analytics_staging"."stg_orders__dbt_tmp"
      
      
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
    )
[0m10:08:18.400519 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m10:08:18.401243 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m10:08:18.401451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:18.401699 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      
    as (
      SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m10:08:18.402179 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.stg_user_events"
[0m10:08:18.402369 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "postgres"."analytics_staging"."stg_products__dbt_tmp"
      
      
    as (
      SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m10:08:18.403255 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:08:18.403618 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_user_events"} */

  
    

    create table "postgres"."analytics_staging"."stg_user_events__dbt_tmp"
      
      
    as (
      SELECT
    event_id,
    user_id as customer_id,
    event_type,
    product_id,
    session_id
FROM lakehouse.raw_data.user_events
    )
[0m10:08:18.403860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:08:18.404775 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:08:18.542831 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.547508 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.stg_user_events"
[0m10:08:18.547963 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.548306 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.548698 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.548903 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_user_events"} */
alter table "postgres"."analytics_staging"."stg_user_events__dbt_tmp" rename to "postgres"."analytics_staging"."stg_user_events"
[0m10:08:18.550522 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m10:08:18.552193 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m10:08:18.553689 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m10:08:18.554548 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products" rename to "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m10:08:18.554845 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders" rename to "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m10:08:18.555103 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers" rename to "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m10:08:18.576370 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.579102 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.583439 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_staging"."stg_user_events__dbt_backup"
[0m10:08:18.583817 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.585572 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m10:08:18.585757 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.586916 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.stg_user_events"
[0m10:08:18.589264 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m10:08:18.589498 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "postgres"."analytics_staging"."stg_suppliers"
[0m10:08:18.590976 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m10:08:18.591259 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_user_events"} */

    drop table if exists "postgres"."analytics_staging"."stg_user_events__dbt_backup"
[0m10:08:18.591533 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products__dbt_tmp" rename to "postgres"."analytics_staging"."stg_products"
[0m10:08:18.592408 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders__dbt_tmp" rename to "postgres"."analytics_staging"."stg_orders"
[0m10:08:18.609906 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.610588 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.611504 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.619736 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (execute): 10:08:18.397577 => 10:08:18.619624
[0m10:08:18.620156 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.621626 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m10:08:18.623167 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m10:08:18.623463 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: ROLLBACK
[0m10:08:18.624844 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m10:08:18.625297 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m10:08:18.625710 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m10:08:18.625891 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: Close
[0m10:08:18.626267 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m10:08:18.626527 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m10:08:18.626796 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m10:08:18.627298 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99353390>]}
[0m10:08:18.627505 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m10:08:18.629084 [info ] [Thread-4 (]: 4 of 7 OK created sql table model analytics_staging.stg_user_events ............ [[32mSUCCESS[0m in 0.30s]
[0m10:08:18.631999 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.stg_user_events
[0m10:08:18.643862 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.644634 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.645021 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.647317 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 10:08:18.363687 => 10:08:18.647227
[0m10:08:18.648443 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 10:08:18.340477 => 10:08:18.648366
[0m10:08:18.649517 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 10:08:18.360015 => 10:08:18.649441
[0m10:08:18.649799 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m10:08:18.650017 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m10:08:18.650232 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m10:08:18.650439 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m10:08:18.650637 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m10:08:18.650838 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m10:08:18.651318 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff998db850>]}
[0m10:08:18.651719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99917d10>]}
[0m10:08:18.652101 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99367690>]}
[0m10:08:18.652397 [info ] [Thread-2 (]: 2 of 7 OK created sql table model analytics_staging.stg_products ............... [[32mSUCCESS[0m in 0.32s]
[0m10:08:18.652759 [info ] [Thread-1 (]: 1 of 7 OK created sql table model analytics_staging.stg_orders ................. [[32mSUCCESS[0m in 0.32s]
[0m10:08:18.653157 [info ] [Thread-3 (]: 3 of 7 OK created sql table model analytics_staging.stg_suppliers .............. [[32mSUCCESS[0m in 0.32s]
[0m10:08:18.653541 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m10:08:18.653847 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m10:08:18.654108 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m10:08:18.654869 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m10:08:18.655017 [debug] [Thread-2 (]: Began running node model.greencard_analytics.int_orders_with_behavior
[0m10:08:18.655236 [info ] [Thread-4 (]: 5 of 7 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m10:08:18.655582 [info ] [Thread-2 (]: 6 of 7 START sql table model analytics_intermediate.int_orders_with_behavior ... [RUN]
[0m10:08:18.656057 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_user_events, now model.greencard_analytics.int_orders_enriched)
[0m10:08:18.656401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_products, now model.greencard_analytics.int_orders_with_behavior)
[0m10:08:18.656611 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m10:08:18.656820 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.int_orders_with_behavior
[0m10:08:18.658897 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m10:08:18.660649 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_with_behavior"
[0m10:08:18.661796 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 10:08:18.657020 => 10:08:18.661706
[0m10:08:18.661955 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.int_orders_with_behavior (compile): 10:08:18.659104 => 10:08:18.661870
[0m10:08:18.662135 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m10:08:18.662369 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.int_orders_with_behavior
[0m10:08:18.664124 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m10:08:18.665852 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_with_behavior"
[0m10:08:18.668261 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m10:08:18.670168 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m10:08:18.670357 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m10:08:18.670650 [debug] [Thread-2 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_tmp"
      
      
    as (
      -- Three-way federation: PostgreSQL + MySQL + Lakehouse


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
),

user_events_agg AS (
    SELECT 
        customer_id,
        product_id,
        COUNT(CASE WHEN event_type = 'page_view' THEN 1 END) as page_views,
        COUNT(CASE WHEN event_type = 'add_to_cart' THEN 1 END) as cart_adds,
        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) as purchases
    FROM "postgres"."analytics_staging"."stg_user_events"
    GROUP BY customer_id, product_id
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    -- From MySQL
    p.product_name,
    p.category,
    s.supplier_name,
    s.country,
    s.sustainability_score,
    
    -- From Lakehouse
    COALESCE(e.page_views, 0) as customer_page_views,
    COALESCE(e.cart_adds, 0) as customer_cart_adds,
    COALESCE(e.purchases, 0) as customer_purchases

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
LEFT JOIN user_events_agg e ON o.customer_id = e.customer_id AND o.product_id = e.product_id
    )
[0m10:08:18.670907 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:08:18.671105 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:08:18.828148 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.833495 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m10:08:18.833888 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched" rename to "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m10:08:18.849694 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.852051 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m10:08:18.852388 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_enriched"
[0m10:08:18.861592 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.863642 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m10:08:18.863923 [debug] [Thread-2 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */
alter table "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_with_behavior"
[0m10:08:18.868608 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.871359 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m10:08:18.874293 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m10:08:18.874946 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m10:08:18.877889 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.880515 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m10:08:18.881420 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m10:08:18.881744 [debug] [Thread-2 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m10:08:18.886948 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.888447 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 10:08:18.662519 => 10:08:18.888350
[0m10:08:18.888720 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m10:08:18.888949 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m10:08:18.889422 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99282890>]}
[0m10:08:18.889753 [info ] [Thread-4 (]: 5 of 7 OK created sql table model analytics_intermediate.int_orders_enriched ... [[32mSUCCESS[0m in 0.23s]
[0m10:08:18.890249 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m10:08:18.891998 [debug] [Thread-3 (]: Began running node model.greencard_analytics.fct_orders
[0m10:08:18.892436 [info ] [Thread-3 (]: 7 of 7 START sql table model analytics_marts.fct_orders ........................ [RUN]
[0m10:08:18.892810 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.893188 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_suppliers, now model.greencard_analytics.fct_orders)
[0m10:08:18.894219 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.int_orders_with_behavior (execute): 10:08:18.664301 => 10:08:18.894139
[0m10:08:18.894458 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.fct_orders
[0m10:08:18.894690 [debug] [Thread-2 (]: On model.greencard_analytics.int_orders_with_behavior: ROLLBACK
[0m10:08:18.896429 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.fct_orders"
[0m10:08:18.896681 [debug] [Thread-2 (]: On model.greencard_analytics.int_orders_with_behavior: Close
[0m10:08:18.897423 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9900f290>]}
[0m10:08:18.897766 [info ] [Thread-2 (]: 6 of 7 OK created sql table model analytics_intermediate.int_orders_with_behavior  [[32mSUCCESS[0m in 0.24s]
[0m10:08:18.897965 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.fct_orders (compile): 10:08:18.894846 => 10:08:18.897881
[0m10:08:18.898250 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.int_orders_with_behavior
[0m10:08:18.898460 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.fct_orders
[0m10:08:18.900490 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.fct_orders"
[0m10:08:18.901917 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:08:18.902141 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

  
    

    create table "postgres"."analytics_marts"."fct_orders__dbt_tmp"
      
      
    as (
      -- Final fact table for analysis


SELECT
    order_id,
    customer_id,
    order_date,
    amount as revenue,
    product_name,
    category as product_category,
    supplier_name,
    country as supplier_country,
    region as supplier_region,
    sustainability_score,
    sustainability_tier,
    order_value_tier,
    
    -- Business metrics
    EXTRACT(YEAR FROM order_date) as order_year,
    EXTRACT(MONTH FROM order_date) as order_month,
    EXTRACT(QUARTER FROM order_date) as order_quarter

FROM "postgres"."analytics_intermediate"."int_orders_enriched"
    )
[0m10:08:18.902346 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:08:18.966649 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.968499 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:08:18.968763 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders" rename to "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m10:08:18.979766 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.981714 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:08:18.981968 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders__dbt_tmp" rename to "postgres"."analytics_marts"."fct_orders"
[0m10:08:18.994580 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:18.999271 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m10:08:18.999865 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:08:19.000086 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

    drop table if exists "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m10:08:19.011014 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:08:19.012411 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.fct_orders (execute): 10:08:18.898764 => 10:08:19.012322
[0m10:08:19.012670 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: ROLLBACK
[0m10:08:19.012869 [debug] [Thread-3 (]: On model.greencard_analytics.fct_orders: Close
[0m10:08:19.013331 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd990b84-52a3-4706-a97d-27c9d182e81c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99089a50>]}
[0m10:08:19.013644 [info ] [Thread-3 (]: 7 of 7 OK created sql table model analytics_marts.fct_orders ................... [[32mSUCCESS[0m in 0.12s]
[0m10:08:19.014031 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.fct_orders
[0m10:08:19.015058 [debug] [MainThread]: On master: COMMIT
[0m10:08:19.015419 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:19.015605 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_with_behavior' was properly closed.
[0m10:08:19.015785 [debug] [MainThread]: Connection 'model.greencard_analytics.fct_orders' was properly closed.
[0m10:08:19.016071 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m10:08:19.016220 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m10:08:19.016420 [info ] [MainThread]: 
[0m10:08:19.016640 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m10:08:19.017334 [debug] [MainThread]: Command end result
[0m10:08:19.023720 [info ] [MainThread]: 
[0m10:08:19.024082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:08:19.024308 [info ] [MainThread]: 
[0m10:08:19.024567 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:08:19.025148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eef8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99893a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99893990>]}
[0m10:08:19.025371 [debug] [MainThread]: Flushing usage events
[0m10:10:31.566201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3a62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b73e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3a76d0>]}


============================== 10:10:31.568526 | b3075db0-a499-4db6-b26c-f0e1782b946e ==============================
[0m10:10:31.568526 [info ] [MainThread]: Running with dbt=1.7.4
[0m10:10:31.568957 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'version_check': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'no_print': 'None', 'partial_parse': 'True', 'log_path': '/usr/app/logs', 'log_format': 'default', 'indirect_selection': 'eager', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --models fct_orders', 'printer_width': '80', 'write_json': 'True'}
[0m10:10:31.691446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3075db0-a499-4db6-b26c-f0e1782b946e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b2f1fd0>]}
[0m10:10:31.751945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3075db0-a499-4db6-b26c-f0e1782b946e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3b9e10>]}
[0m10:10:31.752332 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m10:10:31.758635 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m10:10:31.780837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:10:31.781232 [debug] [MainThread]: Partial parsing: updated file: greencard_analytics://models/marts/fct_orders.sql
[0m10:10:31.876149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3075db0-a499-4db6-b26c-f0e1782b946e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac67e50>]}
[0m10:10:31.908867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3075db0-a499-4db6-b26c-f0e1782b946e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ace6e10>]}
[0m10:10:31.909180 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m10:10:31.909449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3075db0-a499-4db6-b26c-f0e1782b946e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac45ed0>]}
[0m10:10:31.910294 [info ] [MainThread]: 
[0m10:10:31.910826 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m10:10:31.911539 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m10:10:31.919583 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m10:10:31.919812 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m10:10:31.919996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:31.968090 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:10:31.969005 [debug] [ThreadPool]: On list_postgres: Close
[0m10:10:31.970242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m10:10:31.970783 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_marts'
[0m10:10:31.976454 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m10:10:31.977250 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres_analytics_intermediate'
[0m10:10:31.980044 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m10:10:31.980764 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m10:10:31.983797 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m10:10:31.984096 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m10:10:31.984396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:31.984695 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m10:10:31.984944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:31.985855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:32.082074 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:10:32.087270 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m10:10:32.089206 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m10:10:32.092500 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:10:32.094122 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m10:10:32.094478 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m10:10:32.094698 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m10:10:32.095332 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m10:10:32.096262 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m10:10:32.097051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3075db0-a499-4db6-b26c-f0e1782b946e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9addc150>]}
[0m10:10:32.097367 [debug] [MainThread]: On master: COMMIT
[0m10:10:32.097766 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:10:32.098052 [info ] [MainThread]: 
[0m10:10:32.099852 [debug] [Thread-1 (]: Began running node model.greencard_analytics.fct_orders
[0m10:10:32.100174 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics_marts.fct_orders ........................ [RUN]
[0m10:10:32.100726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.fct_orders)
[0m10:10:32.101038 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.fct_orders
[0m10:10:32.103763 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.fct_orders"
[0m10:10:32.105377 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.fct_orders (compile): 10:10:32.101204 => 10:10:32.105276
[0m10:10:32.105619 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.fct_orders
[0m10:10:32.124162 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.fct_orders"
[0m10:10:32.125827 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:10:32.126152 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

  
    

    create table "postgres"."analytics_marts"."fct_orders__dbt_tmp"
      
      
    as (
      

SELECT
    order_id,
    customer_id,
    order_date,
    amount as revenue,
    product_name,
    category as product_category,
    supplier_name,
    country as supplier_country,
    sustainability_score,
    customer_page_views,
    customer_cart_adds,
    customer_purchases,
    
    EXTRACT(YEAR FROM order_date) as order_year,
    EXTRACT(MONTH FROM order_date) as order_month,
    EXTRACT(QUARTER FROM order_date) as order_quarter

FROM "postgres"."analytics_intermediate"."int_orders_with_behavior"
    )
[0m10:10:32.126411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:32.218719 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:10:32.222877 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:10:32.223176 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders" rename to "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m10:10:32.235881 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:10:32.237769 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:10:32.238015 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders__dbt_tmp" rename to "postgres"."analytics_marts"."fct_orders"
[0m10:10:32.249812 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:10:32.254158 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m10:10:32.255337 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m10:10:32.255609 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

    drop table if exists "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m10:10:32.269189 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m10:10:32.277853 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.fct_orders (execute): 10:10:32.105793 => 10:10:32.277756
[0m10:10:32.278178 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: ROLLBACK
[0m10:10:32.278449 [debug] [Thread-1 (]: On model.greencard_analytics.fct_orders: Close
[0m10:10:32.278992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3075db0-a499-4db6-b26c-f0e1782b946e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad5f610>]}
[0m10:10:32.279371 [info ] [Thread-1 (]: 1 of 1 OK created sql table model analytics_marts.fct_orders ................... [[32mSUCCESS[0m in 0.18s]
[0m10:10:32.279867 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.fct_orders
[0m10:10:32.280995 [debug] [MainThread]: On master: COMMIT
[0m10:10:32.281336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:32.281537 [debug] [MainThread]: Connection 'list_postgres_analytics_staging' was properly closed.
[0m10:10:32.281743 [debug] [MainThread]: Connection 'model.greencard_analytics.fct_orders' was properly closed.
[0m10:10:32.281905 [debug] [MainThread]: Connection 'list_postgres_analytics_intermediate' was properly closed.
[0m10:10:32.282064 [info ] [MainThread]: 
[0m10:10:32.282266 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m10:10:32.282741 [debug] [MainThread]: Command end result
[0m10:10:32.287942 [info ] [MainThread]: 
[0m10:10:32.288159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:10:32.288412 [info ] [MainThread]: 
[0m10:10:32.288679 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:10:32.289243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3ac4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b9c0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa09d4d10>]}
[0m10:10:32.289464 [debug] [MainThread]: Flushing usage events
[0m17:27:54.921908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf80c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc3f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafdbc5d0>]}


============================== 17:27:54.930929 | 0f3b47bc-ac59-499e-80dc-65642d433e4d ==============================
[0m17:27:54.930929 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:27:54.931272 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/app/logs', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'printer_width': '80', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'target_path': 'None', 'profiles_dir': '/root/.dbt'}
[0m17:27:55.065512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f3b47bc-ac59-499e-80dc-65642d433e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf4beb90>]}
[0m17:27:55.127327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f3b47bc-ac59-499e-80dc-65642d433e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf62f4d0>]}
[0m17:27:55.127637 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m17:27:55.132435 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:27:55.138526 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:27:55.138851 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:27:55.139330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f3b47bc-ac59-499e-80dc-65642d433e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf177790>]}
[0m17:27:55.689993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f3b47bc-ac59-499e-80dc-65642d433e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf05b650>]}
[0m17:27:55.698433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f3b47bc-ac59-499e-80dc-65642d433e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae70cad0>]}
[0m17:27:55.698842 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m17:27:55.699315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3b47bc-ac59-499e-80dc-65642d433e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf248c90>]}
[0m17:27:55.700518 [info ] [MainThread]: 
[0m17:27:55.701105 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:27:55.702227 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:27:55.703225 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:27:55.711389 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:27:55.711727 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:27:55.712957 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:27:55.713166 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:27:55.714297 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:27:55.714490 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:27:55.714673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:55.714847 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:27:55.715027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:55.715528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:55.794296 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:27:55.794745 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:27:55.795205 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:27:55.796091 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:27:55.797149 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:27:55.797907 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:27:55.799984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_analytics_marts)
[0m17:27:55.800713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_analytics_staging)
[0m17:27:55.801006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now create_lakehouse_analytics_intermediate)
[0m17:27:55.801853 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "analytics_marts"
"
[0m17:27:55.802671 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "analytics_staging"
"
[0m17:27:55.803013 [debug] [ThreadPool]: Creating schema "database: "lakehouse"
schema: "analytics_intermediate"
"
[0m17:27:55.805763 [debug] [ThreadPool]: Using trino connection "create_lakehouse_analytics_marts"
[0m17:27:55.807326 [debug] [ThreadPool]: Using trino connection "create_lakehouse_analytics_staging"
[0m17:27:55.808852 [debug] [ThreadPool]: Using trino connection "create_lakehouse_analytics_intermediate"
[0m17:27:55.809126 [debug] [ThreadPool]: On create_lakehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "create_lakehouse_analytics_marts"} */
create schema if not exists "lakehouse"."analytics_marts"
[0m17:27:55.809426 [debug] [ThreadPool]: On create_lakehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "create_lakehouse_analytics_staging"} */
create schema if not exists "lakehouse"."analytics_staging"
[0m17:27:55.809706 [debug] [ThreadPool]: On create_lakehouse_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "create_lakehouse_analytics_intermediate"} */
create schema if not exists "lakehouse"."analytics_intermediate"
[0m17:27:55.810357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:55.810767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:55.811271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:55.830000 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:27:55.831274 [debug] [ThreadPool]: On create_lakehouse_analytics_intermediate: COMMIT
[0m17:27:55.831620 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:27:55.831923 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:27:55.832152 [debug] [ThreadPool]: On create_lakehouse_analytics_intermediate: Close
[0m17:27:55.832755 [debug] [ThreadPool]: On create_lakehouse_analytics_marts: COMMIT
[0m17:27:55.833306 [debug] [ThreadPool]: On create_lakehouse_analytics_staging: COMMIT
[0m17:27:55.834595 [debug] [ThreadPool]: On create_lakehouse_analytics_marts: Close
[0m17:27:55.834943 [debug] [ThreadPool]: On create_lakehouse_analytics_staging: Close
[0m17:27:55.838005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lakehouse_analytics_staging, now list_lakehouse_analytics_marts)
[0m17:27:55.838669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lakehouse_analytics_marts, now list_lakehouse_analytics_staging)
[0m17:27:55.839225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_lakehouse_analytics_intermediate, now list_lakehouse_analytics_intermediate)
[0m17:27:55.843547 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_marts"
[0m17:27:55.845762 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_staging"
[0m17:27:55.848665 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_intermediate"
[0m17:27:55.849198 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m17:27:55.849546 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m17:27:55.849841 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m17:27:55.850241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:55.850890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:55.851244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:56.191598 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:27:56.192466 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:27:56.192803 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:27:56.193587 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: ROLLBACK
[0m17:27:56.194296 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: ROLLBACK
[0m17:27:56.194853 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: ROLLBACK
[0m17:27:56.195080 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: Close
[0m17:27:56.195285 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: Close
[0m17:27:56.195473 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: Close
[0m17:27:56.196945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3b47bc-ac59-499e-80dc-65642d433e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf22fcd0>]}
[0m17:27:56.197274 [debug] [MainThread]: On master: COMMIT
[0m17:27:56.197629 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:27:56.197943 [info ] [MainThread]: 
[0m17:27:56.206622 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m17:27:56.206935 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m17:27:56.207458 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m17:27:56.207720 [debug] [Thread-4 (]: Began running node model.greencard_analytics.stg_user_events
[0m17:27:56.208026 [info ] [Thread-1 (]: 1 of 7 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m17:27:56.208664 [info ] [Thread-2 (]: 2 of 7 START sql table model analytics_staging.stg_products .................... [RUN]
[0m17:27:56.209130 [info ] [Thread-3 (]: 3 of 7 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m17:27:56.209571 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_staging.stg_user_events ................. [RUN]
[0m17:27:56.210136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_staging, now model.greencard_analytics.stg_orders)
[0m17:27:56.210544 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_marts, now model.greencard_analytics.stg_products)
[0m17:27:56.210910 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_intermediate, now model.greencard_analytics.stg_suppliers)
[0m17:27:56.211354 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.stg_user_events'
[0m17:27:56.211548 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m17:27:56.211785 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m17:27:56.211980 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m17:27:56.212226 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.stg_user_events
[0m17:27:56.213331 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m17:27:56.214167 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m17:27:56.215076 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m17:27:56.216012 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.stg_user_events"
[0m17:27:56.217769 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 17:27:56.212354 => 17:27:56.217624
[0m17:27:56.218050 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 17:27:56.213502 => 17:27:56.217916
[0m17:27:56.218396 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m17:27:56.218576 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 17:27:56.214352 => 17:27:56.218494
[0m17:27:56.218745 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (compile): 17:27:56.215260 => 17:27:56.218664
[0m17:27:56.218930 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m17:27:56.239488 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m17:27:56.241930 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m17:27:56.242402 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.stg_user_events
[0m17:27:56.244968 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m17:27:56.249445 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m17:27:56.257996 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.stg_user_events"
[0m17:27:56.260291 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m17:27:56.263819 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m17:27:56.265150 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "lakehouse"."analytics_staging"."stg_orders__dbt_tmp"
      
      WITH (format = 'PARQUET',
  external_location = 's3://warehouse/staging/')
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
    )
[0m17:27:56.266267 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m17:27:56.266740 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "lakehouse"."analytics_staging"."stg_products__dbt_tmp"
      
      WITH (format = 'PARQUET',
  external_location = 's3://warehouse/staging/')
    as (
      SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m17:27:56.267625 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.stg_user_events"
[0m17:27:56.267885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:56.268262 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "lakehouse"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      WITH (format = 'PARQUET',
  external_location = 's3://warehouse/staging/')
    as (
      SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m17:27:56.268675 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:27:56.269353 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_user_events"} */

  
    

    create table "lakehouse"."analytics_staging"."stg_user_events__dbt_tmp"
      
      WITH (format = 'PARQUET',
  external_location = 's3://warehouse/staging/')
    as (
      SELECT
    event_id,
    user_id as customer_id,
    event_type,
    product_id,
    session_id
FROM lakehouse.raw_data.user_events
    )
[0m17:27:56.272485 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:27:56.276234 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:27:56.331718 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20251011_172756_00051_zwjry
[0m17:27:56.336909 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 17:6: Schema 'raw_data' does not exist", query_id=20251011_172756_00051_zwjry)
[0m17:27:56.337907 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (execute): 17:27:56.250444 => 17:27:56.337565
[0m17:27:56.338819 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: ROLLBACK
[0m17:27:56.339678 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: Close
[0m17:27:56.357436 [debug] [Thread-4 (]: Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 17:6: Schema 'raw_data' does not exist", query_id=20251011_172756_00051_zwjry)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m17:27:56.359186 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b47bc-ac59-499e-80dc-65642d433e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaebaa510>]}
[0m17:27:56.360253 [error] [Thread-4 (]: 4 of 7 ERROR creating sql table model analytics_staging.stg_user_events ........ [[31mERROR[0m in 0.15s]
[0m17:27:56.361727 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.stg_user_events
[0m17:27:57.633920 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:27:57.639905 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m17:27:57.640384 [debug] [Thread-3 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:27:57.640759 [debug] [Thread-2 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:27:57.641089 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "lakehouse"."analytics_staging"."stg_orders__dbt_tmp" rename to "lakehouse"."analytics_staging"."stg_orders"
[0m17:27:57.642907 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m17:27:57.644540 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m17:27:57.645770 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "lakehouse"."analytics_staging"."stg_products__dbt_tmp" rename to "lakehouse"."analytics_staging"."stg_products"
[0m17:27:57.645484 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "lakehouse"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "lakehouse"."analytics_staging"."stg_suppliers"
[0m17:27:57.656798 [debug] [Thread-2 (]: Trino adapter: Trino query id: 20251011_172757_00053_zwjry
[0m17:27:57.657130 [debug] [Thread-1 (]: Trino adapter: Trino query id: 20251011_172757_00052_zwjry
[0m17:27:57.657527 [debug] [Thread-3 (]: Trino adapter: Trino query id: 20251011_172757_00054_zwjry
[0m17:27:57.658460 [debug] [Thread-3 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_staging.stg_suppliers__dbt_tmp to analytics_staging.stg_suppliers", query_id=20251011_172757_00054_zwjry)
[0m17:27:57.658176 [debug] [Thread-1 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_staging.stg_orders__dbt_tmp to analytics_staging.stg_orders", query_id=20251011_172757_00052_zwjry)
[0m17:27:57.657830 [debug] [Thread-2 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_staging.stg_products__dbt_tmp to analytics_staging.stg_products", query_id=20251011_172757_00053_zwjry)
[0m17:27:57.659521 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 17:27:56.242686 => 17:27:57.659434
[0m17:27:57.659214 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 17:27:56.219104 => 17:27:57.659128
[0m17:27:57.658819 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 17:27:56.245434 => 17:27:57.658716
[0m17:27:57.660367 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m17:27:57.660133 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m17:27:57.659830 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m17:27:57.661115 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m17:27:57.660895 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m17:27:57.660584 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m17:27:57.667179 [debug] [Thread-3 (]: Database Error in model stg_suppliers (models/staging/stg_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_staging.stg_suppliers__dbt_tmp to analytics_staging.stg_suppliers", query_id=20251011_172757_00054_zwjry)
  compiled Code at target/run/greencard_analytics/models/staging/stg_suppliers.sql
[0m17:27:57.665379 [debug] [Thread-1 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_staging.stg_orders__dbt_tmp to analytics_staging.stg_orders", query_id=20251011_172757_00052_zwjry)
  compiled Code at target/run/greencard_analytics/models/staging/stg_orders.sql
[0m17:27:57.663523 [debug] [Thread-2 (]: Database Error in model stg_products (models/staging/stg_products.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_staging.stg_products__dbt_tmp to analytics_staging.stg_products", query_id=20251011_172757_00053_zwjry)
  compiled Code at target/run/greencard_analytics/models/staging/stg_products.sql
[0m17:27:57.668270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b47bc-ac59-499e-80dc-65642d433e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae71df50>]}
[0m17:27:57.667974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b47bc-ac59-499e-80dc-65642d433e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb34150>]}
[0m17:27:57.667646 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b47bc-ac59-499e-80dc-65642d433e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae772550>]}
[0m17:27:57.669500 [error] [Thread-3 (]: 3 of 7 ERROR creating sql table model analytics_staging.stg_suppliers .......... [[31mERROR[0m in 1.46s]
[0m17:27:57.669061 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model analytics_staging.stg_orders ............. [[31mERROR[0m in 1.46s]
[0m17:27:57.668677 [error] [Thread-2 (]: 2 of 7 ERROR creating sql table model analytics_staging.stg_products ........... [[31mERROR[0m in 1.46s]
[0m17:27:57.670475 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m17:27:57.670159 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m17:27:57.669826 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m17:27:57.671442 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m17:27:57.671655 [debug] [Thread-2 (]: Began running node model.greencard_analytics.int_orders_with_behavior
[0m17:27:57.671901 [info ] [Thread-4 (]: 5 of 7 SKIP relation analytics_intermediate.int_orders_enriched ................ [[33mSKIP[0m]
[0m17:27:57.672166 [info ] [Thread-2 (]: 6 of 7 SKIP relation analytics_intermediate.int_orders_with_behavior ........... [[33mSKIP[0m]
[0m17:27:57.672478 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m17:27:57.672711 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.int_orders_with_behavior
[0m17:27:57.673281 [debug] [Thread-3 (]: Began running node model.greencard_analytics.fct_orders
[0m17:27:57.673547 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_marts.fct_orders ................................ [[33mSKIP[0m]
[0m17:27:57.673791 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.fct_orders
[0m17:27:57.674760 [debug] [MainThread]: On master: COMMIT
[0m17:27:57.675124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:57.675312 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m17:27:57.675461 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m17:27:57.675596 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_products' was properly closed.
[0m17:27:57.675741 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_user_events' was properly closed.
[0m17:27:57.675956 [info ] [MainThread]: 
[0m17:27:57.676236 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m17:27:57.676911 [debug] [MainThread]: Command end result
[0m17:27:57.686734 [info ] [MainThread]: 
[0m17:27:57.687007 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m17:27:57.687249 [info ] [MainThread]: 
[0m17:27:57.687486 [error] [MainThread]:   Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 17:6: Schema 'raw_data' does not exist", query_id=20251011_172756_00051_zwjry)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m17:27:57.687669 [info ] [MainThread]: 
[0m17:27:57.687872 [error] [MainThread]:   Database Error in model stg_products (models/staging/stg_products.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_staging.stg_products__dbt_tmp to analytics_staging.stg_products", query_id=20251011_172757_00053_zwjry)
  compiled Code at target/run/greencard_analytics/models/staging/stg_products.sql
[0m17:27:57.688125 [info ] [MainThread]: 
[0m17:27:57.688367 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_staging.stg_orders__dbt_tmp to analytics_staging.stg_orders", query_id=20251011_172757_00052_zwjry)
  compiled Code at target/run/greencard_analytics/models/staging/stg_orders.sql
[0m17:27:57.688569 [info ] [MainThread]: 
[0m17:27:57.688759 [error] [MainThread]:   Database Error in model stg_suppliers (models/staging/stg_suppliers.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_staging.stg_suppliers__dbt_tmp to analytics_staging.stg_suppliers", query_id=20251011_172757_00054_zwjry)
  compiled Code at target/run/greencard_analytics/models/staging/stg_suppliers.sql
[0m17:27:57.688970 [info ] [MainThread]: 
[0m17:27:57.689213 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=3 TOTAL=7
[0m17:27:57.690135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc3f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafc3f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4de8bd0>]}
[0m17:27:57.690351 [debug] [MainThread]: Flushing usage events
[0m17:32:18.343531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75d6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75a6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75d7950>]}


============================== 17:32:18.346203 | a638c5f7-dd5f-42a3-a192-220e9d4ce28c ==============================
[0m17:32:18.346203 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:32:18.346678 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'debug': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'introspect': 'True', 'log_path': '/usr/app/logs', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/root/.dbt', 'log_format': 'default', 'warn_error': 'None'}
[0m17:32:18.418398 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ this.name | replace('stg_', '') }}: 'this' is undefined
[0m17:32:18.419286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ea6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7bc0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8fa1dd0>]}
[0m17:32:18.419597 [debug] [MainThread]: Flushing usage events
[0m17:33:11.596244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9280a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928081d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928082d0>]}


============================== 17:33:11.598028 | cced74f6-2b80-4987-8f64-485f1bb2e8b5 ==============================
[0m17:33:11.598028 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:33:11.598672 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'debug': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': '/usr/app/logs', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80'}
[0m17:33:11.666984 [error] [MainThread]: Encountered an error:
Compilation Error
  Could not render {{ this.name | replace('stg_', '') }}: 'this' is undefined
[0m17:33:11.667689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97dd4ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97dd5150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92793890>]}
[0m17:33:11.667949 [debug] [MainThread]: Flushing usage events
[0m17:34:07.541162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f9a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c0c8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bb6b10>]}


============================== 17:34:07.543207 | e3834b32-aafe-4e60-8b69-454746d350d5 ==============================
[0m17:34:07.543207 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:34:07.543677 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'log_path': '/usr/app/logs', 'use_colors': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'fail_fast': 'False'}
[0m17:34:07.662749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c1e5d0>]}
[0m17:34:07.722677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88852d50>]}
[0m17:34:07.723025 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m17:34:07.726989 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:34:07.732381 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:34:07.732623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8888b250>]}
[0m17:34:08.224201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8830edd0>]}
[0m17:34:08.230182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b1a110>]}
[0m17:34:08.230474 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m17:34:08.230702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f82e90>]}
[0m17:34:08.231651 [info ] [MainThread]: 
[0m17:34:08.232089 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:34:08.232828 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:34:08.233224 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:34:08.241016 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:34:08.241343 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:34:08.242509 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:34:08.242760 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:34:08.243852 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:34:08.244081 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:34:08.244305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:08.244540 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:34:08.244766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:08.245235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:08.671117 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:08.671829 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:08.672260 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:08.673475 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:34:08.674245 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:34:08.674940 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:34:08.677794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_analytics_intermediate)
[0m17:34:08.678229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_analytics_staging)
[0m17:34:08.678687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_analytics_marts)
[0m17:34:08.683857 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_intermediate"
[0m17:34:08.686013 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_staging"
[0m17:34:08.687994 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_marts"
[0m17:34:08.688294 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m17:34:08.688641 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m17:34:08.688954 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m17:34:08.689275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:08.689511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:08.689735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:09.012797 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:09.013271 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:09.015277 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: ROLLBACK
[0m17:34:09.016336 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: ROLLBACK
[0m17:34:09.018795 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: Close
[0m17:34:09.020173 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: Close
[0m17:34:09.023336 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:09.024235 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: ROLLBACK
[0m17:34:09.024485 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: Close
[0m17:34:09.025630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b1f210>]}
[0m17:34:09.026010 [debug] [MainThread]: On master: COMMIT
[0m17:34:09.026498 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:34:09.026743 [info ] [MainThread]: 
[0m17:34:09.029193 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m17:34:09.029411 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m17:34:09.029615 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m17:34:09.029801 [debug] [Thread-4 (]: Began running node model.greencard_analytics.stg_user_events
[0m17:34:09.030106 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m17:34:09.030469 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_staging.stg_products ..................... [RUN]
[0m17:34:09.030833 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_staging.stg_suppliers .................... [RUN]
[0m17:34:09.031144 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics_staging.stg_user_events .................. [RUN]
[0m17:34:09.031736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_staging, now model.greencard_analytics.stg_orders)
[0m17:34:09.032155 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_marts, now model.greencard_analytics.stg_products)
[0m17:34:09.032574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_intermediate, now model.greencard_analytics.stg_suppliers)
[0m17:34:09.033237 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.stg_user_events'
[0m17:34:09.033523 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m17:34:09.033786 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m17:34:09.034024 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m17:34:09.034255 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.stg_user_events
[0m17:34:09.035443 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m17:34:09.036333 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m17:34:09.037142 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m17:34:09.038742 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.stg_user_events"
[0m17:34:09.040126 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 17:34:09.034484 => 17:34:09.040012
[0m17:34:09.040306 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 17:34:09.035661 => 17:34:09.040216
[0m17:34:09.040655 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 17:34:09.036528 => 17:34:09.040527
[0m17:34:09.040815 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m17:34:09.041122 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (compile): 17:34:09.037333 => 17:34:09.041043
[0m17:34:09.041267 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m17:34:09.041468 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m17:34:09.051212 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m17:34:09.051531 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.stg_user_events
[0m17:34:09.053058 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m17:34:09.054311 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m17:34:09.055937 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.stg_user_events"
[0m17:34:09.056819 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m17:34:09.057679 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m17:34:09.057842 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_orders"
  security definer
  as
    SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
  
[0m17:34:09.058265 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m17:34:09.058817 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.stg_user_events"
[0m17:34:09.058964 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_products"
  security definer
  as
    SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
  
[0m17:34:09.059176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:09.059378 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_suppliers"
  security definer
  as
    SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
  
[0m17:34:09.059572 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_user_events"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_user_events"
  security definer
  as
    SELECT
    event_id,
    user_id as customer_id,
    event_type,
    product_id,
    session_id
FROM lakehouse.raw_data.user_events
  
[0m17:34:09.059775 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:34:09.060643 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:34:09.061006 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:34:09.096212 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20251011_173409_00011_dnzhq
[0m17:34:09.097085 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 13:6: Schema 'raw_data' does not exist", query_id=20251011_173409_00011_dnzhq)
[0m17:34:09.097592 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (execute): 17:34:09.054733 => 17:34:09.097463
[0m17:34:09.098061 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: ROLLBACK
[0m17:34:09.098400 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: Close
[0m17:34:09.101956 [debug] [Thread-4 (]: Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 13:6: Schema 'raw_data' does not exist", query_id=20251011_173409_00011_dnzhq)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m17:34:09.102870 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b95ad0>]}
[0m17:34:09.103554 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model analytics_staging.stg_user_events ......... [[31mERROR[0m in 0.07s]
[0m17:34:09.104322 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.stg_user_events
[0m17:34:09.157206 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:09.165866 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 17:34:09.041619 => 17:34:09.165765
[0m17:34:09.166186 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m17:34:09.166461 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m17:34:09.167121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff884ff610>]}
[0m17:34:09.167614 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics_staging.stg_orders .................. [[32mSUCCESS[0m in 0.14s]
[0m17:34:09.168143 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m17:34:09.308306 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:09.309865 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 17:34:09.053229 => 17:34:09.309765
[0m17:34:09.310241 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:34:09.310537 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m17:34:09.311548 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 17:34:09.051786 => 17:34:09.311470
[0m17:34:09.311803 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m17:34:09.312074 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m17:34:09.312605 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87bb94d0>]}
[0m17:34:09.312837 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m17:34:09.313168 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_staging.stg_suppliers ............... [[32mSUCCESS[0m in 0.28s]
[0m17:34:09.313952 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87fc4b10>]}
[0m17:34:09.314252 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m17:34:09.314605 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_staging.stg_products ................ [[32mSUCCESS[0m in 0.28s]
[0m17:34:09.315112 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m17:34:09.315763 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m17:34:09.315912 [debug] [Thread-1 (]: Began running node model.greencard_analytics.int_orders_with_behavior
[0m17:34:09.316161 [info ] [Thread-4 (]: 5 of 7 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m17:34:09.316455 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_intermediate.int_orders_with_behavior ........... [[33mSKIP[0m]
[0m17:34:09.316937 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_user_events, now model.greencard_analytics.int_orders_enriched)
[0m17:34:09.317203 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.int_orders_with_behavior
[0m17:34:09.317474 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m17:34:09.317855 [debug] [Thread-2 (]: Began running node model.greencard_analytics.fct_orders
[0m17:34:09.319772 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m17:34:09.320052 [info ] [Thread-2 (]: 7 of 7 SKIP relation analytics_marts.fct_orders ................................ [[33mSKIP[0m]
[0m17:34:09.320616 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.fct_orders
[0m17:34:09.321856 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 17:34:09.318022 => 17:34:09.321769
[0m17:34:09.322060 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m17:34:09.339647 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m17:34:09.342209 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m17:34:09.342476 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "lakehouse"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "lakehouse"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "lakehouse"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "lakehouse"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m17:34:09.342740 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:34:10.125198 [debug] [Thread-4 (]: SQL status: SUCCESS in 1.0 seconds
[0m17:34:10.131296 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m17:34:10.131597 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "lakehouse"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "lakehouse"."analytics_intermediate"."int_orders_enriched"
[0m17:34:10.141126 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20251011_173410_00014_dnzhq
[0m17:34:10.141479 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_intermediate.int_orders_enriched__dbt_tmp to analytics_intermediate.int_orders_enriched", query_id=20251011_173410_00014_dnzhq)
[0m17:34:10.141840 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 17:34:09.322188 => 17:34:10.141696
[0m17:34:10.142063 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m17:34:10.142267 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m17:34:10.144499 [debug] [Thread-4 (]: Database Error in model int_orders_enriched (models/intermediate/int_orders_enriched.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_intermediate.int_orders_enriched__dbt_tmp to analytics_intermediate.int_orders_enriched", query_id=20251011_173410_00014_dnzhq)
  compiled Code at target/run/greencard_analytics/models/intermediate/int_orders_enriched.sql
[0m17:34:10.144985 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3834b32-aafe-4e60-8b69-454746d350d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88676510>]}
[0m17:34:10.145427 [error] [Thread-4 (]: 5 of 7 ERROR creating sql table model analytics_intermediate.int_orders_enriched  [[31mERROR[0m in 0.83s]
[0m17:34:10.145795 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m17:34:10.147120 [debug] [MainThread]: On master: COMMIT
[0m17:34:10.147535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:10.147717 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m17:34:10.147931 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_products' was properly closed.
[0m17:34:10.148078 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m17:34:10.148226 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m17:34:10.148491 [info ] [MainThread]: 
[0m17:34:10.148716 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m17:34:10.149326 [debug] [MainThread]: Command end result
[0m17:34:10.156005 [info ] [MainThread]: 
[0m17:34:10.156347 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:34:10.156548 [info ] [MainThread]: 
[0m17:34:10.156841 [error] [MainThread]:   Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=SCHEMA_NOT_FOUND, message="line 13:6: Schema 'raw_data' does not exist", query_id=20251011_173409_00011_dnzhq)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m17:34:10.157048 [info ] [MainThread]: 
[0m17:34:10.157284 [error] [MainThread]:   Database Error in model int_orders_enriched (models/intermediate/int_orders_enriched.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot rename table from analytics_intermediate.int_orders_enriched__dbt_tmp to analytics_intermediate.int_orders_enriched", query_id=20251011_173410_00014_dnzhq)
  compiled Code at target/run/greencard_analytics/models/intermediate/int_orders_enriched.sql
[0m17:34:10.157517 [info ] [MainThread]: 
[0m17:34:10.157732 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=2 TOTAL=7
[0m17:34:10.158569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a354d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88a37dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87fc4590>]}
[0m17:34:10.158777 [debug] [MainThread]: Flushing usage events
[0m17:36:47.068583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e14b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d9ff90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a23f110>]}


============================== 17:36:47.071253 | 59d773ac-8383-4cfc-8864-610b11a774c0 ==============================
[0m17:36:47.071253 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:36:47.071642 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/root/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'fail_fast': 'False', 'log_format': 'default', 'version_check': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/app/logs', 'invocation_command': 'dbt run'}
[0m17:36:47.196636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59d773ac-8383-4cfc-8864-610b11a774c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89da4210>]}
[0m17:36:47.256599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59d773ac-8383-4cfc-8864-610b11a774c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89855c50>]}
[0m17:36:47.256954 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m17:36:47.260944 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:36:47.276940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:36:47.277125 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:36:47.279749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59d773ac-8383-4cfc-8864-610b11a774c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89c52590>]}
[0m17:36:47.285134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59d773ac-8383-4cfc-8864-610b11a774c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff897dc9d0>]}
[0m17:36:47.285367 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m17:36:47.285605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d773ac-8383-4cfc-8864-610b11a774c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff899a3ed0>]}
[0m17:36:47.286589 [info ] [MainThread]: 
[0m17:36:47.287057 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:36:47.287827 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:36:47.288234 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:36:47.296175 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:36:47.296513 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:36:47.297700 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:36:47.297934 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:36:47.299065 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:36:47.299305 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:36:47.299546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:47.299762 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:36:47.299969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:47.300433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:47.342466 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:36:47.343903 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:36:47.344305 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:36:47.345549 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:36:47.348980 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:36:47.349694 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:36:47.350921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_analytics_staging)
[0m17:36:47.351330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_analytics_marts)
[0m17:36:47.351784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_analytics_intermediate)
[0m17:36:47.355781 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_staging"
[0m17:36:47.357840 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_marts"
[0m17:36:47.359776 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_intermediate"
[0m17:36:47.360059 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m17:36:47.360360 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m17:36:47.360686 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m17:36:47.360935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:47.361163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:47.361380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:47.501490 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:36:47.503230 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: ROLLBACK
[0m17:36:47.503444 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:36:47.504844 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:36:47.507334 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: Close
[0m17:36:47.508070 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: ROLLBACK
[0m17:36:47.508653 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: ROLLBACK
[0m17:36:47.509361 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: Close
[0m17:36:47.509597 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: Close
[0m17:36:47.511131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d773ac-8383-4cfc-8864-610b11a774c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896daa90>]}
[0m17:36:47.511462 [debug] [MainThread]: On master: COMMIT
[0m17:36:47.511815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:36:47.512061 [info ] [MainThread]: 
[0m17:36:47.513932 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m17:36:47.514122 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m17:36:47.514312 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m17:36:47.514509 [debug] [Thread-4 (]: Began running node model.greencard_analytics.stg_user_events
[0m17:36:47.514708 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m17:36:47.515040 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_staging.stg_products ..................... [RUN]
[0m17:36:47.515406 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_staging.stg_suppliers .................... [RUN]
[0m17:36:47.515732 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics_staging.stg_user_events .................. [RUN]
[0m17:36:47.516129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_intermediate, now model.greencard_analytics.stg_orders)
[0m17:36:47.516518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_staging, now model.greencard_analytics.stg_products)
[0m17:36:47.516882 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_marts, now model.greencard_analytics.stg_suppliers)
[0m17:36:47.517524 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.stg_user_events'
[0m17:36:47.517771 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m17:36:47.518013 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m17:36:47.518279 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m17:36:47.518514 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.stg_user_events
[0m17:36:47.519419 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m17:36:47.520275 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m17:36:47.521183 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m17:36:47.522660 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.stg_user_events"
[0m17:36:47.525103 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 17:36:47.518701 => 17:36:47.524985
[0m17:36:47.525371 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 17:36:47.519611 => 17:36:47.525210
[0m17:36:47.525675 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m17:36:47.525935 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 17:36:47.520468 => 17:36:47.525851
[0m17:36:47.526179 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (compile): 17:36:47.521888 => 17:36:47.526080
[0m17:36:47.526335 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m17:36:47.536654 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m17:36:47.536905 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m17:36:47.537144 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.stg_user_events
[0m17:36:47.539409 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m17:36:47.573777 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m17:36:47.575416 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.stg_user_events"
[0m17:36:47.575999 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m17:36:47.577200 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m17:36:47.577929 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m17:36:47.578152 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_orders"
  security definer
  as
    SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
  
[0m17:36:47.578451 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_products"
  security definer
  as
    SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
  
[0m17:36:47.578893 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.stg_user_events"
[0m17:36:47.579149 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_suppliers"
  security definer
  as
    SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
  
[0m17:36:47.579384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:47.579557 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:36:47.579779 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_user_events"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_user_events"
  security definer
  as
    SELECT
    event_id,
    user_id as customer_id,
    event_type,
    product_id,
    session_id
FROM lakehouse.raw_data.user_events
  
[0m17:36:47.579958 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:36:47.581485 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:36:47.601622 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20251011_173647_00027_dnzhq
[0m17:36:47.602765 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 13:6: Table 'lakehouse.raw_data.user_events' does not exist", query_id=20251011_173647_00027_dnzhq)
[0m17:36:47.604774 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (execute): 17:36:47.574125 => 17:36:47.603907
[0m17:36:47.605442 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: ROLLBACK
[0m17:36:47.606537 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: Close
[0m17:36:47.610979 [debug] [Thread-4 (]: Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 13:6: Table 'lakehouse.raw_data.user_events' does not exist", query_id=20251011_173647_00027_dnzhq)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m17:36:47.612504 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d773ac-8383-4cfc-8864-610b11a774c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894cec50>]}
[0m17:36:47.613803 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model analytics_staging.stg_user_events ......... [[31mERROR[0m in 0.10s]
[0m17:36:47.618344 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.stg_user_events
[0m17:36:47.633475 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:36:47.643001 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:36:47.643453 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:36:47.645264 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 17:36:47.526547 => 17:36:47.645165
[0m17:36:47.646515 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 17:36:47.537361 => 17:36:47.646427
[0m17:36:47.647638 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 17:36:47.540048 => 17:36:47.647559
[0m17:36:47.647913 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m17:36:47.648165 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m17:36:47.648375 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m17:36:47.648601 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m17:36:47.648821 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m17:36:47.649004 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m17:36:47.649559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d773ac-8383-4cfc-8864-610b11a774c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8983b9d0>]}
[0m17:36:47.650003 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d773ac-8383-4cfc-8864-610b11a774c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898d6b90>]}
[0m17:36:47.650437 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d773ac-8383-4cfc-8864-610b11a774c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896ad7d0>]}
[0m17:36:47.650770 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics_staging.stg_orders .................. [[32mSUCCESS[0m in 0.13s]
[0m17:36:47.651121 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_staging.stg_products ................ [[32mSUCCESS[0m in 0.13s]
[0m17:36:47.651669 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_staging.stg_suppliers ............... [[32mSUCCESS[0m in 0.13s]
[0m17:36:47.652090 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m17:36:47.652404 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m17:36:47.652667 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m17:36:47.653534 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m17:36:47.653700 [debug] [Thread-1 (]: Began running node model.greencard_analytics.int_orders_with_behavior
[0m17:36:47.653939 [info ] [Thread-4 (]: 5 of 7 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m17:36:47.654300 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_intermediate.int_orders_with_behavior ........... [[33mSKIP[0m]
[0m17:36:47.654826 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_user_events, now model.greencard_analytics.int_orders_enriched)
[0m17:36:47.655078 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.int_orders_with_behavior
[0m17:36:47.655349 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m17:36:47.655808 [debug] [Thread-3 (]: Began running node model.greencard_analytics.fct_orders
[0m17:36:47.657669 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m17:36:47.657948 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_marts.fct_orders ................................ [[33mSKIP[0m]
[0m17:36:47.658701 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.fct_orders
[0m17:36:47.659150 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 17:36:47.655884 => 17:36:47.659036
[0m17:36:47.659370 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m17:36:47.674039 [debug] [Thread-4 (]: Applying DROP to: "lakehouse"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
[0m17:36:47.675202 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m17:36:47.675443 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "lakehouse"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
[0m17:36:47.675669 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:36:47.684400 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20251011_173647_00028_dnzhq
[0m17:36:47.684772 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot drop table analytics_intermediate.int_orders_enriched__dbt_tmp", query_id=20251011_173647_00028_dnzhq)
[0m17:36:47.685146 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 17:36:47.659493 => 17:36:47.685012
[0m17:36:47.685372 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m17:36:47.687607 [debug] [Thread-4 (]: Database Error in model int_orders_enriched (models/intermediate/int_orders_enriched.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot drop table analytics_intermediate.int_orders_enriched__dbt_tmp", query_id=20251011_173647_00028_dnzhq)
[0m17:36:47.688004 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d773ac-8383-4cfc-8864-610b11a774c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff896ad390>]}
[0m17:36:47.688353 [error] [Thread-4 (]: 5 of 7 ERROR creating sql table model analytics_intermediate.int_orders_enriched  [[31mERROR[0m in 0.03s]
[0m17:36:47.688743 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m17:36:47.689793 [debug] [MainThread]: On master: COMMIT
[0m17:36:47.690150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:47.690352 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_products' was properly closed.
[0m17:36:47.690505 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m17:36:47.690643 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m17:36:47.690770 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m17:36:47.690950 [info ] [MainThread]: 
[0m17:36:47.691169 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m17:36:47.691823 [debug] [MainThread]: Command end result
[0m17:36:47.697509 [info ] [MainThread]: 
[0m17:36:47.697736 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:36:47.697956 [info ] [MainThread]: 
[0m17:36:47.698153 [error] [MainThread]:   Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 13:6: Table 'lakehouse.raw_data.user_events' does not exist", query_id=20251011_173647_00027_dnzhq)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m17:36:47.698353 [info ] [MainThread]: 
[0m17:36:47.698542 [error] [MainThread]:   Database Error in model int_orders_enriched (models/intermediate/int_orders_enriched.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot drop table analytics_intermediate.int_orders_enriched__dbt_tmp", query_id=20251011_173647_00028_dnzhq)
[0m17:36:47.698752 [info ] [MainThread]: 
[0m17:36:47.698934 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=2 TOTAL=7
[0m17:36:47.699456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3d4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d9fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89d9fc90>]}
[0m17:36:47.699675 [debug] [MainThread]: Flushing usage events
[0m17:38:21.548171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7adcc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a67f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7adc9d0>]}


============================== 17:38:21.550638 | 06b1b7ac-e1e9-4396-9259-e6ac57663bb8 ==============================
[0m17:38:21.550638 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:38:21.551028 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/app/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_format': 'default', 'profiles_dir': '/root/.dbt'}
[0m17:38:21.668498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06b1b7ac-e1e9-4396-9259-e6ac57663bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7708310>]}
[0m17:38:21.728597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06b1b7ac-e1e9-4396-9259-e6ac57663bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ab5c50>]}
[0m17:38:21.729020 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m17:38:21.733589 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:38:21.750532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:21.750735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:21.753376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06b1b7ac-e1e9-4396-9259-e6ac57663bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a6c0d0>]}
[0m17:38:21.759484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06b1b7ac-e1e9-4396-9259-e6ac57663bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7635fd0>]}
[0m17:38:21.759685 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m17:38:21.759891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06b1b7ac-e1e9-4396-9259-e6ac57663bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb74ca610>]}
[0m17:38:21.760814 [info ] [MainThread]: 
[0m17:38:21.761261 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:38:21.762012 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:38:21.762428 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:38:21.768648 [debug] [ThreadPool]: Acquiring new trino connection 'list_lakehouse'
[0m17:38:21.770350 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:38:21.771533 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:38:21.772672 [debug] [ThreadPool]: Using trino connection "list_lakehouse"
[0m17:38:21.772897 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:38:21.773096 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:38:21.773282 [debug] [ThreadPool]: On list_lakehouse: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse"} */

    select schema_name
    from "lakehouse".INFORMATION_SCHEMA.schemata
[0m17:38:21.773456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:21.773619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:21.773806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:21.813738 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:38:21.816502 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:38:21.817107 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:38:21.819109 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:38:21.819409 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:38:21.820458 [debug] [ThreadPool]: On list_lakehouse: Close
[0m17:38:21.821625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_analytics_marts)
[0m17:38:21.822023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_analytics_intermediate)
[0m17:38:21.822415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lakehouse, now list_lakehouse_analytics_staging)
[0m17:38:21.826318 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_marts"
[0m17:38:21.828406 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_intermediate"
[0m17:38:21.830248 [debug] [ThreadPool]: Using trino connection "list_lakehouse_analytics_staging"
[0m17:38:21.830523 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m17:38:21.830770 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m17:38:21.831045 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_lakehouse_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "lakehouse".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'lakehouse'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m17:38:21.831295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:21.831506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:21.831742 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:22.015010 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:38:22.015467 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:38:22.017989 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: ROLLBACK
[0m17:38:22.020351 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: ROLLBACK
[0m17:38:22.020822 [debug] [ThreadPool]: On list_lakehouse_analytics_marts: Close
[0m17:38:22.021389 [debug] [ThreadPool]: On list_lakehouse_analytics_intermediate: Close
[0m17:38:22.022035 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:38:22.024510 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: ROLLBACK
[0m17:38:22.024994 [debug] [ThreadPool]: On list_lakehouse_analytics_staging: Close
[0m17:38:22.026799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06b1b7ac-e1e9-4396-9259-e6ac57663bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7652410>]}
[0m17:38:22.027255 [debug] [MainThread]: On master: COMMIT
[0m17:38:22.027641 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:38:22.027894 [info ] [MainThread]: 
[0m17:38:22.029954 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m17:38:22.030138 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m17:38:22.030312 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m17:38:22.030508 [debug] [Thread-4 (]: Began running node model.greencard_analytics.stg_user_events
[0m17:38:22.030732 [info ] [Thread-1 (]: 1 of 7 START sql view model analytics_staging.stg_orders ....................... [RUN]
[0m17:38:22.031040 [info ] [Thread-2 (]: 2 of 7 START sql view model analytics_staging.stg_products ..................... [RUN]
[0m17:38:22.031388 [info ] [Thread-3 (]: 3 of 7 START sql view model analytics_staging.stg_suppliers .................... [RUN]
[0m17:38:22.031791 [info ] [Thread-4 (]: 4 of 7 START sql view model analytics_staging.stg_user_events .................. [RUN]
[0m17:38:22.032270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_staging, now model.greencard_analytics.stg_orders)
[0m17:38:22.032724 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_intermediate, now model.greencard_analytics.stg_products)
[0m17:38:22.033136 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_lakehouse_analytics_marts, now model.greencard_analytics.stg_suppliers)
[0m17:38:22.034280 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.stg_user_events'
[0m17:38:22.037580 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.stg_user_events
[0m17:38:22.041075 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.stg_user_events"
[0m17:38:22.036805 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m17:38:22.035110 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m17:38:22.044711 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m17:38:22.043094 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m17:38:22.036011 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m17:38:22.045181 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (compile): 17:38:22.039565 => 17:38:22.044970
[0m17:38:22.048965 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m17:38:22.050822 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 17:38:22.043646 => 17:38:22.050708
[0m17:38:22.052019 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.stg_user_events
[0m17:38:22.053129 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m17:38:22.077268 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.stg_user_events"
[0m17:38:22.077579 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 17:38:22.047278 => 17:38:22.077463
[0m17:38:22.079819 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m17:38:22.080035 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 17:38:22.041818 => 17:38:22.079921
[0m17:38:22.080530 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m17:38:22.081129 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.stg_user_events"
[0m17:38:22.081463 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m17:38:22.119274 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m17:38:22.119643 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_user_events"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_user_events"
  security definer
  as
    SELECT
    event_id,
    user_id as customer_id,
    event_type,
    product_id,
    session_id
FROM lakehouse.raw_data.user_events
  
[0m17:38:22.120392 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m17:38:22.121715 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m17:38:22.122276 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:38:22.122544 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_orders"
  security definer
  as
    SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
  
[0m17:38:22.123187 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m17:38:22.124433 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m17:38:22.124580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:22.125016 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_products"
  security definer
  as
    SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
  
[0m17:38:22.125259 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  create or replace view
    "lakehouse"."analytics_staging"."stg_suppliers"
  security definer
  as
    SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
  
[0m17:38:22.126029 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:38:22.126283 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:38:22.136247 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20251011_173822_00036_dnzhq
[0m17:38:22.137129 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 13:6: Table 'lakehouse.raw_data.user_events' does not exist", query_id=20251011_173822_00036_dnzhq)
[0m17:38:22.138412 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (execute): 17:38:22.053839 => 17:38:22.138177
[0m17:38:22.140651 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: ROLLBACK
[0m17:38:22.142152 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: Close
[0m17:38:22.145920 [debug] [Thread-4 (]: Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 13:6: Table 'lakehouse.raw_data.user_events' does not exist", query_id=20251011_173822_00036_dnzhq)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m17:38:22.146748 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b1b7ac-e1e9-4396-9259-e6ac57663bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7348d10>]}
[0m17:38:22.148611 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model analytics_staging.stg_user_events ......... [[31mERROR[0m in 0.11s]
[0m17:38:22.150622 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.stg_user_events
[0m17:38:22.160497 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:38:22.168057 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:38:22.168418 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:38:22.170633 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 17:38:22.120498 => 17:38:22.170544
[0m17:38:22.171733 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 17:38:22.081640 => 17:38:22.171647
[0m17:38:22.173060 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 17:38:22.077665 => 17:38:22.172986
[0m17:38:22.173348 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m17:38:22.173602 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m17:38:22.173868 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m17:38:22.174119 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m17:38:22.174334 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m17:38:22.174616 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m17:38:22.175179 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b1b7ac-e1e9-4396-9259-e6ac57663bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb771a350>]}
[0m17:38:22.175597 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b1b7ac-e1e9-4396-9259-e6ac57663bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb75429d0>]}
[0m17:38:22.176039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b1b7ac-e1e9-4396-9259-e6ac57663bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7cd3890>]}
[0m17:38:22.176364 [info ] [Thread-3 (]: 3 of 7 OK created sql view model analytics_staging.stg_suppliers ............... [[32mSUCCESS[0m in 0.14s]
[0m17:38:22.176745 [info ] [Thread-2 (]: 2 of 7 OK created sql view model analytics_staging.stg_products ................ [[32mSUCCESS[0m in 0.14s]
[0m17:38:22.177154 [info ] [Thread-1 (]: 1 of 7 OK created sql view model analytics_staging.stg_orders .................. [[32mSUCCESS[0m in 0.14s]
[0m17:38:22.177510 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m17:38:22.177809 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m17:38:22.178127 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m17:38:22.178964 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m17:38:22.179200 [debug] [Thread-3 (]: Began running node model.greencard_analytics.int_orders_with_behavior
[0m17:38:22.179405 [info ] [Thread-4 (]: 5 of 7 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m17:38:22.179773 [info ] [Thread-3 (]: 6 of 7 SKIP relation analytics_intermediate.int_orders_with_behavior ........... [[33mSKIP[0m]
[0m17:38:22.180241 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_user_events, now model.greencard_analytics.int_orders_enriched)
[0m17:38:22.180528 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.int_orders_with_behavior
[0m17:38:22.180790 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m17:38:22.181218 [debug] [Thread-1 (]: Began running node model.greencard_analytics.fct_orders
[0m17:38:22.182903 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m17:38:22.183197 [info ] [Thread-1 (]: 7 of 7 SKIP relation analytics_marts.fct_orders ................................ [[33mSKIP[0m]
[0m17:38:22.183862 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.fct_orders
[0m17:38:22.184248 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 17:38:22.181385 => 17:38:22.184151
[0m17:38:22.184464 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m17:38:22.198266 [debug] [Thread-4 (]: Applying DROP to: "lakehouse"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
[0m17:38:22.199587 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m17:38:22.199806 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "lakehouse"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
[0m17:38:22.200005 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:38:22.206632 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20251011_173822_00040_dnzhq
[0m17:38:22.206951 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot drop table analytics_intermediate.int_orders_enriched__dbt_tmp", query_id=20251011_173822_00040_dnzhq)
[0m17:38:22.207332 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 17:38:22.184601 => 17:38:22.207227
[0m17:38:22.207538 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m17:38:22.209593 [debug] [Thread-4 (]: Database Error in model int_orders_enriched (models/intermediate/int_orders_enriched.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot drop table analytics_intermediate.int_orders_enriched__dbt_tmp", query_id=20251011_173822_00040_dnzhq)
[0m17:38:22.209933 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b1b7ac-e1e9-4396-9259-e6ac57663bb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7637a10>]}
[0m17:38:22.210245 [error] [Thread-4 (]: 5 of 7 ERROR creating sql table model analytics_intermediate.int_orders_enriched  [[31mERROR[0m in 0.03s]
[0m17:38:22.210618 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m17:38:22.211610 [debug] [MainThread]: On master: COMMIT
[0m17:38:22.211961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:22.212112 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m17:38:22.212247 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m17:38:22.212379 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_products' was properly closed.
[0m17:38:22.212505 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m17:38:22.212683 [info ] [MainThread]: 
[0m17:38:22.212935 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m17:38:22.213499 [debug] [MainThread]: Command end result
[0m17:38:22.219606 [info ] [MainThread]: 
[0m17:38:22.219867 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:38:22.220097 [info ] [MainThread]: 
[0m17:38:22.220323 [error] [MainThread]:   Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 13:6: Table 'lakehouse.raw_data.user_events' does not exist", query_id=20251011_173822_00036_dnzhq)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m17:38:22.220522 [info ] [MainThread]: 
[0m17:38:22.220723 [error] [MainThread]:   Database Error in model int_orders_enriched (models/intermediate/int_orders_enriched.sql)
  TrinoUserError(type=USER_ERROR, name=PERMISSION_DENIED, message="Access Denied: Cannot drop table analytics_intermediate.int_orders_enriched__dbt_tmp", query_id=20251011_173822_00040_dnzhq)
[0m17:38:22.220927 [info ] [MainThread]: 
[0m17:38:22.221115 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=2 TOTAL=7
[0m17:38:22.221599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd064ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd065150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb883fe90>]}
[0m17:38:22.221794 [debug] [MainThread]: Flushing usage events
[0m08:00:34.343850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c30c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c73f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c2a3510>]}


============================== 08:00:34.352564 | f0e400b9-0e8b-4b37-957c-186d6247c20b ==============================
[0m08:00:34.352564 [info ] [MainThread]: Running with dbt=1.7.4
[0m08:00:34.352989 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'profiles_dir': '/root/.dbt', 'printer_width': '80', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'partial_parse': 'True', 'write_json': 'True', 'debug': 'False', 'log_path': '/usr/app/logs'}
[0m08:00:34.485009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be491d0>]}
[0m08:00:34.548355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf13390>]}
[0m08:00:34.548795 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m08:00:34.553073 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m08:00:34.559626 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:00:34.559906 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:00:34.560188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bd63fd0>]}
[0m08:00:35.069640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be14e50>]}
[0m08:00:35.076715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af1ac90>]}
[0m08:00:35.077122 [info ] [MainThread]: Found 7 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m08:00:35.077572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc6ca10>]}
[0m08:00:35.078697 [info ] [MainThread]: 
[0m08:00:35.079251 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m08:00:35.080060 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:00:35.080464 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:00:35.080865 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:00:35.089703 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:00:35.091050 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:00:35.092264 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:00:35.092539 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:00:35.092825 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:00:35.093062 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:00:35.093279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:35.093473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:35.093718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:35.207145 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:35.208230 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:35.209061 [debug] [ThreadPool]: On list_postgres: Close
[0m08:00:35.209384 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:35.210088 [debug] [ThreadPool]: On list_postgres: Close
[0m08:00:35.211269 [debug] [ThreadPool]: On list_postgres: Close
[0m08:00:35.215375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m08:00:35.217566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m08:00:35.218127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m08:00:35.222587 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m08:00:35.224665 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m08:00:35.226602 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m08:00:35.226913 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m08:00:35.227187 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m08:00:35.227432 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m08:00:35.227653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:35.227852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:35.228088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:35.501924 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:35.502280 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:35.503096 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:00:35.503805 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m08:00:35.504143 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:35.505209 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:00:35.505503 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m08:00:35.506265 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m08:00:35.507947 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m08:00:35.508680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bcdec10>]}
[0m08:00:35.508989 [debug] [MainThread]: On master: COMMIT
[0m08:00:35.509372 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:00:35.509640 [info ] [MainThread]: 
[0m08:00:35.517237 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m08:00:35.517439 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m08:00:35.517600 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m08:00:35.517771 [debug] [Thread-4 (]: Began running node model.greencard_analytics.stg_user_events
[0m08:00:35.517991 [info ] [Thread-1 (]: 1 of 7 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m08:00:35.518290 [info ] [Thread-2 (]: 2 of 7 START sql table model analytics_staging.stg_products .................... [RUN]
[0m08:00:35.518627 [info ] [Thread-3 (]: 3 of 7 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m08:00:35.518966 [info ] [Thread-4 (]: 4 of 7 START sql table model analytics_staging.stg_user_events ................. [RUN]
[0m08:00:35.519368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_orders)
[0m08:00:35.519746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_products)
[0m08:00:35.520103 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_suppliers)
[0m08:00:35.520503 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.stg_user_events'
[0m08:00:35.520727 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m08:00:35.520938 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m08:00:35.521128 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m08:00:35.521311 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.stg_user_events
[0m08:00:35.522290 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m08:00:35.523062 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m08:00:35.523866 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m08:00:35.525375 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.stg_user_events"
[0m08:00:35.527161 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 08:00:35.521438 => 08:00:35.527066
[0m08:00:35.527367 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 08:00:35.522454 => 08:00:35.527281
[0m08:00:35.527512 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m08:00:35.527790 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 08:00:35.523227 => 08:00:35.527625
[0m08:00:35.527951 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (compile): 08:00:35.524017 => 08:00:35.527874
[0m08:00:35.528124 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m08:00:35.546337 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m08:00:35.546574 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m08:00:35.546867 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.stg_user_events
[0m08:00:35.548766 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m08:00:35.550840 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m08:00:35.552759 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.stg_user_events"
[0m08:00:35.553596 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:00:35.554457 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:00:35.554709 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "postgres"."analytics_staging"."stg_orders__dbt_tmp"
      
      
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
    )
[0m08:00:35.555246 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:00:35.555491 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "postgres"."analytics_staging"."stg_products__dbt_tmp"
      
      
    as (
      SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m08:00:35.555956 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.stg_user_events"
[0m08:00:35.556143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:35.556344 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      
    as (
      SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m08:00:35.556541 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:00:35.556737 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_user_events"} */

  
    

    create table "postgres"."analytics_staging"."stg_user_events__dbt_tmp"
      
      
    as (
      SELECT
    event_id,
    user_id as customer_id,
    event_type,
    product_id,
    session_id
FROM lakehouse.raw_data.user_events
    )
[0m08:00:35.557514 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:00:35.558512 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:00:35.782156 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:35.787785 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:00:35.788122 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders" rename to "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m08:00:35.812077 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:35.815909 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:00:35.816476 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders__dbt_tmp" rename to "postgres"."analytics_staging"."stg_orders"
[0m08:00:35.847729 [debug] [Thread-4 (]: Trino adapter: Trino query id: 20251012_080035_00011_n6gxu
[0m08:00:35.848017 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:35.848322 [debug] [Thread-4 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 16:6: Table 'lakehouse.raw_data.user_events' does not exist", query_id=20251012_080035_00011_n6gxu)
[0m08:00:35.852056 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m08:00:35.852931 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.stg_user_events (execute): 08:00:35.551066 => 08:00:35.852822
[0m08:00:35.854140 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:00:35.854510 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: ROLLBACK
[0m08:00:35.854846 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m08:00:35.855105 [debug] [Thread-4 (]: On model.greencard_analytics.stg_user_events: Close
[0m08:00:35.866792 [debug] [Thread-4 (]: Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 16:6: Table 'lakehouse.raw_data.user_events' does not exist", query_id=20251012_080035_00011_n6gxu)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m08:00:35.867734 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b78e310>]}
[0m08:00:35.868350 [error] [Thread-4 (]: 4 of 7 ERROR creating sql table model analytics_staging.stg_user_events ........ [[31mERROR[0m in 0.35s]
[0m08:00:35.868898 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.stg_user_events
[0m08:00:35.872106 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:35.881609 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 08:00:35.528246 => 08:00:35.881513
[0m08:00:35.882015 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m08:00:35.882461 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m08:00:35.883546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3a1f10>]}
[0m08:00:35.884025 [info ] [Thread-1 (]: 1 of 7 OK created sql table model analytics_staging.stg_orders ................. [[32mSUCCESS[0m in 0.36s]
[0m08:00:35.884706 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m08:00:36.003609 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.004000 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.007310 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:00:36.008915 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:00:36.009194 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers" rename to "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m08:00:36.009455 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products" rename to "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m08:00:36.025280 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.025784 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.027567 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:00:36.029079 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:00:36.029309 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products__dbt_tmp" rename to "postgres"."analytics_staging"."stg_products"
[0m08:00:36.029551 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "postgres"."analytics_staging"."stg_suppliers"
[0m08:00:36.045998 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.047935 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m08:00:36.048393 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.048860 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:00:36.050356 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m08:00:36.050594 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m08:00:36.051203 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:00:36.052001 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m08:00:36.067503 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.069360 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 08:00:35.547061 => 08:00:36.069262
[0m08:00:36.070196 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m08:00:36.070608 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m08:00:36.071222 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7afddc50>]}
[0m08:00:36.072025 [info ] [Thread-2 (]: 2 of 7 OK created sql table model analytics_staging.stg_products ............... [[32mSUCCESS[0m in 0.55s]
[0m08:00:36.072472 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m08:00:36.072920 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.074249 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 08:00:35.549306 => 08:00:36.074163
[0m08:00:36.074452 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m08:00:36.074654 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m08:00:36.075110 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b3f4990>]}
[0m08:00:36.075427 [info ] [Thread-3 (]: 3 of 7 OK created sql table model analytics_staging.stg_suppliers .............. [[32mSUCCESS[0m in 0.56s]
[0m08:00:36.075774 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m08:00:36.076302 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m08:00:36.076576 [debug] [Thread-1 (]: Began running node model.greencard_analytics.int_orders_with_behavior
[0m08:00:36.076796 [info ] [Thread-4 (]: 5 of 7 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m08:00:36.077249 [info ] [Thread-1 (]: 6 of 7 SKIP relation analytics_intermediate.int_orders_with_behavior ........... [[33mSKIP[0m]
[0m08:00:36.077717 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_user_events, now model.greencard_analytics.int_orders_enriched)
[0m08:00:36.078015 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.int_orders_with_behavior
[0m08:00:36.078320 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m08:00:36.078695 [debug] [Thread-3 (]: Began running node model.greencard_analytics.fct_orders
[0m08:00:36.080587 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m08:00:36.080837 [info ] [Thread-3 (]: 7 of 7 SKIP relation analytics_marts.fct_orders ................................ [[33mSKIP[0m]
[0m08:00:36.081322 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.fct_orders
[0m08:00:36.081910 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 08:00:36.078826 => 08:00:36.081824
[0m08:00:36.082096 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m08:00:36.083856 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m08:00:36.086132 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:00:36.086371 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m08:00:36.086637 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:00:36.267854 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.269798 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:00:36.270071 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched" rename to "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:00:36.283755 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.285642 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:00:36.285901 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_enriched"
[0m08:00:36.297681 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.300785 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:00:36.301276 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:00:36.301504 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:00:36.314389 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:00:36.315702 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 08:00:36.082223 => 08:00:36.315594
[0m08:00:36.315946 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m08:00:36.316145 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m08:00:36.316593 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0e400b9-0e8b-4b37-957c-186d6247c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bebe590>]}
[0m08:00:36.316917 [info ] [Thread-4 (]: 5 of 7 OK created sql table model analytics_intermediate.int_orders_enriched ... [[32mSUCCESS[0m in 0.24s]
[0m08:00:36.317279 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m08:00:36.318276 [debug] [MainThread]: On master: COMMIT
[0m08:00:36.318571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:00:36.318702 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_products' was properly closed.
[0m08:00:36.318819 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m08:00:36.318935 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m08:00:36.319044 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m08:00:36.319195 [info ] [MainThread]: 
[0m08:00:36.319500 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m08:00:36.320095 [debug] [MainThread]: Command end result
[0m08:00:36.325248 [info ] [MainThread]: 
[0m08:00:36.325515 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:00:36.325719 [info ] [MainThread]: 
[0m08:00:36.325952 [error] [MainThread]:   Database Error in model stg_user_events (models/staging/stg_user_events.sql)
  TrinoUserError(type=USER_ERROR, name=TABLE_NOT_FOUND, message="line 16:6: Table 'lakehouse.raw_data.user_events' does not exist", query_id=20251012_080035_00011_n6gxu)
  compiled Code at target/run/greencard_analytics/models/staging/stg_user_events.sql
[0m08:00:36.326167 [info ] [MainThread]: 
[0m08:00:36.326416 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m08:00:36.327440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c31e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c31ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818b8310>]}
[0m08:00:36.327656 [debug] [MainThread]: Flushing usage events
[0m08:07:07.849369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c10990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8403f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c10ad0>]}


============================== 08:07:07.851269 | d24f7c58-c4a2-4903-b1dc-0d8f3e06917b ==============================
[0m08:07:07.851269 [info ] [MainThread]: Running with dbt=1.7.4
[0m08:07:07.851662 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'quiet': 'False', 'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'static_parser': 'True'}
[0m08:07:07.969285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83825c50>]}
[0m08:07:08.028523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a52550>]}
[0m08:07:08.028865 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m08:07:08.033557 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m08:07:08.052929 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m08:07:08.053256 [debug] [MainThread]: Partial parsing: deleted file: greencard_analytics://models/staging/stg_user_events.sql
[0m08:07:08.053453 [debug] [MainThread]: Partial parsing: updated file: greencard_analytics://models/intermediate/int_orders_with_behavior.sql
[0m08:07:08.144007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8342b110>]}
[0m08:07:08.175446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff835f9010>]}
[0m08:07:08.175789 [info ] [MainThread]: Found 6 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m08:07:08.176056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83473b10>]}
[0m08:07:08.176981 [info ] [MainThread]: 
[0m08:07:08.177467 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m08:07:08.178236 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:07:08.178669 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:07:08.184405 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:07:08.186908 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:07:08.188155 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:07:08.189324 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:07:08.189559 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:07:08.189791 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:07:08.190022 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:07:08.190241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:08.190450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:08.190652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:08.418714 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:08.419228 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:08.419568 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:08.420240 [debug] [ThreadPool]: On list_postgres: Close
[0m08:07:08.420925 [debug] [ThreadPool]: On list_postgres: Close
[0m08:07:08.421514 [debug] [ThreadPool]: On list_postgres: Close
[0m08:07:08.423432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m08:07:08.423829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m08:07:08.427841 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m08:07:08.428148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m08:07:08.430208 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m08:07:08.430473 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m08:07:08.432973 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m08:07:08.433203 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m08:07:08.433471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:08.433697 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m08:07:08.433883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:08.434664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:08.777887 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:08.778910 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:08.779311 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:08.780023 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m08:07:08.780835 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m08:07:08.781503 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:07:08.781748 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m08:07:08.781985 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m08:07:08.782188 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:07:08.784193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83808110>]}
[0m08:07:08.784522 [debug] [MainThread]: On master: COMMIT
[0m08:07:08.784920 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:07:08.785314 [info ] [MainThread]: 
[0m08:07:08.787076 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m08:07:08.787255 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m08:07:08.787419 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m08:07:08.787678 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m08:07:08.788042 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_products .................... [RUN]
[0m08:07:08.788459 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m08:07:08.788950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_orders)
[0m08:07:08.789388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_products)
[0m08:07:08.789743 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_suppliers)
[0m08:07:08.789945 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m08:07:08.790206 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m08:07:08.790408 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m08:07:08.791555 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m08:07:08.792450 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m08:07:08.793284 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m08:07:08.794930 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 08:07:08.790550 => 08:07:08.794831
[0m08:07:08.795307 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 08:07:08.791747 => 08:07:08.795219
[0m08:07:08.795449 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m08:07:08.795817 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 08:07:08.792636 => 08:07:08.795732
[0m08:07:08.795951 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m08:07:08.815132 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m08:07:08.815434 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m08:07:08.817436 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m08:07:08.819390 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m08:07:08.820317 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:07:08.820718 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "postgres"."analytics_staging"."stg_orders__dbt_tmp"
      
      
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
    )
[0m08:07:08.821196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:08.821665 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:07:08.822879 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:07:08.823059 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "postgres"."analytics_staging"."stg_products__dbt_tmp"
      
      
    as (
      SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m08:07:08.823427 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      
    as (
      SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m08:07:08.823661 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:07:08.823902 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:07:09.132334 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.136353 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:07:09.137048 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders" rename to "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m08:07:09.171502 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.173820 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:07:09.174146 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders__dbt_tmp" rename to "postgres"."analytics_staging"."stg_orders"
[0m08:07:09.191762 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.194943 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:07:09.198367 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers" rename to "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m08:07:09.197979 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.204229 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m08:07:09.207156 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:07:09.207740 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.207958 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m08:07:09.210395 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:07:09.212184 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products" rename to "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m08:07:09.225342 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.228372 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:07:09.229462 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "postgres"."analytics_staging"."stg_suppliers"
[0m08:07:09.229260 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.241712 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 08:07:08.796100 => 08:07:09.241583
[0m08:07:09.243734 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.244199 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m08:07:09.247249 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:07:09.249033 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m08:07:09.249570 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products__dbt_tmp" rename to "postgres"."analytics_staging"."stg_products"
[0m08:07:09.250537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fdbe10>]}
[0m08:07:09.253597 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics_staging.stg_orders ................. [[32mSUCCESS[0m in 0.46s]
[0m08:07:09.254317 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m08:07:09.258245 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.260743 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m08:07:09.262161 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:07:09.262463 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m08:07:09.277186 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.281455 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m08:07:09.283803 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:07:09.284962 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.285320 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m08:07:09.286637 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 08:07:08.817836 => 08:07:09.286547
[0m08:07:09.287575 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m08:07:09.287880 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m08:07:09.289951 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b0b1d0>]}
[0m08:07:09.290467 [info ] [Thread-3 (]: 3 of 6 OK created sql table model analytics_staging.stg_suppliers .............. [[32mSUCCESS[0m in 0.50s]
[0m08:07:09.291577 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m08:07:09.304730 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.306197 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 08:07:08.815663 => 08:07:09.306097
[0m08:07:09.306473 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m08:07:09.306690 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m08:07:09.307211 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8352f990>]}
[0m08:07:09.307550 [info ] [Thread-2 (]: 2 of 6 OK created sql table model analytics_staging.stg_products ............... [[32mSUCCESS[0m in 0.52s]
[0m08:07:09.308039 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m08:07:09.308677 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m08:07:09.308846 [debug] [Thread-1 (]: Began running node model.greencard_analytics.int_orders_with_behavior
[0m08:07:09.309135 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m08:07:09.309503 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics_intermediate.int_orders_with_behavior ... [RUN]
[0m08:07:09.310094 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.int_orders_enriched'
[0m08:07:09.310477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_orders, now model.greencard_analytics.int_orders_with_behavior)
[0m08:07:09.310716 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m08:07:09.310942 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.int_orders_with_behavior
[0m08:07:09.313061 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m08:07:09.314772 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:09.316289 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 08:07:09.311132 => 08:07:09.316193
[0m08:07:09.316468 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_with_behavior (compile): 08:07:09.313326 => 08:07:09.316373
[0m08:07:09.316707 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m08:07:09.317002 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.int_orders_with_behavior
[0m08:07:09.320227 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m08:07:09.322033 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:09.324440 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:07:09.324683 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m08:07:09.325659 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:09.325852 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:07:09.326088 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_tmp"
      
      
    as (
      

WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    p.product_name,
    p.category,
    s.supplier_name,
    s.country,
    s.sustainability_score

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m08:07:09.327053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:09.611350 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.614831 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:09.615572 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */
alter table "postgres"."analytics_intermediate"."int_orders_with_behavior" rename to "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m08:07:09.624814 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.627950 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:07:09.630549 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched" rename to "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:07:09.637668 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.640899 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:09.641595 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */
alter table "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_with_behavior"
[0m08:07:09.649536 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.652439 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:07:09.652795 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_enriched"
[0m08:07:09.660980 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.664110 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m08:07:09.666574 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:09.666936 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m08:07:09.676207 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.678588 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:07:09.679175 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:07:09.679713 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:07:09.685256 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.687654 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_with_behavior (execute): 08:07:09.320434 => 08:07:09.687560
[0m08:07:09.688674 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: ROLLBACK
[0m08:07:09.689341 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: Close
[0m08:07:09.690401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86ce5450>]}
[0m08:07:09.690864 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics_intermediate.int_orders_with_behavior  [[32mSUCCESS[0m in 0.38s]
[0m08:07:09.691395 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.int_orders_with_behavior
[0m08:07:09.691925 [debug] [Thread-2 (]: Began running node model.greencard_analytics.fct_orders
[0m08:07:09.692378 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics_marts.fct_orders ........................ [RUN]
[0m08:07:09.693232 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_products, now model.greencard_analytics.fct_orders)
[0m08:07:09.693524 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.fct_orders
[0m08:07:09.695512 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.fct_orders"
[0m08:07:09.696649 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:09.697877 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 08:07:09.317203 => 08:07:09.697792
[0m08:07:09.698159 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m08:07:09.698354 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (compile): 08:07:09.693726 => 08:07:09.698270
[0m08:07:09.698532 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m08:07:09.698752 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.fct_orders
[0m08:07:09.699255 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82fe0f50>]}
[0m08:07:09.701141 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.fct_orders"
[0m08:07:09.701504 [info ] [Thread-4 (]: 4 of 6 OK created sql table model analytics_intermediate.int_orders_enriched ... [[32mSUCCESS[0m in 0.39s]
[0m08:07:09.702222 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m08:07:09.703372 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m08:07:09.703600 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

  
    

    create table "postgres"."analytics_marts"."fct_orders__dbt_tmp"
      
      
    as (
      

SELECT
    order_id,
    customer_id,
    order_date,
    amount as revenue,
    product_name,
    category as product_category,
    supplier_name,
    country as supplier_country,
    sustainability_score,
    customer_page_views,
    customer_cart_adds,
    customer_purchases,
    
    EXTRACT(YEAR FROM order_date) as order_year,
    EXTRACT(MONTH FROM order_date) as order_month,
    EXTRACT(QUARTER FROM order_date) as order_quarter

FROM "postgres"."analytics_intermediate"."int_orders_with_behavior"
    )
[0m08:07:09.703808 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:07:09.727314 [debug] [Thread-2 (]: Trino adapter: Trino query id: 20251012_080709_00027_nqxzy
[0m08:07:09.727762 [debug] [Thread-2 (]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 22:5: Column 'customer_page_views' cannot be resolved", query_id=20251012_080709_00027_nqxzy)
[0m08:07:09.728110 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (execute): 08:07:09.699397 => 08:07:09.728015
[0m08:07:09.728413 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: ROLLBACK
[0m08:07:09.728623 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: Close
[0m08:07:09.732535 [debug] [Thread-2 (]: Database Error in model fct_orders (models/marts/fct_orders.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 22:5: Column 'customer_page_views' cannot be resolved", query_id=20251012_080709_00027_nqxzy)
  compiled Code at target/run/greencard_analytics/models/marts/fct_orders.sql
[0m08:07:09.733011 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd24f7c58-c4a2-4903-b1dc-0d8f3e06917b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f14350>]}
[0m08:07:09.733475 [error] [Thread-2 (]: 6 of 6 ERROR creating sql table model analytics_marts.fct_orders ............... [[31mERROR[0m in 0.04s]
[0m08:07:09.733904 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.fct_orders
[0m08:07:09.735360 [debug] [MainThread]: On master: COMMIT
[0m08:07:09.735771 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:09.735959 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_with_behavior' was properly closed.
[0m08:07:09.736161 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m08:07:09.736328 [debug] [MainThread]: Connection 'model.greencard_analytics.fct_orders' was properly closed.
[0m08:07:09.736571 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m08:07:09.736804 [info ] [MainThread]: 
[0m08:07:09.737215 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m08:07:09.738122 [debug] [MainThread]: Command end result
[0m08:07:09.744551 [info ] [MainThread]: 
[0m08:07:09.745020 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:07:09.745429 [info ] [MainThread]: 
[0m08:07:09.745736 [error] [MainThread]:   Database Error in model fct_orders (models/marts/fct_orders.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 22:5: Column 'customer_page_views' cannot be resolved", query_id=20251012_080709_00027_nqxzy)
  compiled Code at target/run/greencard_analytics/models/marts/fct_orders.sql
[0m08:07:09.746001 [info ] [MainThread]: 
[0m08:07:09.746420 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:07:09.747082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a2fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff841c0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891b4c10>]}
[0m08:07:09.747379 [debug] [MainThread]: Flushing usage events
[0m08:07:56.631409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa660ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6a3f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa660c950>]}


============================== 08:07:56.633317 | b36f059f-19e2-4859-aaf6-9ba6886fa43a ==============================
[0m08:07:56.633317 [info ] [MainThread]: Running with dbt=1.7.4
[0m08:07:56.633661 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'log_format': 'default', 'use_colors': 'True', 'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'partial_parse': 'True', 'introspect': 'True'}
[0m08:07:56.750816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6623890>]}
[0m08:07:56.812131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65d51d0>]}
[0m08:07:56.812514 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m08:07:56.816614 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m08:07:56.831672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:07:56.831959 [debug] [MainThread]: Partial parsing: updated file: greencard_analytics://models/marts/fct_orders.sql
[0m08:07:56.925335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5fd0510>]}
[0m08:07:56.959204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5ee44d0>]}
[0m08:07:56.959534 [info ] [MainThread]: Found 6 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m08:07:56.959780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa605a6d0>]}
[0m08:07:56.960773 [info ] [MainThread]: 
[0m08:07:56.961381 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m08:07:56.962475 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:07:56.962935 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:07:56.969050 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m08:07:56.971302 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:07:56.972534 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:07:56.973729 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m08:07:56.973916 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:07:56.974119 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:07:56.974318 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m08:07:56.974478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:56.974668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:56.974875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:57.037433 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.037796 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.038156 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.038842 [debug] [ThreadPool]: On list_postgres: Close
[0m08:07:57.039488 [debug] [ThreadPool]: On list_postgres: Close
[0m08:07:57.040138 [debug] [ThreadPool]: On list_postgres: Close
[0m08:07:57.042057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m08:07:57.042452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m08:07:57.042835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m08:07:57.046686 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m08:07:57.048670 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m08:07:57.051097 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m08:07:57.051382 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m08:07:57.051674 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m08:07:57.051919 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m08:07:57.052169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:57.052402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:57.052628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:57.257284 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.259132 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m08:07:57.260258 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m08:07:57.266896 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.267937 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.269015 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m08:07:57.271016 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m08:07:57.271651 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m08:07:57.271931 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m08:07:57.273491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa73e4910>]}
[0m08:07:57.273854 [debug] [MainThread]: On master: COMMIT
[0m08:07:57.274269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:07:57.274638 [info ] [MainThread]: 
[0m08:07:57.276792 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m08:07:57.276985 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m08:07:57.277158 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m08:07:57.277462 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m08:07:57.277804 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_products .................... [RUN]
[0m08:07:57.278158 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m08:07:57.278718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_orders)
[0m08:07:57.279101 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_products)
[0m08:07:57.279467 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_suppliers)
[0m08:07:57.279713 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m08:07:57.279936 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m08:07:57.280139 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m08:07:57.281356 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m08:07:57.282253 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m08:07:57.283125 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m08:07:57.284463 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 08:07:57.280306 => 08:07:57.284363
[0m08:07:57.284654 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 08:07:57.281574 => 08:07:57.284560
[0m08:07:57.284928 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 08:07:57.282475 => 08:07:57.284815
[0m08:07:57.285075 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m08:07:57.285290 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m08:07:57.285496 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m08:07:57.304089 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m08:07:57.305969 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m08:07:57.307893 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m08:07:57.309459 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:07:57.309806 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "postgres"."analytics_staging"."stg_orders__dbt_tmp"
      
      
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
    )
[0m08:07:57.310278 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:07:57.310508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:57.310998 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:07:57.311227 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "postgres"."analytics_staging"."stg_products__dbt_tmp"
      
      
    as (
      SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m08:07:57.312220 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      
    as (
      SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m08:07:57.312471 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:07:57.312761 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:07:57.453224 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.453705 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.454083 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.457406 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:07:57.459977 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:07:57.461505 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:07:57.461892 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products" rename to "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m08:07:57.462180 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders" rename to "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m08:07:57.462399 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers" rename to "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m08:07:57.487760 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.488719 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.492214 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:07:57.492629 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.494299 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:07:57.494593 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders__dbt_tmp" rename to "postgres"."analytics_staging"."stg_orders"
[0m08:07:57.496266 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:07:57.496491 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products__dbt_tmp" rename to "postgres"."analytics_staging"."stg_products"
[0m08:07:57.497346 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "postgres"."analytics_staging"."stg_suppliers"
[0m08:07:57.524123 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.531865 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m08:07:57.533033 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.535893 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m08:07:57.538190 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m08:07:57.538647 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.538929 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m08:07:57.539497 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m08:07:57.541527 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m08:07:57.542854 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m08:07:57.543637 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m08:07:57.546956 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m08:07:57.572826 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.574008 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.583290 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 08:07:57.285688 => 08:07:57.583183
[0m08:07:57.583745 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.584766 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 08:07:57.306201 => 08:07:57.584685
[0m08:07:57.585033 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m08:07:57.586129 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 08:07:57.304215 => 08:07:57.586047
[0m08:07:57.586537 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m08:07:57.587419 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m08:07:57.587123 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m08:07:57.586818 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m08:07:57.588075 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa603a450>]}
[0m08:07:57.588300 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m08:07:57.588778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa590e050>]}
[0m08:07:57.589145 [info ] [Thread-3 (]: 3 of 6 OK created sql table model analytics_staging.stg_suppliers .............. [[32mSUCCESS[0m in 0.31s]
[0m08:07:57.589722 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa64efb50>]}
[0m08:07:57.590013 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics_staging.stg_orders ................. [[32mSUCCESS[0m in 0.31s]
[0m08:07:57.590416 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m08:07:57.590871 [info ] [Thread-2 (]: 2 of 6 OK created sql table model analytics_staging.stg_products ............... [[32mSUCCESS[0m in 0.31s]
[0m08:07:57.591386 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m08:07:57.591924 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m08:07:57.592862 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m08:07:57.593282 [debug] [Thread-3 (]: Began running node model.greencard_analytics.int_orders_with_behavior
[0m08:07:57.593626 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m08:07:57.594210 [info ] [Thread-3 (]: 5 of 6 START sql table model analytics_intermediate.int_orders_with_behavior ... [RUN]
[0m08:07:57.594909 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.int_orders_enriched'
[0m08:07:57.595359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_suppliers, now model.greencard_analytics.int_orders_with_behavior)
[0m08:07:57.595632 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m08:07:57.595854 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.int_orders_with_behavior
[0m08:07:57.598131 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m08:07:57.599957 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:57.601101 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 08:07:57.596039 => 08:07:57.600987
[0m08:07:57.601380 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m08:07:57.601574 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.int_orders_with_behavior (compile): 08:07:57.598530 => 08:07:57.601486
[0m08:07:57.606483 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m08:07:57.607310 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.int_orders_with_behavior
[0m08:07:57.610352 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:57.612529 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:07:57.613166 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m08:07:57.614389 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:57.614554 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:07:57.614838 [debug] [Thread-3 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_tmp"
      
      
    as (
      

WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    p.product_name,
    p.category,
    s.supplier_name,
    s.country,
    s.sustainability_score

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m08:07:57.615866 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:07:57.836094 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.839025 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:57.839388 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.839672 [debug] [Thread-3 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */
alter table "postgres"."analytics_intermediate"."int_orders_with_behavior" rename to "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m08:07:57.841258 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:07:57.842039 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched" rename to "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:07:57.859170 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.859572 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.861412 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:07:57.863112 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:57.863393 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_enriched"
[0m08:07:57.863607 [debug] [Thread-3 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */
alter table "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_with_behavior"
[0m08:07:57.882544 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.882993 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.884987 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m08:07:57.886818 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:07:57.887367 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m08:07:57.887854 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m08:07:57.888071 [debug] [Thread-3 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m08:07:57.888296 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m08:07:57.907231 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.907654 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:57.908939 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 08:07:57.601714 => 08:07:57.908849
[0m08:07:57.910022 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.int_orders_with_behavior (execute): 08:07:57.608486 => 08:07:57.909931
[0m08:07:57.910277 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m08:07:57.910468 [debug] [Thread-3 (]: On model.greencard_analytics.int_orders_with_behavior: ROLLBACK
[0m08:07:57.910680 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m08:07:57.910868 [debug] [Thread-3 (]: On model.greencard_analytics.int_orders_with_behavior: Close
[0m08:07:57.911347 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5f2af50>]}
[0m08:07:57.911757 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6209990>]}
[0m08:07:57.912077 [info ] [Thread-4 (]: 4 of 6 OK created sql table model analytics_intermediate.int_orders_enriched ... [[32mSUCCESS[0m in 0.32s]
[0m08:07:57.912425 [info ] [Thread-3 (]: 5 of 6 OK created sql table model analytics_intermediate.int_orders_with_behavior  [[32mSUCCESS[0m in 0.32s]
[0m08:07:57.912901 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m08:07:57.913172 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.int_orders_with_behavior
[0m08:07:57.913713 [debug] [Thread-2 (]: Began running node model.greencard_analytics.fct_orders
[0m08:07:57.914042 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics_marts.fct_orders ........................ [RUN]
[0m08:07:57.914503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_products, now model.greencard_analytics.fct_orders)
[0m08:07:57.914696 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.fct_orders
[0m08:07:57.916516 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.fct_orders"
[0m08:07:57.917311 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (compile): 08:07:57.914854 => 08:07:57.917225
[0m08:07:57.917516 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.fct_orders
[0m08:07:57.919216 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.fct_orders"
[0m08:07:57.921239 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m08:07:57.921470 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

  
    

    create table "postgres"."analytics_marts"."fct_orders__dbt_tmp"
      
      
    as (
      

WITH enriched_orders AS (
    SELECT * FROM "postgres"."analytics_intermediate"."int_orders_enriched"
),

behavior_orders AS (
    SELECT * FROM "postgres"."analytics_intermediate"."int_orders_with_behavior"
)

SELECT
    COALESCE(e.order_id, b.order_id) as order_id,
    COALESCE(e.customer_id, b.customer_id) as customer_id,
    COALESCE(e.order_date, b.order_date) as order_date,
    COALESCE(e.amount, b.amount) as revenue,
    COALESCE(e.product_name, b.product_name) as product_name,
    COALESCE(e.category, b.category) as product_category,
    COALESCE(e.supplier_name, b.supplier_name) as supplier_name,
    COALESCE(e.country, b.country) as supplier_country,
    COALESCE(e.sustainability_score, b.sustainability_score) as sustainability_score,
    EXTRACT(YEAR FROM COALESCE(e.order_date, b.order_date)) as order_year,
    EXTRACT(MONTH FROM COALESCE(e.order_date, b.order_date)) as order_month,
    EXTRACT(QUARTER FROM COALESCE(e.order_date, b.order_date)) as order_quarter,
    -- Since we removed user events, set these to 0 for now
    0 as customer_page_views,
    0 as customer_cart_adds,
    0 as customer_purchases

FROM enriched_orders e
FULL OUTER JOIN behavior_orders b ON e.order_id = b.order_id
    )
[0m08:07:57.921683 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:07:58.094485 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:58.096451 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m08:07:58.096716 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders" rename to "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m08:07:58.109185 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:58.111106 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m08:07:58.111365 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders__dbt_tmp" rename to "postgres"."analytics_marts"."fct_orders"
[0m08:07:58.123895 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:58.125621 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m08:07:58.126165 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m08:07:58.126386 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

    drop table if exists "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m08:07:58.138357 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m08:07:58.140871 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (execute): 08:07:57.917667 => 08:07:58.140779
[0m08:07:58.141170 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: ROLLBACK
[0m08:07:58.141420 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: Close
[0m08:07:58.141913 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b36f059f-19e2-4859-aaf6-9ba6886fa43a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa70ba0d0>]}
[0m08:07:58.142225 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics_marts.fct_orders ................... [[32mSUCCESS[0m in 0.23s]
[0m08:07:58.142552 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.fct_orders
[0m08:07:58.143492 [debug] [MainThread]: On master: COMMIT
[0m08:07:58.143843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:58.144006 [debug] [MainThread]: Connection 'model.greencard_analytics.fct_orders' was properly closed.
[0m08:07:58.144184 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_with_behavior' was properly closed.
[0m08:07:58.144383 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_orders' was properly closed.
[0m08:07:58.144563 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m08:07:58.144807 [info ] [MainThread]: 
[0m08:07:58.145039 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m08:07:58.145613 [debug] [MainThread]: Command end result
[0m08:07:58.150784 [info ] [MainThread]: 
[0m08:07:58.151075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:07:58.151344 [info ] [MainThread]: 
[0m08:07:58.151633 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m08:07:58.152247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbd4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa592dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa659fd90>]}
[0m08:07:58.152487 [debug] [MainThread]: Flushing usage events
[0m16:32:42.024246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0eca3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ec8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb132f7d0>]}


============================== 16:32:42.026756 | 4b04c09b-8ef1-4712-92f2-7a5955645e93 ==============================
[0m16:32:42.026756 [info ] [MainThread]: Running with dbt=1.7.4
[0m16:32:42.027098 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'write_json': 'True', 'debug': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'version_check': 'True', 'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'static_parser': 'True', 'profiles_dir': '/root/.dbt', 'quiet': 'False', 'log_path': '/usr/app/logs', 'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run'}
[0m16:32:42.161372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb09b8ad0>]}
[0m16:32:42.221527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ac3710>]}
[0m16:32:42.221918 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m16:32:42.226250 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m16:32:42.254881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:42.255105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:42.257850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0da5ed0>]}
[0m16:32:42.265681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb093f290>]}
[0m16:32:42.265941 [info ] [MainThread]: Found 6 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m16:32:42.266215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ee3ed0>]}
[0m16:32:42.267148 [info ] [MainThread]: 
[0m16:32:42.267589 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m16:32:42.268330 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m16:32:42.268782 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m16:32:42.275168 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m16:32:42.276874 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m16:32:42.278104 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m16:32:42.279229 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m16:32:42.279424 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m16:32:42.279619 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m16:32:42.279822 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m16:32:42.280002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:42.280175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:42.280342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:42.354386 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:42.357747 [debug] [ThreadPool]: On list_postgres: Close
[0m16:32:42.356525 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:42.359600 [debug] [ThreadPool]: On list_postgres: Close
[0m16:32:42.358199 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:42.360764 [debug] [ThreadPool]: On list_postgres: Close
[0m16:32:42.362086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m16:32:42.362595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m16:32:42.367105 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m16:32:42.367474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m16:32:42.369792 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m16:32:42.370146 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m16:32:42.372090 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m16:32:42.372419 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m16:32:42.372707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:42.372957 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m16:32:42.373207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:42.374885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:42.685530 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:42.686199 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:42.688441 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m16:32:42.687617 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:42.687292 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m16:32:42.688768 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m16:32:42.689643 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m16:32:42.690873 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m16:32:42.689994 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m16:32:42.692506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb08a3c50>]}
[0m16:32:42.692813 [debug] [MainThread]: On master: COMMIT
[0m16:32:42.693175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:32:42.693591 [info ] [MainThread]: 
[0m16:32:42.696176 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m16:32:42.696905 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m16:32:42.696625 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m16:32:42.698126 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m16:32:42.698748 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_suppliers)
[0m16:32:42.699255 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m16:32:42.700476 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m16:32:42.696387 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m16:32:42.701229 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_products .................... [RUN]
[0m16:32:42.702195 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_products)
[0m16:32:42.697545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_orders)
[0m16:32:42.708228 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m16:32:42.709369 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m16:32:42.713099 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m16:32:42.713868 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 16:32:42.699440 => 16:32:42.713431
[0m16:32:42.720285 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m16:32:42.719093 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m16:32:42.740408 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m16:32:42.740775 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 16:32:42.710931 => 16:32:42.740601
[0m16:32:42.741339 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 16:32:42.717587 => 16:32:42.741226
[0m16:32:42.741640 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m16:32:42.741946 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m16:32:42.744864 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m16:32:42.773046 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m16:32:42.773613 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m16:32:42.774461 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      
    as (
      SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m16:32:42.774975 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m16:32:42.775204 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:32:42.775843 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m16:32:42.776044 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "postgres"."analytics_staging"."stg_products__dbt_tmp"
      
      
    as (
      SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m16:32:42.776843 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "postgres"."analytics_staging"."stg_orders__dbt_tmp"
      
      
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
    )
[0m16:32:42.777114 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:32:42.777394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:42.993517 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:42.998078 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m16:32:42.998733 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders" rename to "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m16:32:43.018681 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.021229 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m16:32:43.021825 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders__dbt_tmp" rename to "postgres"."analytics_staging"."stg_orders"
[0m16:32:43.046532 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.051454 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m16:32:43.052808 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m16:32:43.053335 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m16:32:43.107970 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.117728 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 16:32:42.745057 => 16:32:43.117600
[0m16:32:43.118475 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m16:32:43.119237 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m16:32:43.120933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b6a050>]}
[0m16:32:43.123222 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics_staging.stg_orders ................. [[32mSUCCESS[0m in 0.42s]
[0m16:32:43.124273 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m16:32:43.268094 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.272799 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m16:32:43.273157 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers" rename to "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m16:32:43.275491 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.277465 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m16:32:43.278172 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products" rename to "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m16:32:43.286351 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.288537 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m16:32:43.289012 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "postgres"."analytics_staging"."stg_suppliers"
[0m16:32:43.290357 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.292377 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m16:32:43.293135 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products__dbt_tmp" rename to "postgres"."analytics_staging"."stg_products"
[0m16:32:43.305111 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.307222 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m16:32:43.307591 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.308012 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m16:32:43.309483 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m16:32:43.309765 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m16:32:43.311299 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m16:32:43.312849 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m16:32:43.323062 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.323461 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.324580 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 16:32:42.720850 => 16:32:43.324493
[0m16:32:43.325616 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 16:32:42.742210 => 16:32:43.325545
[0m16:32:43.325852 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m16:32:43.326100 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m16:32:43.326308 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m16:32:43.326505 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m16:32:43.326978 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0aebc10>]}
[0m16:32:43.327352 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fe84d0>]}
[0m16:32:43.327640 [info ] [Thread-3 (]: 3 of 6 OK created sql table model analytics_staging.stg_suppliers .............. [[32mSUCCESS[0m in 0.63s]
[0m16:32:43.328176 [info ] [Thread-2 (]: 2 of 6 OK created sql table model analytics_staging.stg_products ............... [[32mSUCCESS[0m in 0.63s]
[0m16:32:43.328490 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m16:32:43.328779 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m16:32:43.329426 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m16:32:43.329585 [debug] [Thread-1 (]: Began running node model.greencard_analytics.int_orders_with_behavior
[0m16:32:43.329827 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m16:32:43.330180 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics_intermediate.int_orders_with_behavior ... [RUN]
[0m16:32:43.330631 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.int_orders_enriched'
[0m16:32:43.331027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_orders, now model.greencard_analytics.int_orders_with_behavior)
[0m16:32:43.331285 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m16:32:43.331519 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.int_orders_with_behavior
[0m16:32:43.333455 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m16:32:43.335022 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_with_behavior"
[0m16:32:43.336444 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_with_behavior (compile): 16:32:43.333655 => 16:32:43.336340
[0m16:32:43.336630 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 16:32:43.331705 => 16:32:43.336529
[0m16:32:43.336862 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.int_orders_with_behavior
[0m16:32:43.337104 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m16:32:43.338998 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_with_behavior"
[0m16:32:43.340756 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m16:32:43.343279 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m16:32:43.344263 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m16:32:43.344440 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m16:32:43.344709 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_tmp"
      
      
    as (
      

WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    p.product_name,
    p.category,
    s.supplier_name,
    s.country,
    s.sustainability_score

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m16:32:43.344970 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:32:43.345164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:43.559459 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.563560 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m16:32:43.564193 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */
alter table "postgres"."analytics_intermediate"."int_orders_with_behavior" rename to "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m16:32:43.580614 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.581472 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.583443 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m16:32:43.585272 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m16:32:43.585623 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */
alter table "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_with_behavior"
[0m16:32:43.586131 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched" rename to "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m16:32:43.605287 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.608769 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m16:32:43.609130 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.609663 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m16:32:43.611552 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m16:32:43.611961 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m16:32:43.612292 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_enriched"
[0m16:32:43.631299 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.633137 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_with_behavior (execute): 16:32:43.337288 => 16:32:43.633016
[0m16:32:43.634226 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: ROLLBACK
[0m16:32:43.634930 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.635352 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: Close
[0m16:32:43.638497 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m16:32:43.639152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb07b86d0>]}
[0m16:32:43.639647 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m16:32:43.640089 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics_intermediate.int_orders_with_behavior  [[32mSUCCESS[0m in 0.31s]
[0m16:32:43.640600 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m16:32:43.641144 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.int_orders_with_behavior
[0m16:32:43.652077 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.653349 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 16:32:43.339165 => 16:32:43.653265
[0m16:32:43.653586 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m16:32:43.653830 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m16:32:43.654283 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb07b91d0>]}
[0m16:32:43.654586 [info ] [Thread-4 (]: 4 of 6 OK created sql table model analytics_intermediate.int_orders_enriched ... [[32mSUCCESS[0m in 0.32s]
[0m16:32:43.654937 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m16:32:43.655376 [debug] [Thread-2 (]: Began running node model.greencard_analytics.fct_orders
[0m16:32:43.655668 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics_marts.fct_orders ........................ [RUN]
[0m16:32:43.656100 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_products, now model.greencard_analytics.fct_orders)
[0m16:32:43.656317 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.fct_orders
[0m16:32:43.657936 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.fct_orders"
[0m16:32:43.658829 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (compile): 16:32:43.656451 => 16:32:43.658734
[0m16:32:43.659028 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.fct_orders
[0m16:32:43.661009 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.fct_orders"
[0m16:32:43.663176 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m16:32:43.663413 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

  
    

    create table "postgres"."analytics_marts"."fct_orders__dbt_tmp"
      
      
    as (
      

WITH enriched_orders AS (
    SELECT * FROM "postgres"."analytics_intermediate"."int_orders_enriched"
),

behavior_orders AS (
    SELECT * FROM "postgres"."analytics_intermediate"."int_orders_with_behavior"
)

SELECT
    COALESCE(e.order_id, b.order_id) as order_id,
    COALESCE(e.customer_id, b.customer_id) as customer_id,
    COALESCE(e.order_date, b.order_date) as order_date,
    COALESCE(e.amount, b.amount) as revenue,
    COALESCE(e.product_name, b.product_name) as product_name,
    COALESCE(e.category, b.category) as product_category,
    COALESCE(e.supplier_name, b.supplier_name) as supplier_name,
    COALESCE(e.country, b.country) as supplier_country,
    COALESCE(e.sustainability_score, b.sustainability_score) as sustainability_score,
    EXTRACT(YEAR FROM COALESCE(e.order_date, b.order_date)) as order_year,
    EXTRACT(MONTH FROM COALESCE(e.order_date, b.order_date)) as order_month,
    EXTRACT(QUARTER FROM COALESCE(e.order_date, b.order_date)) as order_quarter,
    -- Since we removed user events, set these to 0 for now
    0 as customer_page_views,
    0 as customer_cart_adds,
    0 as customer_purchases

FROM enriched_orders e
FULL OUTER JOIN behavior_orders b ON e.order_id = b.order_id
    )
[0m16:32:43.663627 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:32:43.861167 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.866739 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m16:32:43.867120 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders" rename to "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m16:32:43.925915 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.928162 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m16:32:43.928486 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders__dbt_tmp" rename to "postgres"."analytics_marts"."fct_orders"
[0m16:32:43.941126 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.942942 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m16:32:43.943457 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m16:32:43.943671 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

    drop table if exists "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m16:32:43.953031 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m16:32:43.954225 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (execute): 16:32:43.659173 => 16:32:43.954141
[0m16:32:43.954442 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: ROLLBACK
[0m16:32:43.954625 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: Close
[0m16:32:43.955082 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b04c09b-8ef1-4712-92f2-7a5955645e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb06f8550>]}
[0m16:32:43.955387 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics_marts.fct_orders ................... [[32mSUCCESS[0m in 0.30s]
[0m16:32:43.955813 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.fct_orders
[0m16:32:43.956797 [debug] [MainThread]: On master: COMMIT
[0m16:32:43.957113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:43.957288 [debug] [MainThread]: Connection 'model.greencard_analytics.fct_orders' was properly closed.
[0m16:32:43.957461 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m16:32:43.957614 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_with_behavior' was properly closed.
[0m16:32:43.957805 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m16:32:43.958000 [info ] [MainThread]: 
[0m16:32:43.958243 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m16:32:43.958840 [debug] [MainThread]: Command end result
[0m16:32:43.963903 [info ] [MainThread]: 
[0m16:32:43.964204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:43.964459 [info ] [MainThread]: 
[0m16:32:43.964723 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:32:43.965957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6498e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0aea510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6498d90>]}
[0m16:32:43.966170 [debug] [MainThread]: Flushing usage events
[0m17:20:42.970618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadfd89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf67dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadfd8750>]}


============================== 17:20:42.972614 | 022f675d-d7e1-4f27-a23b-bfb4338b4266 ==============================
[0m17:20:42.972614 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:20:42.972968 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'introspect': 'True', 'log_path': '/usr/app/logs', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'write_json': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt'}
[0m17:20:43.099230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc345d0>]}
[0m17:20:43.160869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffade15a10>]}
[0m17:20:43.161263 [info ] [MainThread]: Registered adapter: trino=1.7.1
[0m17:20:43.166187 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:20:43.186292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:20:43.186536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:20:43.189243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada0c6d0>]}
[0m17:20:43.195921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada575d0>]}
[0m17:20:43.196178 [info ] [MainThread]: Found 6 models, 4 sources, 0 exposures, 0 metrics, 421 macros, 0 groups, 0 semantic models
[0m17:20:43.196436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb34f10>]}
[0m17:20:43.197333 [info ] [MainThread]: 
[0m17:20:43.197777 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m17:20:43.198561 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m17:20:43.199037 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m17:20:43.204611 [debug] [ThreadPool]: Acquiring new trino connection 'list_postgres'
[0m17:20:43.207462 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m17:20:43.208757 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m17:20:43.209973 [debug] [ThreadPool]: Using trino connection "list_postgres"
[0m17:20:43.210244 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m17:20:43.210490 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m17:20:43.210734 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres"} */

    select schema_name
    from "postgres".INFORMATION_SCHEMA.schemata
[0m17:20:43.210974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:43.211242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:43.211469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:43.282854 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.283462 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.285711 [debug] [ThreadPool]: On list_postgres: Close
[0m17:20:43.288459 [debug] [ThreadPool]: On list_postgres: Close
[0m17:20:43.288845 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.290800 [debug] [ThreadPool]: On list_postgres: Close
[0m17:20:43.292637 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_staging)
[0m17:20:43.293451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_intermediate)
[0m17:20:43.294154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_analytics_marts)
[0m17:20:43.300250 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_staging"
[0m17:20:43.302522 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_intermediate"
[0m17:20:43.304409 [debug] [ThreadPool]: Using trino connection "list_postgres_analytics_marts"
[0m17:20:43.304715 [debug] [ThreadPool]: On list_postgres_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_staging"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_staging') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_staging'
[0m17:20:43.305010 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_intermediate"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_intermediate') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_intermediate'
[0m17:20:43.305276 [debug] [ThreadPool]: On list_postgres_analytics_marts: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "connection_name": "list_postgres_analytics_marts"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "postgres".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'postgres'
              and schema_name = 'analytics_marts') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'analytics_marts'
[0m17:20:43.305548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:43.305794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:43.306033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:43.507500 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.511327 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: ROLLBACK
[0m17:20:43.513757 [debug] [ThreadPool]: On list_postgres_analytics_intermediate: Close
[0m17:20:43.518093 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.518569 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.520430 [debug] [ThreadPool]: On list_postgres_analytics_staging: ROLLBACK
[0m17:20:43.521937 [debug] [ThreadPool]: On list_postgres_analytics_staging: Close
[0m17:20:43.521398 [debug] [ThreadPool]: On list_postgres_analytics_marts: ROLLBACK
[0m17:20:43.525630 [debug] [ThreadPool]: On list_postgres_analytics_marts: Close
[0m17:20:43.527277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada45290>]}
[0m17:20:43.527975 [debug] [MainThread]: On master: COMMIT
[0m17:20:43.529223 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:20:43.529888 [info ] [MainThread]: 
[0m17:20:43.533336 [debug] [Thread-1 (]: Began running node model.greencard_analytics.stg_orders
[0m17:20:43.534268 [debug] [Thread-2 (]: Began running node model.greencard_analytics.stg_products
[0m17:20:43.535046 [debug] [Thread-3 (]: Began running node model.greencard_analytics.stg_suppliers
[0m17:20:43.542268 [info ] [Thread-3 (]: 3 of 6 START sql table model analytics_staging.stg_suppliers ................... [RUN]
[0m17:20:43.541365 [info ] [Thread-2 (]: 2 of 6 START sql table model analytics_staging.stg_products .................... [RUN]
[0m17:20:43.535538 [info ] [Thread-1 (]: 1 of 6 START sql table model analytics_staging.stg_orders ...................... [RUN]
[0m17:20:43.543061 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_intermediate, now model.greencard_analytics.stg_suppliers)
[0m17:20:43.546146 [debug] [Thread-3 (]: Began compiling node model.greencard_analytics.stg_suppliers
[0m17:20:43.545649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_marts, now model.greencard_analytics.stg_orders)
[0m17:20:43.544416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_postgres_analytics_staging, now model.greencard_analytics.stg_products)
[0m17:20:43.548143 [debug] [Thread-3 (]: Writing injected SQL for node "model.greencard_analytics.stg_suppliers"
[0m17:20:43.549043 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.stg_orders
[0m17:20:43.552233 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.stg_orders"
[0m17:20:43.549845 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.stg_products
[0m17:20:43.557465 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.stg_products"
[0m17:20:43.558396 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (compile): 17:20:43.546935 => 17:20:43.557647
[0m17:20:43.565227 [debug] [Thread-3 (]: Began executing node model.greencard_analytics.stg_suppliers
[0m17:20:43.564684 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (compile): 17:20:43.551299 => 17:20:43.563977
[0m17:20:43.591519 [debug] [Thread-3 (]: Writing runtime sql for node "model.greencard_analytics.stg_suppliers"
[0m17:20:43.591799 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.stg_orders
[0m17:20:43.592350 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (compile): 17:20:43.556518 => 17:20:43.592244
[0m17:20:43.595981 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.stg_orders"
[0m17:20:43.596555 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.stg_products
[0m17:20:43.597308 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m17:20:43.642065 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.stg_products"
[0m17:20:43.643092 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m17:20:43.643310 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

  
    

    create table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp"
      
      
    as (
      SELECT
    id as supplier_id,
    supplier_name,
    country,
    region,
    sustainability_score
FROM mysql.catalog_db.suppliers
    )
[0m17:20:43.644459 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

  
    

    create table "postgres"."analytics_staging"."stg_orders__dbt_tmp"
      
      
    as (
      SELECT
    order_id,
    customer_id,
    product_id,
    order_date,
    amount,
    status
FROM postgres.public.orders
WHERE amount > 0
    AND status = 'completed'
    )
[0m17:20:43.645436 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:20:43.646604 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m17:20:43.646932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:43.648625 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

  
    

    create table "postgres"."analytics_staging"."stg_products__dbt_tmp"
      
      
    as (
      SELECT
    id as product_id,
    product_name,
    category,
    price,
    supplier_id
FROM mysql.catalog_db.products
    )
[0m17:20:43.650920 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:20:43.785313 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.792924 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m17:20:43.793960 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders" rename to "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m17:20:43.826176 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.831047 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m17:20:43.832041 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */
alter table "postgres"."analytics_staging"."stg_orders__dbt_tmp" rename to "postgres"."analytics_staging"."stg_orders"
[0m17:20:43.832268 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.832586 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.834802 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m17:20:43.836956 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m17:20:43.837743 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers" rename to "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m17:20:43.838544 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products" rename to "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m17:20:43.846772 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.850971 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m17:20:43.851393 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.852621 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.stg_orders"
[0m17:20:43.854803 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m17:20:43.855141 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.855354 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_orders"} */

    drop table if exists "postgres"."analytics_staging"."stg_orders__dbt_backup"
[0m17:20:43.855667 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */
alter table "postgres"."analytics_staging"."stg_suppliers__dbt_tmp" rename to "postgres"."analytics_staging"."stg_suppliers"
[0m17:20:43.857327 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m17:20:43.861903 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */
alter table "postgres"."analytics_staging"."stg_products__dbt_tmp" rename to "postgres"."analytics_staging"."stg_products"
[0m17:20:43.870749 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.871176 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.873042 [debug] [Thread-3 (]: Applying DROP to: "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m17:20:43.881562 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.stg_orders (execute): 17:20:43.592773 => 17:20:43.881466
[0m17:20:43.882460 [debug] [Thread-3 (]: Using trino connection "model.greencard_analytics.stg_suppliers"
[0m17:20:43.882905 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.883154 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: ROLLBACK
[0m17:20:43.883400 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_suppliers"} */

    drop table if exists "postgres"."analytics_staging"."stg_suppliers__dbt_backup"
[0m17:20:43.886192 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m17:20:43.886815 [debug] [Thread-1 (]: On model.greencard_analytics.stg_orders: Close
[0m17:20:43.888292 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.stg_products"
[0m17:20:43.888940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad8b9490>]}
[0m17:20:43.889625 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.stg_products"} */

    drop table if exists "postgres"."analytics_staging"."stg_products__dbt_backup"
[0m17:20:43.890131 [info ] [Thread-1 (]: 1 of 6 OK created sql table model analytics_staging.stg_orders ................. [[32mSUCCESS[0m in 0.34s]
[0m17:20:43.892511 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.stg_orders
[0m17:20:43.900697 [debug] [Thread-3 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.901712 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:43.903527 [debug] [Thread-3 (]: Timing info for model.greencard_analytics.stg_suppliers (execute): 17:20:43.566653 => 17:20:43.903437
[0m17:20:43.904665 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.stg_products (execute): 17:20:43.597808 => 17:20:43.904581
[0m17:20:43.904922 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: ROLLBACK
[0m17:20:43.905366 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: ROLLBACK
[0m17:20:43.905581 [debug] [Thread-3 (]: On model.greencard_analytics.stg_suppliers: Close
[0m17:20:43.905782 [debug] [Thread-2 (]: On model.greencard_analytics.stg_products: Close
[0m17:20:43.906346 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9f7b50>]}
[0m17:20:43.906760 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad80ff10>]}
[0m17:20:43.907069 [info ] [Thread-3 (]: 3 of 6 OK created sql table model analytics_staging.stg_suppliers .............. [[32mSUCCESS[0m in 0.36s]
[0m17:20:43.907659 [info ] [Thread-2 (]: 2 of 6 OK created sql table model analytics_staging.stg_products ............... [[32mSUCCESS[0m in 0.36s]
[0m17:20:43.908104 [debug] [Thread-3 (]: Finished running node model.greencard_analytics.stg_suppliers
[0m17:20:43.908381 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.stg_products
[0m17:20:43.909049 [debug] [Thread-4 (]: Began running node model.greencard_analytics.int_orders_enriched
[0m17:20:43.909213 [debug] [Thread-1 (]: Began running node model.greencard_analytics.int_orders_with_behavior
[0m17:20:43.909534 [info ] [Thread-4 (]: 4 of 6 START sql table model analytics_intermediate.int_orders_enriched ........ [RUN]
[0m17:20:43.909928 [info ] [Thread-1 (]: 5 of 6 START sql table model analytics_intermediate.int_orders_with_behavior ... [RUN]
[0m17:20:43.910444 [debug] [Thread-4 (]: Acquiring new trino connection 'model.greencard_analytics.int_orders_enriched'
[0m17:20:43.910828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_orders, now model.greencard_analytics.int_orders_with_behavior)
[0m17:20:43.911124 [debug] [Thread-4 (]: Began compiling node model.greencard_analytics.int_orders_enriched
[0m17:20:43.911387 [debug] [Thread-1 (]: Began compiling node model.greencard_analytics.int_orders_with_behavior
[0m17:20:43.913461 [debug] [Thread-4 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_enriched"
[0m17:20:43.915631 [debug] [Thread-1 (]: Writing injected SQL for node "model.greencard_analytics.int_orders_with_behavior"
[0m17:20:43.917397 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (compile): 17:20:43.911592 => 17:20:43.917277
[0m17:20:43.917702 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_with_behavior (compile): 17:20:43.913698 => 17:20:43.917617
[0m17:20:43.917863 [debug] [Thread-4 (]: Began executing node model.greencard_analytics.int_orders_enriched
[0m17:20:43.918164 [debug] [Thread-1 (]: Began executing node model.greencard_analytics.int_orders_with_behavior
[0m17:20:43.920182 [debug] [Thread-4 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_enriched"
[0m17:20:43.921891 [debug] [Thread-1 (]: Writing runtime sql for node "model.greencard_analytics.int_orders_with_behavior"
[0m17:20:43.924417 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m17:20:43.925465 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m17:20:43.925648 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp"
      
      
    as (
      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers


WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    
    p.product_name,
    p.category,
    p.price,
    
    s.supplier_name,
    s.country,
    s.region,
    s.sustainability_score,
    
    CASE 
        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)
        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)
        ELSE CAST('Low Value' AS VARCHAR)
    END AS order_value_tier,
    
    CASE
        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)
        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)
        ELSE CAST('Fair' AS VARCHAR)
    END AS sustainability_tier

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m17:20:43.925923 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */

  
    

    create table "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_tmp"
      
      
    as (
      

WITH orders AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_orders"
),

products AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_products"
),

suppliers AS (
    SELECT * FROM "postgres"."analytics_staging"."stg_suppliers"
)

SELECT
    o.order_id,
    o.customer_id,
    o.order_date,
    o.amount,
    p.product_name,
    p.category,
    s.supplier_name,
    s.country,
    s.sustainability_score

FROM orders o
LEFT JOIN products p ON o.product_id = p.product_id
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
    )
[0m17:20:43.926210 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:20:43.926409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:44.139140 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.143500 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m17:20:44.144058 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */
alter table "postgres"."analytics_intermediate"."int_orders_with_behavior" rename to "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m17:20:44.158248 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.160958 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m17:20:44.161821 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */
alter table "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_with_behavior"
[0m17:20:44.162679 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.164235 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m17:20:44.164990 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched" rename to "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m17:20:44.177470 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.179882 [debug] [Thread-1 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m17:20:44.180326 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.180710 [debug] [Thread-1 (]: Using trino connection "model.greencard_analytics.int_orders_with_behavior"
[0m17:20:44.182342 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m17:20:44.182701 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_with_behavior"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_with_behavior__dbt_backup"
[0m17:20:44.182939 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */
alter table "postgres"."analytics_intermediate"."int_orders_enriched__dbt_tmp" rename to "postgres"."analytics_intermediate"."int_orders_enriched"
[0m17:20:44.196448 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.198128 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.199373 [debug] [Thread-1 (]: Timing info for model.greencard_analytics.int_orders_with_behavior (execute): 17:20:43.920363 => 17:20:44.199265
[0m17:20:44.202294 [debug] [Thread-4 (]: Applying DROP to: "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m17:20:44.202572 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: ROLLBACK
[0m17:20:44.203028 [debug] [Thread-4 (]: Using trino connection "model.greencard_analytics.int_orders_enriched"
[0m17:20:44.203251 [debug] [Thread-1 (]: On model.greencard_analytics.int_orders_with_behavior: Close
[0m17:20:44.203466 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.int_orders_enriched"} */

    drop table if exists "postgres"."analytics_intermediate"."int_orders_enriched__dbt_backup"
[0m17:20:44.204024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad6e94d0>]}
[0m17:20:44.204813 [info ] [Thread-1 (]: 5 of 6 OK created sql table model analytics_intermediate.int_orders_with_behavior  [[32mSUCCESS[0m in 0.29s]
[0m17:20:44.205695 [debug] [Thread-1 (]: Finished running node model.greencard_analytics.int_orders_with_behavior
[0m17:20:44.215717 [debug] [Thread-4 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.216986 [debug] [Thread-4 (]: Timing info for model.greencard_analytics.int_orders_enriched (execute): 17:20:43.918357 => 17:20:44.216903
[0m17:20:44.217264 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: ROLLBACK
[0m17:20:44.217484 [debug] [Thread-4 (]: On model.greencard_analytics.int_orders_enriched: Close
[0m17:20:44.217931 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad8264d0>]}
[0m17:20:44.218263 [info ] [Thread-4 (]: 4 of 6 OK created sql table model analytics_intermediate.int_orders_enriched ... [[32mSUCCESS[0m in 0.31s]
[0m17:20:44.218670 [debug] [Thread-4 (]: Finished running node model.greencard_analytics.int_orders_enriched
[0m17:20:44.219124 [debug] [Thread-2 (]: Began running node model.greencard_analytics.fct_orders
[0m17:20:44.219507 [info ] [Thread-2 (]: 6 of 6 START sql table model analytics_marts.fct_orders ........................ [RUN]
[0m17:20:44.219978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.greencard_analytics.stg_products, now model.greencard_analytics.fct_orders)
[0m17:20:44.220227 [debug] [Thread-2 (]: Began compiling node model.greencard_analytics.fct_orders
[0m17:20:44.221969 [debug] [Thread-2 (]: Writing injected SQL for node "model.greencard_analytics.fct_orders"
[0m17:20:44.222868 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (compile): 17:20:44.220369 => 17:20:44.222779
[0m17:20:44.223132 [debug] [Thread-2 (]: Began executing node model.greencard_analytics.fct_orders
[0m17:20:44.225253 [debug] [Thread-2 (]: Writing runtime sql for node "model.greencard_analytics.fct_orders"
[0m17:20:44.227527 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m17:20:44.227782 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

  
    

    create table "postgres"."analytics_marts"."fct_orders__dbt_tmp"
      
      
    as (
      

WITH enriched_orders AS (
    SELECT * FROM "postgres"."analytics_intermediate"."int_orders_enriched"
),

behavior_orders AS (
    SELECT * FROM "postgres"."analytics_intermediate"."int_orders_with_behavior"
)

SELECT
    COALESCE(e.order_id, b.order_id) as order_id,
    COALESCE(e.customer_id, b.customer_id) as customer_id,
    COALESCE(e.order_date, b.order_date) as order_date,
    COALESCE(e.amount, b.amount) as revenue,
    COALESCE(e.product_name, b.product_name) as product_name,
    COALESCE(e.category, b.category) as product_category,
    COALESCE(e.supplier_name, b.supplier_name) as supplier_name,
    COALESCE(e.country, b.country) as supplier_country,
    COALESCE(e.sustainability_score, b.sustainability_score) as sustainability_score,
    EXTRACT(YEAR FROM COALESCE(e.order_date, b.order_date)) as order_year,
    EXTRACT(MONTH FROM COALESCE(e.order_date, b.order_date)) as order_month,
    EXTRACT(QUARTER FROM COALESCE(e.order_date, b.order_date)) as order_quarter,
    -- Since we removed user events, set these to 0 for now
    0 as customer_page_views,
    0 as customer_cart_adds,
    0 as customer_purchases

FROM enriched_orders e
FULL OUTER JOIN behavior_orders b ON e.order_id = b.order_id
    )
[0m17:20:44.228034 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:20:44.340339 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.342543 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m17:20:44.342870 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders" rename to "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m17:20:44.357651 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.359709 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m17:20:44.359982 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */
alter table "postgres"."analytics_marts"."fct_orders__dbt_tmp" rename to "postgres"."analytics_marts"."fct_orders"
[0m17:20:44.379026 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.382307 [debug] [Thread-2 (]: Applying DROP to: "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m17:20:44.383360 [debug] [Thread-2 (]: Using trino connection "model.greencard_analytics.fct_orders"
[0m17:20:44.383742 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "lakehouse", "target_name": "dev", "node_id": "model.greencard_analytics.fct_orders"} */

    drop table if exists "postgres"."analytics_marts"."fct_orders__dbt_backup"
[0m17:20:44.403671 [debug] [Thread-2 (]: SQL status: SUCCESS in 0.0 seconds
[0m17:20:44.405203 [debug] [Thread-2 (]: Timing info for model.greencard_analytics.fct_orders (execute): 17:20:44.223294 => 17:20:44.405083
[0m17:20:44.405485 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: ROLLBACK
[0m17:20:44.405715 [debug] [Thread-2 (]: On model.greencard_analytics.fct_orders: Close
[0m17:20:44.406353 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '022f675d-d7e1-4f27-a23b-bfb4338b4266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad69a9d0>]}
[0m17:20:44.406731 [info ] [Thread-2 (]: 6 of 6 OK created sql table model analytics_marts.fct_orders ................... [[32mSUCCESS[0m in 0.19s]
[0m17:20:44.407159 [debug] [Thread-2 (]: Finished running node model.greencard_analytics.fct_orders
[0m17:20:44.408227 [debug] [MainThread]: On master: COMMIT
[0m17:20:44.408588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:44.408749 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_with_behavior' was properly closed.
[0m17:20:44.408872 [debug] [MainThread]: Connection 'model.greencard_analytics.fct_orders' was properly closed.
[0m17:20:44.408983 [debug] [MainThread]: Connection 'model.greencard_analytics.stg_suppliers' was properly closed.
[0m17:20:44.409100 [debug] [MainThread]: Connection 'model.greencard_analytics.int_orders_enriched' was properly closed.
[0m17:20:44.409305 [info ] [MainThread]: 
[0m17:20:44.409511 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m17:20:44.410119 [debug] [MainThread]: Command end result
[0m17:20:44.415306 [info ] [MainThread]: 
[0m17:20:44.415527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:20:44.415759 [info ] [MainThread]: 
[0m17:20:44.415966 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:20:44.416668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadf6f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc0b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5c0b50>]}
[0m17:20:44.416880 [debug] [MainThread]: Flushing usage events
