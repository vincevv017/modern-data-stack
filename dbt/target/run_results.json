{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2025-10-12T17:20:44.409694Z", "invocation_id": "022f675d-d7e1-4f27-a23b-bfb4338b4266", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-12T17:20:43.551299Z", "completed_at": "2025-10-12T17:20:43.563977Z"}, {"name": "execute", "started_at": "2025-10-12T17:20:43.592773Z", "completed_at": "2025-10-12T17:20:43.881466Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3437371253967285, "adapter_response": {"_message": "SUCCESS", "rows_affected": 50, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.4\", \"profile_name\": \"lakehouse\", \"target_name\": \"dev\", \"node_id\": \"model.greencard_analytics.stg_orders\"} */\n\n  \n    \n\n    create table \"postgres\".\"analytics_staging\".\"stg_orders__dbt_tmp\"\n      \n      \n    as (\n      SELECT\n    order_id,\n    customer_id,\n    product_id,\n    order_date,\n    amount,\n    status\nFROM postgres.public.orders\nWHERE amount > 0\n    AND status = 'completed'\n    )", "query_id": "20251012_172043_00103_s55gt"}, "message": "SUCCESS", "failures": null, "unique_id": "model.greencard_analytics.stg_orders", "compiled": true, "compiled_code": "SELECT\n    order_id,\n    customer_id,\n    product_id,\n    order_date,\n    amount,\n    status\nFROM postgres.public.orders\nWHERE amount > 0\n    AND status = 'completed'", "relation_name": "\"postgres\".\"analytics_staging\".\"stg_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-12T17:20:43.546935Z", "completed_at": "2025-10-12T17:20:43.557647Z"}, {"name": "execute", "started_at": "2025-10-12T17:20:43.566653Z", "completed_at": "2025-10-12T17:20:43.903437Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3635706901550293, "adapter_response": {"_message": "SUCCESS", "rows_affected": 5, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.4\", \"profile_name\": \"lakehouse\", \"target_name\": \"dev\", \"node_id\": \"model.greencard_analytics.stg_suppliers\"} */\n\n  \n    \n\n    create table \"postgres\".\"analytics_staging\".\"stg_suppliers__dbt_tmp\"\n      \n      \n    as (\n      SELECT\n    id as supplier_id,\n    supplier_name,\n    country,\n    region,\n    sustainability_score\nFROM mysql.catalog_db.suppliers\n    )", "query_id": "20251012_172043_00102_s55gt"}, "message": "SUCCESS", "failures": null, "unique_id": "model.greencard_analytics.stg_suppliers", "compiled": true, "compiled_code": "SELECT\n    id as supplier_id,\n    supplier_name,\n    country,\n    region,\n    sustainability_score\nFROM mysql.catalog_db.suppliers", "relation_name": "\"postgres\".\"analytics_staging\".\"stg_suppliers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-12T17:20:43.556518Z", "completed_at": "2025-10-12T17:20:43.592244Z"}, {"name": "execute", "started_at": "2025-10-12T17:20:43.597808Z", "completed_at": "2025-10-12T17:20:43.904581Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3631429672241211, "adapter_response": {"_message": "SUCCESS", "rows_affected": 7, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.4\", \"profile_name\": \"lakehouse\", \"target_name\": \"dev\", \"node_id\": \"model.greencard_analytics.stg_products\"} */\n\n  \n    \n\n    create table \"postgres\".\"analytics_staging\".\"stg_products__dbt_tmp\"\n      \n      \n    as (\n      SELECT\n    id as product_id,\n    product_name,\n    category,\n    price,\n    supplier_id\nFROM mysql.catalog_db.products\n    )", "query_id": "20251012_172043_00104_s55gt"}, "message": "SUCCESS", "failures": null, "unique_id": "model.greencard_analytics.stg_products", "compiled": true, "compiled_code": "SELECT\n    id as product_id,\n    product_name,\n    category,\n    price,\n    supplier_id\nFROM mysql.catalog_db.products", "relation_name": "\"postgres\".\"analytics_staging\".\"stg_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-12T17:20:43.913698Z", "completed_at": "2025-10-12T17:20:43.917617Z"}, {"name": "execute", "started_at": "2025-10-12T17:20:43.920363Z", "completed_at": "2025-10-12T17:20:44.199265Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.293262243270874, "adapter_response": {"_message": "SUCCESS", "rows_affected": 50, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.4\", \"profile_name\": \"lakehouse\", \"target_name\": \"dev\", \"node_id\": \"model.greencard_analytics.int_orders_with_behavior\"} */\n\n  \n    \n\n    create table \"postgres\".\"analytics_intermediate\".\"int_orders_with_behavior__dbt_tmp\"\n      \n      \n    as (\n      \n\nWITH orders AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_orders\"\n),\n\nproducts AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_products\"\n),\n\nsuppliers AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_suppliers\"\n)\n\nSELECT\n    o.order_id,\n    o.customer_id,\n    o.order_date,\n    o.amount,\n    p.product_name,\n    p.category,\n    s.supplier_name,\n    s.country,\n    s.sustainability_score\n\nFROM orders o\nLEFT JOIN products p ON o.product_id = p.product_id\nLEFT JOIN suppliers s ON p.supplier_id = s.supplier_id\n    )", "query_id": "20251012_172044_00115_s55gt"}, "message": "SUCCESS", "failures": null, "unique_id": "model.greencard_analytics.int_orders_with_behavior", "compiled": true, "compiled_code": "\n\nWITH orders AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_orders\"\n),\n\nproducts AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_products\"\n),\n\nsuppliers AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_suppliers\"\n)\n\nSELECT\n    o.order_id,\n    o.customer_id,\n    o.order_date,\n    o.amount,\n    p.product_name,\n    p.category,\n    s.supplier_name,\n    s.country,\n    s.sustainability_score\n\nFROM orders o\nLEFT JOIN products p ON o.product_id = p.product_id\nLEFT JOIN suppliers s ON p.supplier_id = s.supplier_id", "relation_name": "\"postgres\".\"analytics_intermediate\".\"int_orders_with_behavior\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-12T17:20:43.911592Z", "completed_at": "2025-10-12T17:20:43.917277Z"}, {"name": "execute", "started_at": "2025-10-12T17:20:43.918357Z", "completed_at": "2025-10-12T17:20:44.216903Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3076612949371338, "adapter_response": {"_message": "SUCCESS", "rows_affected": 50, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.4\", \"profile_name\": \"lakehouse\", \"target_name\": \"dev\", \"node_id\": \"model.greencard_analytics.int_orders_enriched\"} */\n\n  \n    \n\n    create table \"postgres\".\"analytics_intermediate\".\"int_orders_enriched__dbt_tmp\"\n      \n      \n    as (\n      -- Federation query: Join PostgreSQL orders with MySQL products/suppliers\n\n\nWITH orders AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_orders\"\n),\n\nproducts AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_products\"\n),\n\nsuppliers AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_suppliers\"\n)\n\nSELECT\n    o.order_id,\n    o.customer_id,\n    o.order_date,\n    o.amount,\n    \n    p.product_name,\n    p.category,\n    p.price,\n    \n    s.supplier_name,\n    s.country,\n    s.region,\n    s.sustainability_score,\n    \n    CASE \n        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)\n        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)\n        ELSE CAST('Low Value' AS VARCHAR)\n    END AS order_value_tier,\n    \n    CASE\n        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)\n        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)\n        ELSE CAST('Fair' AS VARCHAR)\n    END AS sustainability_tier\n\nFROM orders o\nLEFT JOIN products p ON o.product_id = p.product_id\nLEFT JOIN suppliers s ON p.supplier_id = s.supplier_id\n    )", "query_id": "20251012_172044_00114_s55gt"}, "message": "SUCCESS", "failures": null, "unique_id": "model.greencard_analytics.int_orders_enriched", "compiled": true, "compiled_code": "-- Federation query: Join PostgreSQL orders with MySQL products/suppliers\n\n\nWITH orders AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_orders\"\n),\n\nproducts AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_products\"\n),\n\nsuppliers AS (\n    SELECT * FROM \"postgres\".\"analytics_staging\".\"stg_suppliers\"\n)\n\nSELECT\n    o.order_id,\n    o.customer_id,\n    o.order_date,\n    o.amount,\n    \n    p.product_name,\n    p.category,\n    p.price,\n    \n    s.supplier_name,\n    s.country,\n    s.region,\n    s.sustainability_score,\n    \n    CASE \n        WHEN o.amount >= 500 THEN CAST('High Value' AS VARCHAR)\n        WHEN o.amount >= 100 THEN CAST('Medium Value' AS VARCHAR)\n        ELSE CAST('Low Value' AS VARCHAR)\n    END AS order_value_tier,\n    \n    CASE\n        WHEN s.sustainability_score >= 80 THEN CAST('Excellent' AS VARCHAR)\n        WHEN s.sustainability_score >= 60 THEN CAST('Good' AS VARCHAR)\n        ELSE CAST('Fair' AS VARCHAR)\n    END AS sustainability_tier\n\nFROM orders o\nLEFT JOIN products p ON o.product_id = p.product_id\nLEFT JOIN suppliers s ON p.supplier_id = s.supplier_id", "relation_name": "\"postgres\".\"analytics_intermediate\".\"int_orders_enriched\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-12T17:20:44.220369Z", "completed_at": "2025-10-12T17:20:44.222779Z"}, {"name": "execute", "started_at": "2025-10-12T17:20:44.223294Z", "completed_at": "2025-10-12T17:20:44.405083Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1864936351776123, "adapter_response": {"_message": "SUCCESS", "rows_affected": 50, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.4\", \"profile_name\": \"lakehouse\", \"target_name\": \"dev\", \"node_id\": \"model.greencard_analytics.fct_orders\"} */\n\n  \n    \n\n    create table \"postgres\".\"analytics_marts\".\"fct_orders__dbt_tmp\"\n      \n      \n    as (\n      \n\nWITH enriched_orders AS (\n    SELECT * FROM \"postgres\".\"analytics_intermediate\".\"int_orders_enriched\"\n),\n\nbehavior_orders AS (\n    SELECT * FROM \"postgres\".\"analytics_intermediate\".\"int_orders_with_behavior\"\n)\n\nSELECT\n    COALESCE(e.order_id, b.order_id) as order_id,\n    COALESCE(e.customer_id, b.customer_id) as customer_id,\n    COALESCE(e.order_date, b.order_date) as order_date,\n    COALESCE(e.amount, b.amount) as revenue,\n    COALESCE(e.product_name, b.product_name) as product_name,\n    COALESCE(e.category, b.category) as product_category,\n    COALESCE(e.supplier_name, b.supplier_name) as supplier_name,\n    COALESCE(e.country, b.country) as supplier_country,\n    COALESCE(e.sustainability_score, b.sustainability_score) as sustainability_score,\n    EXTRACT(YEAR FROM COALESCE(e.order_date, b.order_date)) as order_year,\n    EXTRACT(MONTH FROM COALESCE(e.order_date, b.order_date)) as order_month,\n    EXTRACT(QUARTER FROM COALESCE(e.order_date, b.order_date)) as order_quarter,\n    -- Since we removed user events, set these to 0 for now\n    0 as customer_page_views,\n    0 as customer_cart_adds,\n    0 as customer_purchases\n\nFROM enriched_orders e\nFULL OUTER JOIN behavior_orders b ON e.order_id = b.order_id\n    )", "query_id": "20251012_172044_00122_s55gt"}, "message": "SUCCESS", "failures": null, "unique_id": "model.greencard_analytics.fct_orders", "compiled": true, "compiled_code": "\n\nWITH enriched_orders AS (\n    SELECT * FROM \"postgres\".\"analytics_intermediate\".\"int_orders_enriched\"\n),\n\nbehavior_orders AS (\n    SELECT * FROM \"postgres\".\"analytics_intermediate\".\"int_orders_with_behavior\"\n)\n\nSELECT\n    COALESCE(e.order_id, b.order_id) as order_id,\n    COALESCE(e.customer_id, b.customer_id) as customer_id,\n    COALESCE(e.order_date, b.order_date) as order_date,\n    COALESCE(e.amount, b.amount) as revenue,\n    COALESCE(e.product_name, b.product_name) as product_name,\n    COALESCE(e.category, b.category) as product_category,\n    COALESCE(e.supplier_name, b.supplier_name) as supplier_name,\n    COALESCE(e.country, b.country) as supplier_country,\n    COALESCE(e.sustainability_score, b.sustainability_score) as sustainability_score,\n    EXTRACT(YEAR FROM COALESCE(e.order_date, b.order_date)) as order_year,\n    EXTRACT(MONTH FROM COALESCE(e.order_date, b.order_date)) as order_month,\n    EXTRACT(QUARTER FROM COALESCE(e.order_date, b.order_date)) as order_quarter,\n    -- Since we removed user events, set these to 0 for now\n    0 as customer_page_views,\n    0 as customer_cart_adds,\n    0 as customer_purchases\n\nFROM enriched_orders e\nFULL OUTER JOIN behavior_orders b ON e.order_id = b.order_id", "relation_name": "\"postgres\".\"analytics_marts\".\"fct_orders\""}], "elapsed_time": 1.2116944789886475, "args": {"profiles_dir": "/root/.dbt", "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "print": true, "warn_error_options": {"include": [], "exclude": []}, "invocation_command": "dbt run", "log_format": "default", "printer_width": 80, "log_level_file": "debug", "use_colors_file": true, "write_json": true, "vars": {}, "use_colors": true, "macro_debugging": false, "introspect": true, "defer": false, "log_format_file": "debug", "enable_legacy_logger": false, "partial_parse": true, "exclude": [], "indirect_selection": "eager", "cache_selected_only": false, "static_parser": true, "strict_mode": false, "populate_cache": true, "select": [], "show_resource_report": false, "log_level": "info", "log_path": "/usr/app/logs", "which": "run", "quiet": false, "send_anonymous_usage_stats": true, "version_check": true, "favor_state": false, "project_dir": "/usr/app"}}